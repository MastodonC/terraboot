{
    "version": 1,
    "serial": 2517,
    "modules": [
        {
            "path": [
                "root"
            ],
            "outputs": {},
            "resources": {
                "aws_autoscaling_group.sandpit-staging-masters": {
                    "type": "aws_autoscaling_group",
                    "depends_on": [
                        "aws_elb.sandpit-staging-internal-lb",
                        "aws_elb.sandpit-staging-masters",
                        "aws_launch_configuration.sandpit-staging-masters",
                        "aws_subnet.sandpit-public-a",
                        "aws_subnet.sandpit-public-b"
                    ],
                    "primary": {
                        "id": "sandpit-staging-masters",
                        "attributes": {
                            "availability_zones.#": "2",
                            "availability_zones.1126047633": "eu-central-1a",
                            "availability_zones.3658960427": "eu-central-1b",
                            "default_cooldown": "300",
                            "desired_capacity": "3",
                            "force_delete": "false",
                            "health_check_grace_period": "20",
                            "health_check_type": "EC2",
                            "id": "sandpit-staging-masters",
                            "launch_configuration": "sandpit-staging-masters-juhg5gq45vgz3cmkjuqxp7ta7q",
                            "load_balancers.#": "2",
                            "load_balancers.2095926242": "sandpit-staging-internal-lb",
                            "load_balancers.3562399459": "sandpit-staging-masters",
                            "max_size": "3",
                            "metrics_granularity": "1Minute",
                            "min_size": "3",
                            "name": "sandpit-staging-masters",
                            "placement_group": "",
                            "tag.#": "1",
                            "tag.189038654.key": "Name",
                            "tag.189038654.propagate_at_launch": "true",
                            "tag.189038654.value": "autoscale-masters",
                            "termination_policies.#": "0",
                            "vpc_zone_identifier.#": "2",
                            "vpc_zone_identifier.2163134521": "subnet-6583d00c",
                            "vpc_zone_identifier.3416228750": "subnet-af5127d4",
                            "wait_for_capacity_timeout": "10m"
                        }
                    }
                },
                "aws_autoscaling_group.sandpit-staging-public-slaves": {
                    "type": "aws_autoscaling_group",
                    "depends_on": [
                        "aws_elb.sandpit-staging-public-slaves",
                        "aws_launch_configuration.sandpit-staging-public-slaves",
                        "aws_subnet.sandpit-public-a",
                        "aws_subnet.sandpit-public-b"
                    ],
                    "primary": {
                        "id": "sandpit-staging-public-slaves",
                        "attributes": {
                            "availability_zones.#": "2",
                            "availability_zones.1126047633": "eu-central-1a",
                            "availability_zones.3658960427": "eu-central-1b",
                            "default_cooldown": "300",
                            "desired_capacity": "1",
                            "force_delete": "false",
                            "health_check_grace_period": "20",
                            "health_check_type": "EC2",
                            "id": "sandpit-staging-public-slaves",
                            "launch_configuration": "sandpit-staging-public-slaves-ca5qacsqsrhzzaononoohxjfrq",
                            "load_balancers.#": "1",
                            "load_balancers.2704989236": "sandpit-staging-public-slaves",
                            "max_size": "1",
                            "metrics_granularity": "1Minute",
                            "min_size": "1",
                            "name": "sandpit-staging-public-slaves",
                            "placement_group": "",
                            "tag.#": "1",
                            "tag.1363845656.key": "Name",
                            "tag.1363845656.propagate_at_launch": "true",
                            "tag.1363845656.value": "autoscale-public-slaves",
                            "termination_policies.#": "0",
                            "vpc_zone_identifier.#": "2",
                            "vpc_zone_identifier.2163134521": "subnet-6583d00c",
                            "vpc_zone_identifier.3416228750": "subnet-af5127d4",
                            "wait_for_capacity_timeout": "10m"
                        }
                    }
                },
                "aws_autoscaling_group.sandpit-staging-slaves": {
                    "type": "aws_autoscaling_group",
                    "depends_on": [
                        "aws_launch_configuration.sandpit-staging-slaves",
                        "aws_subnet.sandpit-private-a",
                        "aws_subnet.sandpit-private-b"
                    ],
                    "primary": {
                        "id": "sandpit-staging-slaves",
                        "attributes": {
                            "availability_zones.#": "2",
                            "availability_zones.1126047633": "eu-central-1a",
                            "availability_zones.3658960427": "eu-central-1b",
                            "default_cooldown": "300",
                            "desired_capacity": "2",
                            "force_delete": "false",
                            "health_check_grace_period": "20",
                            "health_check_type": "EC2",
                            "id": "sandpit-staging-slaves",
                            "launch_configuration": "sandpit-staging-slaves-qn4yudltv5cupac6sn4vvubodu",
                            "load_balancers.#": "0",
                            "max_size": "2",
                            "metrics_granularity": "1Minute",
                            "min_size": "2",
                            "name": "sandpit-staging-slaves",
                            "placement_group": "",
                            "tag.#": "1",
                            "tag.70531153.key": "Name",
                            "tag.70531153.propagate_at_launch": "true",
                            "tag.70531153.value": "autoscale-slaves",
                            "termination_policies.#": "0",
                            "vpc_zone_identifier.#": "2",
                            "vpc_zone_identifier.638682311": "subnet-a85127d3",
                            "vpc_zone_identifier.844029473": "subnet-6283d00b",
                            "wait_for_capacity_timeout": "10m"
                        }
                    }
                },
                "aws_db_instance.sandpit-alerts": {
                    "type": "aws_db_instance",
                    "depends_on": [
                        "aws_db_subnet_group.sandpit",
                        "aws_security_group.allow_outbound",
                        "aws_security_group.db-sandpit-alerts"
                    ],
                    "primary": {
                        "id": "sandpit-alerts",
                        "attributes": {
                            "address": "sandpit-alerts.cp1dovhlduxq.eu-central-1.rds.amazonaws.com",
                            "allocated_storage": "10",
                            "arn": "arn:aws:rds:eu-central-1:165664414043:db:sandpit-alerts",
                            "auto_minor_version_upgrade": "true",
                            "availability_zone": "eu-central-1a",
                            "backup_retention_period": "0",
                            "backup_window": "01:07-01:37",
                            "copy_tags_to_snapshot": "false",
                            "db_subnet_group_name": "sandpit",
                            "endpoint": "sandpit-alerts.cp1dovhlduxq.eu-central-1.rds.amazonaws.com:5432",
                            "engine": "postgres",
                            "engine_version": "9.4.7",
                            "id": "sandpit-alerts",
                            "identifier": "sandpit-alerts",
                            "instance_class": "db.t2.small",
                            "license_model": "postgresql-license",
                            "maintenance_window": "thu:21:00-thu:21:30",
                            "monitoring_interval": "0",
                            "multi_az": "false",
                            "name": "",
                            "parameter_group_name": "sandpit-alerts",
                            "password": "abcdefgh12",
                            "port": "5432",
                            "publicly_accessible": "false",
                            "replicas.#": "0",
                            "replicate_source_db": "",
                            "security_group_names.#": "0",
                            "skip_final_snapshot": "true",
                            "status": "available",
                            "storage_encrypted": "false",
                            "storage_type": "standard",
                            "tags.#": "0",
                            "username": "kixi",
                            "vpc_security_group_ids.#": "2",
                            "vpc_security_group_ids.128448214": "sg-4e30d326",
                            "vpc_security_group_ids.2761780372": "sg-a86e63c1"
                        }
                    }
                },
                "aws_db_parameter_group.sandpit-alerts": {
                    "type": "aws_db_parameter_group",
                    "primary": {
                        "id": "sandpit-alerts",
                        "attributes": {
                            "arn": "arn:aws:rds:eu-central-1:165664414043:pg:sandpit-alerts",
                            "description": "RDS parameter group",
                            "family": "postgres9.4",
                            "id": "sandpit-alerts",
                            "name": "sandpit-alerts",
                            "parameter.#": "0",
                            "tags.#": "0"
                        }
                    }
                },
                "aws_db_subnet_group.sandpit": {
                    "type": "aws_db_subnet_group",
                    "depends_on": [
                        "aws_subnet.sandpit-private-a",
                        "aws_subnet.sandpit-private-b"
                    ],
                    "primary": {
                        "id": "sandpit",
                        "attributes": {
                            "arn": "arn:aws:rds:eu-central-1:165664414043:subgrp:sandpit",
                            "description": "subnet for dbs",
                            "id": "sandpit",
                            "name": "sandpit",
                            "subnet_ids.#": "2",
                            "subnet_ids.638682311": "subnet-a85127d3",
                            "subnet_ids.844029473": "subnet-6283d00b",
                            "tags.#": "0"
                        }
                    }
                },
                "aws_ebs_volume.sandpit-influxdb": {
                    "type": "aws_ebs_volume",
                    "primary": {
                        "id": "vol-ed4d5366",
                        "attributes": {
                            "availability_zone": "eu-central-1a",
                            "encrypted": "false",
                            "id": "vol-ed4d5366",
                            "size": "20",
                            "snapshot_id": "",
                            "type": "standard"
                        }
                    }
                },
                "aws_eip.influxdb": {
                    "type": "aws_eip",
                    "depends_on": [
                        "aws_instance.influxdb"
                    ],
                    "primary": {
                        "id": "eipalloc-762ffd1f",
                        "attributes": {
                            "association_id": "eipassoc-078b9e6e",
                            "domain": "vpc",
                            "id": "eipalloc-762ffd1f",
                            "instance": "i-09c365b4",
                            "network_interface": "eni-033fb468",
                            "private_ip": "172.20.0.153",
                            "public_ip": "52.58.73.254",
                            "vpc": "true"
                        }
                    }
                },
                "aws_eip.sandpit-logstash": {
                    "type": "aws_eip",
                    "depends_on": [
                        "aws_instance.sandpit-logstash"
                    ],
                    "primary": {
                        "id": "eipalloc-bb3eedd2",
                        "attributes": {
                            "association_id": "eipassoc-9795abfe",
                            "domain": "vpc",
                            "id": "eipalloc-bb3eedd2",
                            "instance": "i-df469962",
                            "network_interface": "eni-342ffa5f",
                            "private_ip": "172.20.0.80",
                            "public_ip": "52.29.4.154",
                            "vpc": "true"
                        }
                    }
                },
                "aws_eip.sandpit-public-a-nat": {
                    "type": "aws_eip",
                    "primary": {
                        "id": "eipalloc-b83eedd1",
                        "attributes": {
                            "association_id": "eipassoc-6495ab0d",
                            "domain": "vpc",
                            "id": "eipalloc-b83eedd1",
                            "instance": "",
                            "network_interface": "eni-652ffa0e",
                            "private_ip": "172.20.0.175",
                            "public_ip": "52.58.52.87",
                            "vpc": "true"
                        }
                    }
                },
                "aws_eip.sandpit-public-b-nat": {
                    "type": "aws_eip",
                    "primary": {
                        "id": "eipalloc-7c23f015",
                        "attributes": {
                            "association_id": "eipassoc-ac92acc5",
                            "domain": "vpc",
                            "id": "eipalloc-7c23f015",
                            "instance": "",
                            "network_interface": "eni-79525e03",
                            "private_ip": "172.20.1.156",
                            "public_ip": "52.58.62.184",
                            "vpc": "true"
                        }
                    }
                },
                "aws_elasticsearch_domain.sandpit-elasticsearch": {
                    "type": "aws_elasticsearch_domain",
                    "depends_on": [
                        "aws_eip.sandpit-logstash",
                        "aws_eip.sandpit-public-a-nat",
                        "aws_eip.sandpit-public-b-nat"
                    ],
                    "primary": {
                        "id": "arn:aws:es:eu-central-1:165664414043:domain/sandpit-elasticsearch",
                        "attributes": {
                            "access_policies": "{\"Statement\":[{\"Action\":\"es:*\",\"Condition\":{\"IpAddress\":{\"aws:SourceIp\":[\"52.58.52.87\",\"52.58.62.184\",\"52.29.4.154\",\"87.115.98.26/32\",\"146.200.166.70/32\"]}},\"Effect\":\"Allow\",\"Principal\":\"*\",\"Resource\":\"arn:aws:es:eu-central-1:165664414043:domain/sandpit-elasticsearch/*\"}],\"Version\":\"2012-10-17\"}",
                            "advanced_options.#": "1",
                            "advanced_options.rest.action.multi.allow_explicit_index": "true",
                            "arn": "arn:aws:es:eu-central-1:165664414043:domain/sandpit-elasticsearch",
                            "cluster_config.#": "1",
                            "cluster_config.0.dedicated_master_count": "0",
                            "cluster_config.0.dedicated_master_enabled": "false",
                            "cluster_config.0.dedicated_master_type": "",
                            "cluster_config.0.instance_count": "2",
                            "cluster_config.0.instance_type": "t2.small.elasticsearch",
                            "cluster_config.0.zone_awareness_enabled": "false",
                            "domain_id": "165664414043/sandpit-elasticsearch",
                            "domain_name": "sandpit-elasticsearch",
                            "ebs_options.#": "1",
                            "ebs_options.0.ebs_enabled": "true",
                            "ebs_options.0.iops": "0",
                            "ebs_options.0.volume_size": "35",
                            "ebs_options.0.volume_type": "gp2",
                            "endpoint": "search-sandpit-elasticsearch-xijn4teq3gmimkpzpy2ivbbnbm.eu-central-1.es.amazonaws.com",
                            "id": "arn:aws:es:eu-central-1:165664414043:domain/sandpit-elasticsearch",
                            "snapshot_options.#": "1",
                            "snapshot_options.0.automated_snapshot_start_hour": "23",
                            "tags.#": "0"
                        }
                    }
                },
                "aws_elb.alerts": {
                    "type": "aws_elb",
                    "depends_on": [
                        "aws_instance.sandpit-alerts",
                        "aws_security_group.allow_external_http_https",
                        "aws_security_group.allow_outbound",
                        "aws_security_group.allow_ssh",
                        "aws_security_group.sandpit-elb-alerts",
                        "aws_subnet.sandpit-public-a",
                        "aws_subnet.sandpit-public-b"
                    ],
                    "primary": {
                        "id": "alerts",
                        "attributes": {
                            "access_logs.#": "0",
                            "availability_zones.#": "2",
                            "availability_zones.1126047633": "eu-central-1a",
                            "availability_zones.3658960427": "eu-central-1b",
                            "connection_draining": "true",
                            "connection_draining_timeout": "60",
                            "cross_zone_load_balancing": "true",
                            "dns_name": "alerts-453095060.eu-central-1.elb.amazonaws.com",
                            "health_check.#": "1",
                            "health_check.0.healthy_threshold": "2",
                            "health_check.0.interval": "30",
                            "health_check.0.target": "HTTP:80/",
                            "health_check.0.timeout": "5",
                            "health_check.0.unhealthy_threshold": "3",
                            "id": "alerts",
                            "idle_timeout": "60",
                            "instances.#": "1",
                            "instances.3600215629": "i-4f9130f2",
                            "internal": "false",
                            "listener.#": "2",
                            "listener.1082590633.instance_port": "80",
                            "listener.1082590633.instance_protocol": "http",
                            "listener.1082590633.lb_port": "443",
                            "listener.1082590633.lb_protocol": "https",
                            "listener.1082590633.ssl_certificate_id": "arn:aws:iam::165664414043:server-certificate/StartMastodoncNet",
                            "listener.3057123346.instance_port": "80",
                            "listener.3057123346.instance_protocol": "http",
                            "listener.3057123346.lb_port": "80",
                            "listener.3057123346.lb_protocol": "http",
                            "listener.3057123346.ssl_certificate_id": "",
                            "name": "alerts",
                            "security_groups.#": "4",
                            "security_groups.2578033345": "sg-a06e63c9",
                            "security_groups.2761780372": "sg-a86e63c1",
                            "security_groups.361540221": "sg-4300e32b",
                            "security_groups.4242448860": "sg-aa6e63c3",
                            "source_security_group": "165664414043/allow_external_http_https",
                            "source_security_group_id": "sg-aa6e63c3",
                            "subnets.#": "2",
                            "subnets.2163134521": "subnet-6583d00c",
                            "subnets.3416228750": "subnet-af5127d4",
                            "tags.#": "1",
                            "tags.Name": "alerts",
                            "zone_id": "Z215JYRZR1TBD5"
                        }
                    }
                },
                "aws_elb.chronograf": {
                    "type": "aws_elb",
                    "depends_on": [
                        "aws_instance.influxdb",
                        "aws_security_group.allow_external_http_https",
                        "aws_security_group.allow_ssh",
                        "aws_security_group.sandpit-all-servers",
                        "aws_security_group.sandpit-elb_chronograf",
                        "aws_subnet.sandpit-public-a",
                        "aws_subnet.sandpit-public-b"
                    ],
                    "primary": {
                        "id": "chronograf",
                        "attributes": {
                            "access_logs.#": "0",
                            "availability_zones.#": "2",
                            "availability_zones.1126047633": "eu-central-1a",
                            "availability_zones.3658960427": "eu-central-1b",
                            "connection_draining": "true",
                            "connection_draining_timeout": "60",
                            "cross_zone_load_balancing": "true",
                            "dns_name": "chronograf-1587775837.eu-central-1.elb.amazonaws.com",
                            "health_check.#": "1",
                            "health_check.0.healthy_threshold": "2",
                            "health_check.0.interval": "30",
                            "health_check.0.target": "HTTP:80/status",
                            "health_check.0.timeout": "5",
                            "health_check.0.unhealthy_threshold": "3",
                            "id": "chronograf",
                            "idle_timeout": "60",
                            "instances.#": "1",
                            "instances.3968750576": "i-09c365b4",
                            "internal": "false",
                            "listener.#": "2",
                            "listener.1082590633.instance_port": "80",
                            "listener.1082590633.instance_protocol": "http",
                            "listener.1082590633.lb_port": "443",
                            "listener.1082590633.lb_protocol": "https",
                            "listener.1082590633.ssl_certificate_id": "arn:aws:iam::165664414043:server-certificate/StartMastodoncNet",
                            "listener.3057123346.instance_port": "80",
                            "listener.3057123346.instance_protocol": "http",
                            "listener.3057123346.lb_port": "80",
                            "listener.3057123346.lb_protocol": "http",
                            "listener.3057123346.ssl_certificate_id": "",
                            "name": "chronograf",
                            "security_groups.#": "4",
                            "security_groups.1948651400": "sg-a327c4cb",
                            "security_groups.2275809173": "sg-81001ee8",
                            "security_groups.2578033345": "sg-a06e63c9",
                            "security_groups.4242448860": "sg-aa6e63c3",
                            "source_security_group": "165664414043/allow_external_http_https",
                            "source_security_group_id": "sg-aa6e63c3",
                            "subnets.#": "2",
                            "subnets.2163134521": "subnet-6583d00c",
                            "subnets.3416228750": "subnet-af5127d4",
                            "tags.#": "1",
                            "tags.Name": "chronograf",
                            "zone_id": "Z215JYRZR1TBD5"
                        }
                    }
                },
                "aws_elb.kibana": {
                    "type": "aws_elb",
                    "depends_on": [
                        "aws_instance.sandpit-kibana",
                        "aws_security_group.allow_external_http_https",
                        "aws_security_group.allow_outbound",
                        "aws_security_group.allow_ssh",
                        "aws_security_group.sandpit-elb-kibana",
                        "aws_subnet.sandpit-public-a",
                        "aws_subnet.sandpit-public-b"
                    ],
                    "primary": {
                        "id": "kibana",
                        "attributes": {
                            "access_logs.#": "0",
                            "availability_zones.#": "2",
                            "availability_zones.1126047633": "eu-central-1a",
                            "availability_zones.3658960427": "eu-central-1b",
                            "connection_draining": "true",
                            "connection_draining_timeout": "60",
                            "cross_zone_load_balancing": "true",
                            "dns_name": "kibana-2068457569.eu-central-1.elb.amazonaws.com",
                            "health_check.#": "1",
                            "health_check.0.healthy_threshold": "2",
                            "health_check.0.interval": "30",
                            "health_check.0.target": "HTTP:80/status",
                            "health_check.0.timeout": "5",
                            "health_check.0.unhealthy_threshold": "3",
                            "id": "kibana",
                            "idle_timeout": "60",
                            "instances.#": "1",
                            "instances.999702745": "i-a5508e18",
                            "internal": "false",
                            "listener.#": "2",
                            "listener.1082590633.instance_port": "80",
                            "listener.1082590633.instance_protocol": "http",
                            "listener.1082590633.lb_port": "443",
                            "listener.1082590633.lb_protocol": "https",
                            "listener.1082590633.ssl_certificate_id": "arn:aws:iam::165664414043:server-certificate/StartMastodoncNet",
                            "listener.3057123346.instance_port": "80",
                            "listener.3057123346.instance_protocol": "http",
                            "listener.3057123346.lb_port": "80",
                            "listener.3057123346.lb_protocol": "http",
                            "listener.3057123346.ssl_certificate_id": "",
                            "name": "kibana",
                            "security_groups.#": "4",
                            "security_groups.2578033345": "sg-a06e63c9",
                            "security_groups.2761780372": "sg-a86e63c1",
                            "security_groups.4132083538": "sg-e6676e8f",
                            "security_groups.4242448860": "sg-aa6e63c3",
                            "source_security_group": "165664414043/allow_external_http_https",
                            "source_security_group_id": "sg-aa6e63c3",
                            "subnets.#": "2",
                            "subnets.2163134521": "subnet-6583d00c",
                            "subnets.3416228750": "subnet-af5127d4",
                            "tags.#": "1",
                            "tags.Name": "kibana",
                            "zone_id": "Z215JYRZR1TBD5"
                        }
                    }
                },
                "aws_elb.sandpit-staging-internal-lb": {
                    "type": "aws_elb",
                    "depends_on": [
                        "aws_security_group.allow_ssh",
                        "aws_security_group.sandpit-staging-admin-security-group",
                        "aws_security_group.sandpit-staging-lb-security-group",
                        "aws_security_group.sandpit-staging-master-security-group",
                        "aws_subnet.sandpit-public-a",
                        "aws_subnet.sandpit-public-b"
                    ],
                    "primary": {
                        "id": "sandpit-staging-internal-lb",
                        "attributes": {
                            "access_logs.#": "0",
                            "availability_zones.#": "2",
                            "availability_zones.1126047633": "eu-central-1a",
                            "availability_zones.3658960427": "eu-central-1b",
                            "connection_draining": "true",
                            "connection_draining_timeout": "60",
                            "cross_zone_load_balancing": "true",
                            "dns_name": "internal-sandpit-staging-internal-lb-1023536621.eu-central-1.elb.amazonaws.com",
                            "health_check.#": "1",
                            "health_check.0.healthy_threshold": "2",
                            "health_check.0.interval": "30",
                            "health_check.0.target": "HTTP:8181/exhibitor/v1/cluster/status",
                            "health_check.0.timeout": "5",
                            "health_check.0.unhealthy_threshold": "3",
                            "id": "sandpit-staging-internal-lb",
                            "idle_timeout": "60",
                            "instances.#": "3",
                            "instances.1777489198": "i-f83ba744",
                            "instances.3095555596": "i-f93ba745",
                            "instances.472116417": "i-2367c09e",
                            "internal": "true",
                            "listener.#": "6",
                            "listener.1092403652.instance_port": "8080",
                            "listener.1092403652.instance_protocol": "http",
                            "listener.1092403652.lb_port": "8080",
                            "listener.1092403652.lb_protocol": "http",
                            "listener.1092403652.ssl_certificate_id": "",
                            "listener.2024497952.instance_port": "2181",
                            "listener.2024497952.instance_protocol": "tcp",
                            "listener.2024497952.lb_port": "2181",
                            "listener.2024497952.lb_protocol": "tcp",
                            "listener.2024497952.ssl_certificate_id": "",
                            "listener.2613737617.instance_port": "53",
                            "listener.2613737617.instance_protocol": "tcp",
                            "listener.2613737617.lb_port": "53",
                            "listener.2613737617.lb_protocol": "tcp",
                            "listener.2613737617.ssl_certificate_id": "",
                            "listener.3057123346.instance_port": "80",
                            "listener.3057123346.instance_protocol": "http",
                            "listener.3057123346.lb_port": "80",
                            "listener.3057123346.lb_protocol": "http",
                            "listener.3057123346.ssl_certificate_id": "",
                            "listener.3829233144.instance_port": "5050",
                            "listener.3829233144.instance_protocol": "http",
                            "listener.3829233144.lb_port": "5050",
                            "listener.3829233144.lb_protocol": "http",
                            "listener.3829233144.ssl_certificate_id": "",
                            "listener.3896584131.instance_port": "8181",
                            "listener.3896584131.instance_protocol": "http",
                            "listener.3896584131.lb_port": "8181",
                            "listener.3896584131.lb_protocol": "http",
                            "listener.3896584131.ssl_certificate_id": "",
                            "name": "sandpit-staging-internal-lb",
                            "security_groups.#": "4",
                            "security_groups.1489236821": "sg-2579634c",
                            "security_groups.2578033345": "sg-a06e63c9",
                            "security_groups.3932421453": "sg-2279634b",
                            "security_groups.423697735": "sg-2679634f",
                            "source_security_group": "165664414043/sandpit-staging-lb-security-group",
                            "source_security_group_id": "sg-2279634b",
                            "subnets.#": "2",
                            "subnets.2163134521": "subnet-6583d00c",
                            "subnets.3416228750": "subnet-af5127d4",
                            "tags.#": "1",
                            "tags.Name": "sandpit-staging-internal-lb",
                            "zone_id": "Z215JYRZR1TBD5"
                        }
                    }
                },
                "aws_elb.sandpit-staging-masters": {
                    "type": "aws_elb",
                    "depends_on": [
                        "aws_security_group.allow_ssh",
                        "aws_security_group.sandpit-staging-admin-security-group",
                        "aws_security_group.sandpit-staging-lb-security-group",
                        "aws_subnet.sandpit-public-a",
                        "aws_subnet.sandpit-public-b"
                    ],
                    "primary": {
                        "id": "sandpit-staging-masters",
                        "attributes": {
                            "access_logs.#": "0",
                            "availability_zones.#": "2",
                            "availability_zones.1126047633": "eu-central-1a",
                            "availability_zones.3658960427": "eu-central-1b",
                            "connection_draining": "true",
                            "connection_draining_timeout": "60",
                            "cross_zone_load_balancing": "true",
                            "dns_name": "sandpit-staging-masters-795347527.eu-central-1.elb.amazonaws.com",
                            "health_check.#": "1",
                            "health_check.0.healthy_threshold": "2",
                            "health_check.0.interval": "30",
                            "health_check.0.target": "HTTP:5050/health",
                            "health_check.0.timeout": "5",
                            "health_check.0.unhealthy_threshold": "3",
                            "id": "sandpit-staging-masters",
                            "idle_timeout": "60",
                            "instances.#": "3",
                            "instances.1777489198": "i-f83ba744",
                            "instances.3095555596": "i-f93ba745",
                            "instances.472116417": "i-2367c09e",
                            "internal": "false",
                            "listener.#": "2",
                            "listener.1082590633.instance_port": "80",
                            "listener.1082590633.instance_protocol": "http",
                            "listener.1082590633.lb_port": "443",
                            "listener.1082590633.lb_protocol": "https",
                            "listener.1082590633.ssl_certificate_id": "arn:aws:iam::165664414043:server-certificate/StartMastodoncNet",
                            "listener.3057123346.instance_port": "80",
                            "listener.3057123346.instance_protocol": "http",
                            "listener.3057123346.lb_port": "80",
                            "listener.3057123346.lb_protocol": "http",
                            "listener.3057123346.ssl_certificate_id": "",
                            "name": "sandpit-staging-masters",
                            "security_groups.#": "3",
                            "security_groups.2578033345": "sg-a06e63c9",
                            "security_groups.3932421453": "sg-2279634b",
                            "security_groups.423697735": "sg-2679634f",
                            "source_security_group": "165664414043/sandpit-staging-lb-security-group",
                            "source_security_group_id": "sg-2279634b",
                            "subnets.#": "2",
                            "subnets.2163134521": "subnet-6583d00c",
                            "subnets.3416228750": "subnet-af5127d4",
                            "tags.#": "1",
                            "tags.Name": "sandpit-staging-masters",
                            "zone_id": "Z215JYRZR1TBD5"
                        }
                    }
                },
                "aws_elb.sandpit-staging-public-slaves": {
                    "type": "aws_elb",
                    "depends_on": [
                        "aws_security_group.allow_ssh",
                        "aws_security_group.sandpit-staging-public-slave-security-group",
                        "aws_subnet.sandpit-public-a",
                        "aws_subnet.sandpit-public-b"
                    ],
                    "primary": {
                        "id": "sandpit-staging-public-slaves",
                        "attributes": {
                            "access_logs.#": "0",
                            "availability_zones.#": "2",
                            "availability_zones.1126047633": "eu-central-1a",
                            "availability_zones.3658960427": "eu-central-1b",
                            "connection_draining": "true",
                            "connection_draining_timeout": "60",
                            "cross_zone_load_balancing": "true",
                            "dns_name": "sandpit-staging-public-slaves-1802906586.eu-central-1.elb.amazonaws.com",
                            "health_check.#": "1",
                            "health_check.0.healthy_threshold": "2",
                            "health_check.0.interval": "30",
                            "health_check.0.target": "HTTP:80/",
                            "health_check.0.timeout": "5",
                            "health_check.0.unhealthy_threshold": "2",
                            "id": "sandpit-staging-public-slaves",
                            "idle_timeout": "60",
                            "instances.#": "1",
                            "instances.1806574656": "i-31e7408c",
                            "internal": "false",
                            "listener.#": "2",
                            "listener.1131056931.instance_port": "9501",
                            "listener.1131056931.instance_protocol": "http",
                            "listener.1131056931.lb_port": "9501",
                            "listener.1131056931.lb_protocol": "http",
                            "listener.1131056931.ssl_certificate_id": "",
                            "listener.3057123346.instance_port": "80",
                            "listener.3057123346.instance_protocol": "http",
                            "listener.3057123346.lb_port": "80",
                            "listener.3057123346.lb_protocol": "http",
                            "listener.3057123346.ssl_certificate_id": "",
                            "name": "sandpit-staging-public-slaves",
                            "security_groups.#": "2",
                            "security_groups.2578033345": "sg-a06e63c9",
                            "security_groups.641681225": "sg-2779634e",
                            "source_security_group": "165664414043/sandpit-staging-public-slave-security-group",
                            "source_security_group_id": "sg-2779634e",
                            "subnets.#": "2",
                            "subnets.2163134521": "subnet-6583d00c",
                            "subnets.3416228750": "subnet-af5127d4",
                            "tags.#": "1",
                            "tags.Name": "sandpit-staging-public-slaves",
                            "zone_id": "Z215JYRZR1TBD5"
                        }
                    }
                },
                "aws_iam_access_key.sandpit-staging-host-key": {
                    "type": "aws_iam_access_key",
                    "depends_on": [
                        "aws_iam_user.sandpit-staging-mesos-user"
                    ],
                    "primary": {
                        "id": "AKIAIU6KU4KHLAG5KWLA",
                        "attributes": {
                            "id": "AKIAIU6KU4KHLAG5KWLA",
                            "secret": "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",
                            "ses_smtp_password": "Ai3Sann3Yl41umaEq7lKGAzfyNSmR87ve36xR/CJ0GLc",
                            "status": "Active",
                            "user": "sandpit-staging-mesos-user"
                        }
                    }
                },
                "aws_iam_instance_profile.sandpit-staging-masters": {
                    "type": "aws_iam_instance_profile",
                    "depends_on": [
                        "aws_iam_role.sandpit-staging-master-role"
                    ],
                    "primary": {
                        "id": "sandpit-staging-masters-profile",
                        "attributes": {
                            "arn": "arn:aws:iam::165664414043:instance-profile/sandpit-staging-masters-profile",
                            "id": "sandpit-staging-masters-profile",
                            "name": "sandpit-staging-masters-profile",
                            "path": "/",
                            "roles.#": "1",
                            "roles.4288480984": "sandpit-staging-master-role"
                        }
                    }
                },
                "aws_iam_instance_profile.sandpit-staging-public-slaves": {
                    "type": "aws_iam_instance_profile",
                    "depends_on": [
                        "aws_iam_role.sandpit-staging-slave-role"
                    ],
                    "primary": {
                        "id": "sandpit-staging-public-slaves-profile",
                        "attributes": {
                            "arn": "arn:aws:iam::165664414043:instance-profile/sandpit-staging-public-slaves-profile",
                            "id": "sandpit-staging-public-slaves-profile",
                            "name": "sandpit-staging-public-slaves-profile",
                            "path": "/",
                            "roles.#": "1",
                            "roles.2467116355": "sandpit-staging-slave-role"
                        }
                    }
                },
                "aws_iam_instance_profile.sandpit-staging-slaves": {
                    "type": "aws_iam_instance_profile",
                    "depends_on": [
                        "aws_iam_role.sandpit-staging-slave-role"
                    ],
                    "primary": {
                        "id": "sandpit-staging-slaves-profile",
                        "attributes": {
                            "arn": "arn:aws:iam::165664414043:instance-profile/sandpit-staging-slaves-profile",
                            "id": "sandpit-staging-slaves-profile",
                            "name": "sandpit-staging-slaves-profile",
                            "path": "/",
                            "roles.#": "1",
                            "roles.2467116355": "sandpit-staging-slave-role"
                        }
                    }
                },
                "aws_iam_role.sandpit-staging-master-role": {
                    "type": "aws_iam_role",
                    "primary": {
                        "id": "sandpit-staging-master-role",
                        "attributes": {
                            "arn": "arn:aws:iam::165664414043:role/sandpit-staging-master-role",
                            "assume_role_policy": "{\n  \"Statement\" : [ {\n    \"Action\" : [ \"sts:AssumeRole\" ],\n    \"Effect\" : \"Allow\",\n    \"Principal\" : {\n      \"Service\" : [ \"ec2.amazonaws.com\" ]\n    }\n  } ],\n  \"Version\" : \"2012-10-17\"\n}",
                            "id": "sandpit-staging-master-role",
                            "name": "sandpit-staging-master-role",
                            "path": "/",
                            "unique_id": "AROAIESQP7BCXLKIGY5JQ"
                        }
                    }
                },
                "aws_iam_role.sandpit-staging-slave-role": {
                    "type": "aws_iam_role",
                    "primary": {
                        "id": "sandpit-staging-slave-role",
                        "attributes": {
                            "arn": "arn:aws:iam::165664414043:role/sandpit-staging-slave-role",
                            "assume_role_policy": "{\n  \"Statement\" : [ {\n    \"Action\" : [ \"sts:AssumeRole\" ],\n    \"Effect\" : \"Allow\",\n    \"Principal\" : {\n      \"Service\" : [ \"ec2.amazonaws.com\" ]\n    }\n  } ],\n  \"Version\" : \"2012-10-17\"\n}",
                            "id": "sandpit-staging-slave-role",
                            "name": "sandpit-staging-slave-role",
                            "path": "/",
                            "unique_id": "AROAJ5HQV2357S6JE5DI4"
                        }
                    }
                },
                "aws_iam_role_policy.sandpit-staging-amazon-s3-policy": {
                    "type": "aws_iam_role_policy",
                    "depends_on": [
                        "aws_iam_role.sandpit-staging-slave-role"
                    ],
                    "primary": {
                        "id": "sandpit-staging-slave-role:sandpit-staging-amazon-s3-policy",
                        "attributes": {
                            "id": "sandpit-staging-slave-role:sandpit-staging-amazon-s3-policy",
                            "name": "sandpit-staging-amazon-s3-policy",
                            "policy": "{\n  \"Version\" : \"2012-10-17\",\n  \"Statement\" : {\n    \"Effect\" : \"Allow\",\n    \"Resource\" : \"*\",\n    \"Action\" : \"s3:*\"\n  }\n}",
                            "role": "sandpit-staging-slave-role"
                        }
                    }
                },
                "aws_iam_role_policy.sandpit-staging-cloudwatch-policy": {
                    "type": "aws_iam_role_policy",
                    "depends_on": [
                        "aws_iam_role.sandpit-staging-slave-role"
                    ],
                    "primary": {
                        "id": "sandpit-staging-slave-role:sandpit-staging-cloudwatch-policy",
                        "attributes": {
                            "id": "sandpit-staging-slave-role:sandpit-staging-cloudwatch-policy",
                            "name": "sandpit-staging-cloudwatch-policy",
                            "policy": "{\n  \"Version\" : \"2012-10-17\",\n  \"Statement\" : {\n    \"Effect\" : \"Allow\",\n    \"Resource\" : \"*\",\n    \"Action\" : [ \"cloudwatch:GetMetricStatistics\", \"cloudwatch:ListMetrics\", \"cloudwatch:PutMetricData\", \"EC2:DescribeTags\" ],\n    \"Condition\" : {\n      \"Bool\" : {\n        \"aws:SecureTransport\" : \"true\"\n      }\n    }\n  }\n}",
                            "role": "sandpit-staging-slave-role"
                        }
                    }
                },
                "aws_iam_role_policy.sandpit-staging-master-auto-scaling-policy": {
                    "type": "aws_iam_role_policy",
                    "depends_on": [
                        "aws_iam_role.sandpit-staging-master-role"
                    ],
                    "primary": {
                        "id": "sandpit-staging-master-role:sandpit-staging-master-auto-scaling-policy",
                        "attributes": {
                            "id": "sandpit-staging-master-role:sandpit-staging-master-auto-scaling-policy",
                            "name": "sandpit-staging-master-auto-scaling-policy",
                            "policy": "{\n  \"Version\" : \"2012-10-17\",\n  \"Statement\" : {\n    \"Effect\" : \"Allow\",\n    \"Resource\" : \"*\",\n    \"Action\" : [ \"ec2:DescribeKeyPairs\", \"ec2:DescribeSubnets\", \"autoscaling:DescribeLaunchConfigurations\", \"autoscaling:UpdateAutoScalingGroup\", \"autoscaling:DescribeAutoScalingGroups\", \"autoscaling:DescribeScalingActivities\", \"elasticloadbalancing:DescribeLoadBalancers\" ]\n  }\n}",
                            "role": "sandpit-staging-master-role"
                        }
                    }
                },
                "aws_iam_role_policy.sandpit-staging-master-s3": {
                    "type": "aws_iam_role_policy",
                    "depends_on": [
                        "aws_iam_role.sandpit-staging-master-role",
                        "aws_s3_bucket.sandpit-staging-exhibitor-s3-bucket"
                    ],
                    "primary": {
                        "id": "sandpit-staging-master-role:sandpit-staging-master-s3",
                        "attributes": {
                            "id": "sandpit-staging-master-role:sandpit-staging-master-s3",
                            "name": "sandpit-staging-master-s3",
                            "policy": "{\n  \"Version\" : \"2012-10-17\",\n  \"Statement\" : {\n    \"Effect\" : \"Allow\",\n    \"Resource\" : [ \"arn:aws:s3:::sandpit-staging-exhibitor-s3-bucket\", \"arn:aws:s3:::sandpit-staging-exhibitor-s3-bucket/*\" ],\n    \"Action\" : [ \"s3:AbortMultipartUpload\", \"s3:DeleteObject\", \"s3:GetBucketAcl\", \"s3:GetBucketPolicy\", \"s3:GetObject\", \"s3:GetObjectAcl\", \"s3:ListBucket\", \"s3:ListBucketMultipartUploads\", \"s3:ListMultipartUploadParts\", \"s3:PutObject\", \"s3:PutObjectAcl\" ]\n  }\n}",
                            "role": "sandpit-staging-master-role"
                        }
                    }
                },
                "aws_iam_role_policy.sandpit-staging-slave-cloudwatch-policy": {
                    "type": "aws_iam_role_policy",
                    "depends_on": [
                        "aws_iam_role.sandpit-staging-slave-role"
                    ],
                    "primary": {
                        "id": "sandpit-staging-slave-role:sandpit-staging-slave-cloudwatch-policy",
                        "attributes": {
                            "id": "sandpit-staging-slave-role:sandpit-staging-slave-cloudwatch-policy",
                            "name": "sandpit-staging-slave-cloudwatch-policy",
                            "policy": "{\n  \"Version\" : \"2012-10-17\",\n  \"Statement\" : {\n    \"Effect\" : \"Allow\",\n    \"Resource\" : \"*\",\n    \"Action\" : [ \"cloudwatch:GetMetricStatistics\", \"cloudwatch:ListMetrics\", \"cloudwatch:PutMetricData\", \"EC2:DescribeTags\" ],\n    \"Condition\" : {\n      \"Bool\" : {\n        \"aws:SecureTransport\" : \"true\"\n      }\n    }\n  }\n}",
                            "role": "sandpit-staging-slave-role"
                        }
                    }
                },
                "aws_iam_role_policy.sandpit-staging-slave-eip-policy": {
                    "type": "aws_iam_role_policy",
                    "depends_on": [
                        "aws_iam_role.sandpit-staging-slave-role"
                    ],
                    "primary": {
                        "id": "sandpit-staging-slave-role:sandpit-staging-slave-eip-policy",
                        "attributes": {
                            "id": "sandpit-staging-slave-role:sandpit-staging-slave-eip-policy",
                            "name": "sandpit-staging-slave-eip-policy",
                            "policy": "{\n  \"Version\" : \"2012-10-17\",\n  \"Statement\" : {\n    \"Effect\" : \"Allow\",\n    \"Resource\" : \"*\",\n    \"Action\" : [ \"ec2:AssociateAddress\" ]\n  }\n}",
                            "role": "sandpit-staging-slave-role"
                        }
                    }
                },
                "aws_iam_user.sandpit-staging-mesos-user": {
                    "type": "aws_iam_user",
                    "primary": {
                        "id": "sandpit-staging-mesos-user",
                        "attributes": {
                            "arn": "arn:aws:iam::165664414043:user/sandpit-staging-mesos-user",
                            "id": "sandpit-staging-mesos-user",
                            "name": "sandpit-staging-mesos-user",
                            "path": "/",
                            "unique_id": "AIDAI3PMIYWLKLYIA3LKA"
                        }
                    }
                },
                "aws_iam_user_policy.sandpit-staging-mesos-user-policy-s3": {
                    "type": "aws_iam_user_policy",
                    "depends_on": [
                        "aws_iam_user.sandpit-staging-mesos-user",
                        "aws_s3_bucket.sandpit-staging-exhibitor-s3-bucket"
                    ],
                    "primary": {
                        "id": "sandpit-staging-mesos-user:sandpit-staging-mesos-user-policy-s3",
                        "attributes": {
                            "id": "sandpit-staging-mesos-user:sandpit-staging-mesos-user-policy-s3",
                            "name": "sandpit-staging-mesos-user-policy-s3",
                            "policy": "{\n  \"Version\" : \"2012-10-17\",\n  \"Statement\" : {\n    \"Effect\" : \"Allow\",\n    \"Resource\" : [ \"arn:aws:s3:::sandpit-staging-exhibitor-s3-bucket\", \"arn:aws:s3:::sandpit-staging-exhibitor-s3-bucket/*\" ],\n    \"Action\" : [ \"s3:AbortMultipartUpload\", \"s3:DeleteObject\", \"s3:GetBucketAcl\", \"s3:GetBucketPolicy\", \"s3:GetObject\", \"s3:GetObjectAcl\", \"s3:ListBucket\", \"s3:ListBucketMultipartUploads\", \"s3:ListMultipartUploadParts\", \"s3:PutObject\", \"s3:PutObjectAcl\" ]\n  }\n}",
                            "user": "sandpit-staging-mesos-user"
                        }
                    }
                },
                "aws_instance.influxdb": {
                    "type": "aws_instance",
                    "depends_on": [
                        "aws_security_group.allow_ssh",
                        "aws_security_group.sandpit-all-servers",
                        "aws_security_group.sandpit-allow_elb_chronograf",
                        "aws_security_group.sandpit-influxdb",
                        "aws_subnet.sandpit-public-a"
                    ],
                    "primary": {
                        "id": "i-09c365b4",
                        "attributes": {
                            "ami": "ami-9b9c86f7",
                            "availability_zone": "eu-central-1a",
                            "ebs_block_device.#": "1",
                            "ebs_block_device.3846643179.delete_on_termination": "false",
                            "ebs_block_device.3846643179.device_name": "/dev/xvdh",
                            "ebs_block_device.3846643179.encrypted": "false",
                            "ebs_block_device.3846643179.iops": "0",
                            "ebs_block_device.3846643179.snapshot_id": "",
                            "ebs_block_device.3846643179.volume_size": "20",
                            "ebs_block_device.3846643179.volume_type": "standard",
                            "ebs_optimized": "false",
                            "ephemeral_block_device.#": "0",
                            "iam_instance_profile": "",
                            "id": "i-09c365b4",
                            "instance_state": "running",
                            "instance_type": "m4.large",
                            "key_name": "ops-terraboot",
                            "monitoring": "true",
                            "private_dns": "ip-172-20-0-153.eu-central-1.compute.internal",
                            "private_ip": "172.20.0.153",
                            "public_dns": "ec2-52-58-73-254.eu-central-1.compute.amazonaws.com",
                            "public_ip": "52.58.73.254",
                            "root_block_device.#": "1",
                            "root_block_device.0.delete_on_termination": "true",
                            "root_block_device.0.iops": "24",
                            "root_block_device.0.volume_size": "8",
                            "root_block_device.0.volume_type": "gp2",
                            "security_groups.#": "0",
                            "source_dest_check": "true",
                            "subnet_id": "subnet-6583d00c",
                            "tags.#": "1",
                            "tags.Name": "influxdb",
                            "tenancy": "default",
                            "vpc_security_group_ids.#": "4",
                            "vpc_security_group_ids.1456876727": "sg-80001ee9",
                            "vpc_security_group_ids.1948651400": "sg-a327c4cb",
                            "vpc_security_group_ids.2578033345": "sg-a06e63c9",
                            "vpc_security_group_ids.3608297936": "sg-fd021c94"
                        },
                        "meta": {
                            "schema_version": "1"
                        }
                    }
                },
                "aws_instance.sandpit-alerts": {
                    "type": "aws_instance",
                    "depends_on": [
                        "aws_security_group.allow_ssh",
                        "aws_security_group.sandpit-all-servers",
                        "aws_security_group.sandpit-allow-elb-alerts",
                        "aws_security_group.sandpit-nrpe",
                        "aws_security_group.uses-db-sandpit-alerts",
                        "aws_subnet.sandpit-private-a"
                    ],
                    "primary": {
                        "id": "i-4f9130f2",
                        "attributes": {
                            "ami": "ami-9b9c86f7",
                            "availability_zone": "eu-central-1a",
                            "ebs_block_device.#": "0",
                            "ebs_optimized": "false",
                            "ephemeral_block_device.#": "0",
                            "iam_instance_profile": "",
                            "id": "i-4f9130f2",
                            "instance_state": "running",
                            "instance_type": "t2.micro",
                            "key_name": "ops-terraboot",
                            "monitoring": "true",
                            "private_dns": "ip-172-20-8-14.eu-central-1.compute.internal",
                            "private_ip": "172.20.8.14",
                            "public_dns": "",
                            "public_ip": "",
                            "root_block_device.#": "1",
                            "root_block_device.0.delete_on_termination": "true",
                            "root_block_device.0.iops": "24",
                            "root_block_device.0.volume_size": "8",
                            "root_block_device.0.volume_type": "gp2",
                            "security_groups.#": "0",
                            "source_dest_check": "true",
                            "subnet_id": "subnet-6283d00b",
                            "tags.#": "1",
                            "tags.Name": "sandpit-alerts",
                            "tenancy": "default",
                            "vpc_security_group_ids.#": "5",
                            "vpc_security_group_ids.1095294173": "sg-4f30d327",
                            "vpc_security_group_ids.1264080262": "sg-a227c4ca",
                            "vpc_security_group_ids.1948651400": "sg-a327c4cb",
                            "vpc_security_group_ids.2578033345": "sg-a06e63c9",
                            "vpc_security_group_ids.720564339": "sg-4200e32a"
                        },
                        "meta": {
                            "schema_version": "1"
                        }
                    }
                },
                "aws_instance.sandpit-kibana": {
                    "type": "aws_instance",
                    "depends_on": [
                        "aws_security_group.allow_ssh",
                        "aws_security_group.sandpit-allow-elb-kibana",
                        "aws_security_group.sandpit-kibana",
                        "aws_security_group.sandpit-sends_influx",
                        "aws_subnet.sandpit-private-a"
                    ],
                    "primary": {
                        "id": "i-a5508e18",
                        "attributes": {
                            "ami": "ami-9b9c86f7",
                            "availability_zone": "eu-central-1a",
                            "ebs_block_device.#": "0",
                            "ebs_optimized": "false",
                            "ephemeral_block_device.#": "0",
                            "iam_instance_profile": "",
                            "id": "i-a5508e18",
                            "instance_state": "running",
                            "instance_type": "t2.micro",
                            "key_name": "ops-terraboot",
                            "monitoring": "true",
                            "private_dns": "ip-172-20-8-168.eu-central-1.compute.internal",
                            "private_ip": "172.20.8.168",
                            "public_dns": "",
                            "public_ip": "",
                            "root_block_device.#": "1",
                            "root_block_device.0.delete_on_termination": "true",
                            "root_block_device.0.iops": "24",
                            "root_block_device.0.volume_size": "8",
                            "root_block_device.0.volume_type": "gp2",
                            "security_groups.#": "0",
                            "source_dest_check": "true",
                            "subnet_id": "subnet-6283d00b",
                            "tags.#": "1",
                            "tags.Name": "sandpit-kibana",
                            "tenancy": "default",
                            "vpc_security_group_ids.#": "4",
                            "vpc_security_group_ids.1347873979": "sg-d66e63bf",
                            "vpc_security_group_ids.202169469": "sg-213b2748",
                            "vpc_security_group_ids.2578033345": "sg-a06e63c9",
                            "vpc_security_group_ids.3375680860": "sg-e7676e8e"
                        },
                        "meta": {
                            "schema_version": "1"
                        }
                    }
                },
                "aws_instance.sandpit-logstash": {
                    "type": "aws_instance",
                    "depends_on": [
                        "aws_security_group.allow_ssh",
                        "aws_security_group.sandpit-all-servers",
                        "aws_security_group.sandpit-logstash",
                        "aws_security_group.sandpit-sends_influx",
                        "aws_subnet.sandpit-public-a"
                    ],
                    "primary": {
                        "id": "i-df469962",
                        "attributes": {
                            "ami": "ami-9b9c86f7",
                            "associate_public_ip_address": "true",
                            "availability_zone": "eu-central-1a",
                            "ebs_block_device.#": "0",
                            "ebs_optimized": "false",
                            "ephemeral_block_device.#": "0",
                            "iam_instance_profile": "",
                            "id": "i-df469962",
                            "instance_state": "running",
                            "instance_type": "t2.micro",
                            "key_name": "ops-terraboot",
                            "monitoring": "true",
                            "private_dns": "ip-172-20-0-80.eu-central-1.compute.internal",
                            "private_ip": "172.20.0.80",
                            "public_dns": "ec2-52-29-4-154.eu-central-1.compute.amazonaws.com",
                            "public_ip": "52.29.4.154",
                            "root_block_device.#": "1",
                            "root_block_device.0.delete_on_termination": "true",
                            "root_block_device.0.iops": "24",
                            "root_block_device.0.volume_size": "8",
                            "root_block_device.0.volume_type": "gp2",
                            "security_groups.#": "0",
                            "source_dest_check": "true",
                            "subnet_id": "subnet-6583d00c",
                            "tags.#": "1",
                            "tags.Name": "sandpit-logstash",
                            "tenancy": "default",
                            "vpc_security_group_ids.#": "4",
                            "vpc_security_group_ids.1948651400": "sg-a327c4cb",
                            "vpc_security_group_ids.202169469": "sg-213b2748",
                            "vpc_security_group_ids.2578033345": "sg-a06e63c9",
                            "vpc_security_group_ids.3455150490": "sg-a36e63ca"
                        },
                        "meta": {
                            "schema_version": "1"
                        }
                    }
                },
                "aws_instance.sandpit-staging-dns": {
                    "type": "aws_instance",
                    "depends_on": [
                        "aws_security_group.allow_ssh",
                        "aws_security_group.sandpit-staging-dns",
                        "aws_subnet.sandpit-private-a",
                        "template_file.sandpit-staging-dns-user-data"
                    ],
                    "primary": {
                        "id": "i-9a9b3a27",
                        "attributes": {
                            "ami": "ami-9b9c86f7",
                            "associate_public_ip_address": "true",
                            "availability_zone": "eu-central-1a",
                            "ebs_block_device.#": "0",
                            "ebs_optimized": "false",
                            "ephemeral_block_device.#": "0",
                            "iam_instance_profile": "",
                            "id": "i-9a9b3a27",
                            "instance_state": "running",
                            "instance_type": "t2.micro",
                            "key_name": "ops-terraboot",
                            "monitoring": "true",
                            "private_dns": "ip-172-20-8-186.eu-central-1.compute.internal",
                            "private_ip": "172.20.8.186",
                            "public_dns": "ec2-52-58-83-192.eu-central-1.compute.amazonaws.com",
                            "public_ip": "52.58.83.192",
                            "root_block_device.#": "1",
                            "root_block_device.0.delete_on_termination": "true",
                            "root_block_device.0.iops": "24",
                            "root_block_device.0.volume_size": "8",
                            "root_block_device.0.volume_type": "gp2",
                            "security_groups.#": "0",
                            "source_dest_check": "true",
                            "subnet_id": "subnet-6283d00b",
                            "tags.#": "1",
                            "tags.Name": "sandpit-staging-dns",
                            "tenancy": "default",
                            "user_data": "62dfb96109c037902f8fdccf12925e210b00ee9f",
                            "vpc_security_group_ids.#": "2",
                            "vpc_security_group_ids.2578033345": "sg-a06e63c9",
                            "vpc_security_group_ids.3080925112": "sg-7650b61e"
                        },
                        "meta": {
                            "schema_version": "1"
                        }
                    }
                },
                "aws_instance.sandpit-vpn": {
                    "type": "aws_instance",
                    "depends_on": [
                        "aws_security_group.allow_ssh",
                        "aws_security_group.sandpit-all-servers",
                        "aws_security_group.sandpit-sends_influx",
                        "aws_security_group.sandpit-vpn",
                        "aws_subnet.sandpit-public-b"
                    ],
                    "primary": {
                        "id": "i-32fb658e",
                        "attributes": {
                            "ami": "ami-bc5b48d0",
                            "associate_public_ip_address": "true",
                            "availability_zone": "eu-central-1b",
                            "ebs_block_device.#": "0",
                            "ebs_optimized": "false",
                            "ephemeral_block_device.#": "0",
                            "iam_instance_profile": "",
                            "id": "i-32fb658e",
                            "instance_state": "running",
                            "instance_type": "t2.micro",
                            "key_name": "ops-terraboot",
                            "monitoring": "true",
                            "private_dns": "ip-172-20-1-175.eu-central-1.compute.internal",
                            "private_ip": "172.20.1.175",
                            "public_dns": "ec2-52-58-114-112.eu-central-1.compute.amazonaws.com",
                            "public_ip": "52.58.114.112",
                            "root_block_device.#": "1",
                            "root_block_device.0.delete_on_termination": "true",
                            "root_block_device.0.iops": "24",
                            "root_block_device.0.volume_size": "8",
                            "root_block_device.0.volume_type": "gp2",
                            "security_groups.#": "0",
                            "source_dest_check": "true",
                            "subnet_id": "subnet-af5127d4",
                            "tags.#": "1",
                            "tags.Name": "sandpit-vpn",
                            "tenancy": "default",
                            "user_data": "09ece7c4e70edcb39529f27052f108bf83fd81b0",
                            "vpc_security_group_ids.#": "4",
                            "vpc_security_group_ids.1076837772": "sg-a56e63cc",
                            "vpc_security_group_ids.1948651400": "sg-a327c4cb",
                            "vpc_security_group_ids.202169469": "sg-213b2748",
                            "vpc_security_group_ids.2578033345": "sg-a06e63c9"
                        },
                        "meta": {
                            "schema_version": "1"
                        }
                    }
                },
                "aws_internet_gateway.sandpit": {
                    "type": "aws_internet_gateway",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "igw-d002bcb9",
                        "attributes": {
                            "id": "igw-d002bcb9",
                            "tags.#": "1",
                            "tags.Name": "main",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_launch_configuration.master-group": {
                    "type": "aws_launch_configuration",
                    "depends_on": [
                        "aws_elb.master-group",
                        "aws_iam_access_key.host-key",
                        "aws_iam_access_key.host-key",
                        "aws_iam_instance_profile.master-group",
                        "aws_iam_role.master-role",
                        "aws_iam_role.slave-role",
                        "aws_security_group.admin-security-group",
                        "aws_security_group.allow_elb_master-group",
                        "aws_security_group.master-security-group"
                    ],
                    "primary": null,
                    "tainted": [
                        {
                            "id": "master-group-duzd5ctj3rdlrcgfil5s4u4bfa",
                            "attributes": {
                                "associate_public_ip_address": "false",
                                "ebs_block_device.#": "0",
                                "ebs_optimized": "false",
                                "enable_monitoring": "true",
                                "ephemeral_block_device.#": "0",
                                "iam_instance_profile": "master-group-profile",
                                "id": "master-group-duzd5ctj3rdlrcgfil5s4u4bfa",
                                "image_id": "ami-07f1ec6b",
                                "instance_type": "m4.xlarge",
                                "key_name": "ops-terraboot",
                                "name": "master-group-duzd5ctj3rdlrcgfil5s4u4bfa",
                                "name_prefix": "master-group-",
                                "root_block_device.#": "0",
                                "security_groups.#": "3",
                                "security_groups.3424462647": "sg-56c4c13f",
                                "security_groups.3867024774": "sg-4e3d3927",
                                "security_groups.4258872513": "sg-29c4c140",
                                "spot_price": "",
                                "user_data": "616ebc6e3f12abc215bb2988f2123c19934e27c9"
                            }
                        },
                        {
                            "id": "master-group-duzd5ctj3rdlrcgfil5s4u4bfa",
                            "attributes": {
                                "associate_public_ip_address": "false",
                                "ebs_block_device.#": "0",
                                "ebs_optimized": "false",
                                "enable_monitoring": "true",
                                "ephemeral_block_device.#": "0",
                                "iam_instance_profile": "master-group-profile",
                                "id": "master-group-duzd5ctj3rdlrcgfil5s4u4bfa",
                                "image_id": "ami-07f1ec6b",
                                "instance_type": "m4.xlarge",
                                "key_name": "ops-terraboot",
                                "name": "master-group-duzd5ctj3rdlrcgfil5s4u4bfa",
                                "name_prefix": "master-group-",
                                "root_block_device.#": "0",
                                "security_groups.#": "3",
                                "security_groups.3424462647": "sg-56c4c13f",
                                "security_groups.3867024774": "sg-4e3d3927",
                                "security_groups.4258872513": "sg-29c4c140",
                                "spot_price": "",
                                "user_data": "616ebc6e3f12abc215bb2988f2123c19934e27c9"
                            }
                        }
                    ]
                },
                "aws_launch_configuration.public-slave-group": {
                    "type": "aws_launch_configuration",
                    "depends_on": [
                        "aws_elb.master-group",
                        "aws_iam_access_key.host-key",
                        "aws_iam_access_key.host-key",
                        "aws_iam_instance_profile.public-slave-group",
                        "aws_iam_role.master-role",
                        "aws_iam_role.slave-role",
                        "aws_security_group.allow_elb_public-slave-group",
                        "aws_security_group.public-slave-security-group"
                    ],
                    "primary": null,
                    "tainted": [
                        {
                            "id": "public-slave-group-z3tmx5kwuvdxha3w36fhgcugxe",
                            "attributes": {
                                "associate_public_ip_address": "false",
                                "ebs_block_device.#": "0",
                                "ebs_optimized": "false",
                                "enable_monitoring": "true",
                                "ephemeral_block_device.#": "0",
                                "iam_instance_profile": "public-slave-group-profile",
                                "id": "public-slave-group-z3tmx5kwuvdxha3w36fhgcugxe",
                                "image_id": "ami-07f1ec6b",
                                "instance_type": "m4.xlarge",
                                "key_name": "ops-terraboot",
                                "name": "public-slave-group-z3tmx5kwuvdxha3w36fhgcugxe",
                                "name_prefix": "public-slave-group-",
                                "root_block_device.#": "0",
                                "security_groups.#": "2",
                                "security_groups.1881929361": "sg-403d3929",
                                "security_groups.839245984": "sg-2bc4c142",
                                "spot_price": "",
                                "user_data": "cbabe1379ac5d15fc18d0488c0c766c5fa32f463"
                            }
                        },
                        {
                            "id": "public-slave-group-z3tmx5kwuvdxha3w36fhgcugxe",
                            "attributes": {
                                "associate_public_ip_address": "false",
                                "ebs_block_device.#": "0",
                                "ebs_optimized": "false",
                                "enable_monitoring": "true",
                                "ephemeral_block_device.#": "0",
                                "iam_instance_profile": "public-slave-group-profile",
                                "id": "public-slave-group-z3tmx5kwuvdxha3w36fhgcugxe",
                                "image_id": "ami-07f1ec6b",
                                "instance_type": "m4.xlarge",
                                "key_name": "ops-terraboot",
                                "name": "public-slave-group-z3tmx5kwuvdxha3w36fhgcugxe",
                                "name_prefix": "public-slave-group-",
                                "root_block_device.#": "0",
                                "security_groups.#": "2",
                                "security_groups.1881929361": "sg-403d3929",
                                "security_groups.839245984": "sg-2bc4c142",
                                "spot_price": "",
                                "user_data": "cbabe1379ac5d15fc18d0488c0c766c5fa32f463"
                            }
                        }
                    ]
                },
                "aws_launch_configuration.sandpit-staging-masters": {
                    "type": "aws_launch_configuration",
                    "depends_on": [
                        "aws_iam_instance_profile.sandpit-staging-masters",
                        "aws_security_group.allow_ssh",
                        "aws_security_group.sandpit-all-servers",
                        "aws_security_group.sandpit-sends_gelf",
                        "aws_security_group.sandpit-sends_influx",
                        "aws_security_group.sandpit-staging-admin-security-group",
                        "aws_security_group.sandpit-staging-master-security-group",
                        "template_file.sandpit-staging-master-user-data"
                    ],
                    "primary": {
                        "id": "sandpit-staging-masters-juhg5gq45vgz3cmkjuqxp7ta7q",
                        "attributes": {
                            "associate_public_ip_address": "true",
                            "ebs_block_device.#": "0",
                            "ebs_optimized": "false",
                            "enable_monitoring": "true",
                            "ephemeral_block_device.#": "0",
                            "iam_instance_profile": "sandpit-staging-masters-profile",
                            "id": "sandpit-staging-masters-juhg5gq45vgz3cmkjuqxp7ta7q",
                            "image_id": "ami-1807e377",
                            "instance_type": "m4.large",
                            "key_name": "ops-terraboot",
                            "name": "sandpit-staging-masters-juhg5gq45vgz3cmkjuqxp7ta7q",
                            "name_prefix": "sandpit-staging-masters-",
                            "root_block_device.#": "1",
                            "root_block_device.0.delete_on_termination": "true",
                            "root_block_device.0.iops": "0",
                            "root_block_device.0.volume_size": "20",
                            "root_block_device.0.volume_type": "",
                            "security_groups.#": "6",
                            "security_groups.1489236821": "sg-2579634c",
                            "security_groups.1948651400": "sg-a327c4cb",
                            "security_groups.202169469": "sg-213b2748",
                            "security_groups.2578033345": "sg-a06e63c9",
                            "security_groups.423697735": "sg-2679634f",
                            "security_groups.813833176": "sg-ad6e63c4",
                            "spot_price": "",
                            "user_data": "680b0b17bbf65ae52d957fbe68349f304f25fddf"
                        }
                    }
                },
                "aws_launch_configuration.sandpit-staging-public-slaves": {
                    "type": "aws_launch_configuration",
                    "depends_on": [
                        "aws_iam_instance_profile.sandpit-staging-public-slaves",
                        "aws_security_group.allow_ssh",
                        "aws_security_group.sandpit-all-servers",
                        "aws_security_group.sandpit-sends_gelf",
                        "aws_security_group.sandpit-sends_influx",
                        "aws_security_group.sandpit-staging-public-slave-security-group",
                        "template_file.sandpit-staging-public-slave-user-data"
                    ],
                    "primary": {
                        "id": "sandpit-staging-public-slaves-ca5qacsqsrhzzaononoohxjfrq",
                        "attributes": {
                            "associate_public_ip_address": "true",
                            "ebs_block_device.#": "0",
                            "ebs_optimized": "false",
                            "enable_monitoring": "true",
                            "ephemeral_block_device.#": "0",
                            "iam_instance_profile": "sandpit-staging-public-slaves-profile",
                            "id": "sandpit-staging-public-slaves-ca5qacsqsrhzzaononoohxjfrq",
                            "image_id": "ami-1807e377",
                            "instance_type": "m4.xlarge",
                            "key_name": "ops-terraboot",
                            "name": "sandpit-staging-public-slaves-ca5qacsqsrhzzaononoohxjfrq",
                            "name_prefix": "sandpit-staging-public-slaves-",
                            "root_block_device.#": "1",
                            "root_block_device.0.delete_on_termination": "true",
                            "root_block_device.0.iops": "0",
                            "root_block_device.0.volume_size": "0",
                            "root_block_device.0.volume_type": "",
                            "security_groups.#": "5",
                            "security_groups.1948651400": "sg-a327c4cb",
                            "security_groups.202169469": "sg-213b2748",
                            "security_groups.2578033345": "sg-a06e63c9",
                            "security_groups.641681225": "sg-2779634e",
                            "security_groups.813833176": "sg-ad6e63c4",
                            "spot_price": "",
                            "user_data": "cccfc5b857b63ace9df00766fa43ed0ef0d4f10d"
                        }
                    }
                },
                "aws_launch_configuration.sandpit-staging-slaves": {
                    "type": "aws_launch_configuration",
                    "depends_on": [
                        "aws_iam_instance_profile.sandpit-staging-slaves",
                        "aws_security_group.allow_ssh",
                        "aws_security_group.sandpit-all-servers",
                        "aws_security_group.sandpit-sends_gelf",
                        "aws_security_group.sandpit-sends_influx",
                        "aws_security_group.sandpit-staging-slave-security-group",
                        "template_file.sandpit-staging-slave-user-data"
                    ],
                    "primary": {
                        "id": "sandpit-staging-slaves-qn4yudltv5cupac6sn4vvubodu",
                        "attributes": {
                            "associate_public_ip_address": "false",
                            "ebs_block_device.#": "0",
                            "ebs_optimized": "false",
                            "enable_monitoring": "true",
                            "ephemeral_block_device.#": "0",
                            "iam_instance_profile": "sandpit-staging-slaves-profile",
                            "id": "sandpit-staging-slaves-qn4yudltv5cupac6sn4vvubodu",
                            "image_id": "ami-1807e377",
                            "instance_type": "m4.xlarge",
                            "key_name": "ops-terraboot",
                            "name": "sandpit-staging-slaves-qn4yudltv5cupac6sn4vvubodu",
                            "name_prefix": "sandpit-staging-slaves-",
                            "root_block_device.#": "1",
                            "root_block_device.0.delete_on_termination": "true",
                            "root_block_device.0.iops": "0",
                            "root_block_device.0.volume_size": "0",
                            "root_block_device.0.volume_type": "",
                            "security_groups.#": "5",
                            "security_groups.1624272194": "sg-2479634d",
                            "security_groups.1948651400": "sg-a327c4cb",
                            "security_groups.202169469": "sg-213b2748",
                            "security_groups.2578033345": "sg-a06e63c9",
                            "security_groups.813833176": "sg-ad6e63c4",
                            "spot_price": "",
                            "user_data": "3d93c49b607409af421614319f7fe9524b477ea9"
                        }
                    }
                },
                "aws_launch_configuration.slave-group": {
                    "type": "aws_launch_configuration",
                    "depends_on": [
                        "aws_elb.master-group",
                        "aws_iam_access_key.host-key",
                        "aws_iam_access_key.host-key",
                        "aws_iam_instance_profile.slave-group",
                        "aws_iam_role.master-role",
                        "aws_iam_role.slave-role",
                        "aws_security_group.slave-security-group"
                    ],
                    "primary": null,
                    "tainted": [
                        {
                            "id": "slave-group-7eblfxpqfrb67dabuw5jiet34m",
                            "attributes": {
                                "associate_public_ip_address": "false",
                                "ebs_block_device.#": "0",
                                "ebs_optimized": "false",
                                "enable_monitoring": "true",
                                "ephemeral_block_device.#": "0",
                                "iam_instance_profile": "slave-group-profile",
                                "id": "slave-group-7eblfxpqfrb67dabuw5jiet34m",
                                "image_id": "ami-07f1ec6b",
                                "instance_type": "m4.xlarge",
                                "key_name": "ops-terraboot",
                                "name": "slave-group-7eblfxpqfrb67dabuw5jiet34m",
                                "name_prefix": "slave-group-",
                                "root_block_device.#": "0",
                                "security_groups.#": "1",
                                "security_groups.749275107": "sg-28c4c141",
                                "spot_price": "",
                                "user_data": "046b933e74f7baa5aedecc34882f0fff2d431e69"
                            }
                        },
                        {
                            "id": "slave-group-7eblfxpqfrb67dabuw5jiet34m",
                            "attributes": {
                                "associate_public_ip_address": "false",
                                "ebs_block_device.#": "0",
                                "ebs_optimized": "false",
                                "enable_monitoring": "true",
                                "ephemeral_block_device.#": "0",
                                "iam_instance_profile": "slave-group-profile",
                                "id": "slave-group-7eblfxpqfrb67dabuw5jiet34m",
                                "image_id": "ami-07f1ec6b",
                                "instance_type": "m4.xlarge",
                                "key_name": "ops-terraboot",
                                "name": "slave-group-7eblfxpqfrb67dabuw5jiet34m",
                                "name_prefix": "slave-group-",
                                "root_block_device.#": "0",
                                "security_groups.#": "1",
                                "security_groups.749275107": "sg-28c4c141",
                                "spot_price": "",
                                "user_data": "046b933e74f7baa5aedecc34882f0fff2d431e69"
                            }
                        }
                    ]
                },
                "aws_nat_gateway.sandpit-public-a": {
                    "type": "aws_nat_gateway",
                    "depends_on": [
                        "aws_eip.sandpit-public-a-nat",
                        "aws_subnet.sandpit-public-a"
                    ],
                    "primary": {
                        "id": "nat-093c4b80770aabc9e",
                        "attributes": {
                            "allocation_id": "eipalloc-b83eedd1",
                            "id": "nat-093c4b80770aabc9e",
                            "network_interface_id": "eni-652ffa0e",
                            "private_ip": "172.20.0.175",
                            "public_ip": "52.58.52.87",
                            "subnet_id": "subnet-6583d00c"
                        }
                    }
                },
                "aws_nat_gateway.sandpit-public-b": {
                    "type": "aws_nat_gateway",
                    "depends_on": [
                        "aws_eip.sandpit-public-b-nat",
                        "aws_subnet.sandpit-public-b"
                    ],
                    "primary": {
                        "id": "nat-05f285975dd0e69d3",
                        "attributes": {
                            "allocation_id": "eipalloc-7c23f015",
                            "id": "nat-05f285975dd0e69d3",
                            "network_interface_id": "eni-79525e03",
                            "private_ip": "172.20.1.156",
                            "public_ip": "52.58.62.184",
                            "subnet_id": "subnet-af5127d4"
                        }
                    }
                },
                "aws_route53_record.chronograf__mastodonc__net": {
                    "type": "aws_route53_record",
                    "depends_on": [
                        "aws_elb.chronograf"
                    ],
                    "primary": {
                        "id": "Z1EFD0WXZUIXYT_chronograf.mastodonc.net_CNAME",
                        "attributes": {
                            "failover": "",
                            "fqdn": "chronograf.mastodonc.net",
                            "health_check_id": "",
                            "id": "Z1EFD0WXZUIXYT_chronograf.mastodonc.net_CNAME",
                            "name": "chronograf.mastodonc.net",
                            "records.#": "1",
                            "records.950888394": "chronograf-1587775837.eu-central-1.elb.amazonaws.com",
                            "set_identifier": "",
                            "ttl": "300",
                            "type": "CNAME",
                            "weight": "-1",
                            "zone_id": "Z1EFD0WXZUIXYT"
                        }
                    }
                },
                "aws_route53_record.influxdb__mastodonc__net": {
                    "type": "aws_route53_record",
                    "depends_on": [
                        "aws_eip.influxdb"
                    ],
                    "primary": {
                        "id": "Z1EFD0WXZUIXYT_influxdb.mastodonc.net_A",
                        "attributes": {
                            "failover": "",
                            "fqdn": "influxdb.mastodonc.net",
                            "health_check_id": "",
                            "id": "Z1EFD0WXZUIXYT_influxdb.mastodonc.net_A",
                            "name": "influxdb.mastodonc.net",
                            "records.#": "1",
                            "records.1622729698": "52.58.73.254",
                            "set_identifier": "",
                            "ttl": "300",
                            "type": "A",
                            "weight": "-1",
                            "zone_id": "Z1EFD0WXZUIXYT"
                        }
                    }
                },
                "aws_route53_record.kibana__mastodonc__net": {
                    "type": "aws_route53_record",
                    "depends_on": [
                        "aws_elb.kibana"
                    ],
                    "primary": {
                        "id": "Z1EFD0WXZUIXYT_kibana.mastodonc.net_CNAME",
                        "attributes": {
                            "failover": "",
                            "fqdn": "kibana.mastodonc.net",
                            "health_check_id": "",
                            "id": "Z1EFD0WXZUIXYT_kibana.mastodonc.net_CNAME",
                            "name": "kibana.mastodonc.net",
                            "records.#": "1",
                            "records.1282467356": "kibana-2068457569.eu-central-1.elb.amazonaws.com",
                            "set_identifier": "",
                            "ttl": "300",
                            "type": "CNAME",
                            "weight": "-1",
                            "zone_id": "Z1EFD0WXZUIXYT"
                        }
                    }
                },
                "aws_route53_record.logstash__mastodonc__net": {
                    "type": "aws_route53_record",
                    "depends_on": [
                        "aws_eip.sandpit-logstash"
                    ],
                    "primary": {
                        "id": "Z1EFD0WXZUIXYT_logstash.mastodonc.net_A",
                        "attributes": {
                            "failover": "",
                            "fqdn": "logstash.mastodonc.net",
                            "health_check_id": "",
                            "id": "Z1EFD0WXZUIXYT_logstash.mastodonc.net_A",
                            "name": "logstash.mastodonc.net",
                            "records.#": "1",
                            "records.1633350318": "52.29.4.154",
                            "set_identifier": "",
                            "ttl": "300",
                            "type": "A",
                            "weight": "-1",
                            "zone_id": "Z1EFD0WXZUIXYT"
                        }
                    }
                },
                "aws_route53_record.sandpit-influxdb": {
                    "type": "aws_route53_record",
                    "depends_on": [
                        "aws_instance.influxdb",
                        "aws_route53_zone.sandpit-mesos"
                    ],
                    "primary": {
                        "id": "Z26V64HAK6770T_influxdb.sandpit-kixi.mesos_A",
                        "attributes": {
                            "failover": "",
                            "fqdn": "influxdb.sandpit-kixi.mesos",
                            "health_check_id": "",
                            "id": "Z26V64HAK6770T_influxdb.sandpit-kixi.mesos_A",
                            "name": "influxdb.sandpit-kixi.mesos",
                            "records.#": "1",
                            "records.1486106679": "172.20.0.153",
                            "set_identifier": "",
                            "ttl": "300",
                            "type": "A",
                            "weight": "-1",
                            "zone_id": "Z26V64HAK6770T"
                        }
                    }
                },
                "aws_route53_record.sandpit-staging-deploy__mastodonc__net": {
                    "type": "aws_route53_record",
                    "depends_on": [
                        "aws_elb.sandpit-staging-public-slaves",
                        "aws_elb.sandpit-staging-public-slaves"
                    ],
                    "primary": {
                        "id": "Z1EFD0WXZUIXYT_sandpit-staging-deploy.mastodonc.net_A",
                        "attributes": {
                            "alias.#": "1",
                            "alias.1139529938.evaluate_target_health": "true",
                            "alias.1139529938.name": "sandpit-staging-public-slaves-1802906586.eu-central-1.elb.amazonaws.com",
                            "alias.1139529938.zone_id": "Z215JYRZR1TBD5",
                            "failover": "",
                            "fqdn": "sandpit-staging-deploy.mastodonc.net",
                            "health_check_id": "",
                            "id": "Z1EFD0WXZUIXYT_sandpit-staging-deploy.mastodonc.net_A",
                            "name": "sandpit-staging-deploy.mastodonc.net",
                            "records.#": "0",
                            "set_identifier": "",
                            "ttl": "0",
                            "type": "A",
                            "weight": "-1",
                            "zone_id": "Z1EFD0WXZUIXYT"
                        }
                    }
                },
                "aws_route53_record.sandpit-staging-dns": {
                    "type": "aws_route53_record",
                    "depends_on": [
                        "aws_instance.sandpit-staging-dns",
                        "aws_route53_zone.sandpit-mesos"
                    ],
                    "primary": {
                        "id": "Z26V64HAK6770T_staging-dns.sandpit-kixi.mesos_A",
                        "attributes": {
                            "failover": "",
                            "fqdn": "staging-dns.sandpit-kixi.mesos",
                            "health_check_id": "",
                            "id": "Z26V64HAK6770T_staging-dns.sandpit-kixi.mesos_A",
                            "name": "staging-dns.sandpit-kixi.mesos",
                            "records.#": "1",
                            "records.2904617268": "172.20.8.186",
                            "set_identifier": "",
                            "ttl": "300",
                            "type": "A",
                            "weight": "-1",
                            "zone_id": "Z26V64HAK6770T"
                        }
                    }
                },
                "aws_route53_record.sandpit-staging-masters": {
                    "type": "aws_route53_record",
                    "depends_on": [
                        "aws_elb.sandpit-staging-internal-lb",
                        "aws_elb.sandpit-staging-internal-lb",
                        "aws_route53_zone.sandpit-mesos"
                    ],
                    "primary": {
                        "id": "Z26V64HAK6770T_staging-masters.sandpit-kixi.mesos_A",
                        "attributes": {
                            "alias.#": "1",
                            "alias.3876779484.evaluate_target_health": "true",
                            "alias.3876779484.name": "internal-sandpit-staging-internal-lb-1023536621.eu-central-1.elb.amazonaws.com",
                            "alias.3876779484.zone_id": "Z215JYRZR1TBD5",
                            "failover": "",
                            "fqdn": "staging-masters.sandpit-kixi.mesos",
                            "health_check_id": "",
                            "id": "Z26V64HAK6770T_staging-masters.sandpit-kixi.mesos_A",
                            "name": "staging-masters.sandpit-kixi.mesos",
                            "records.#": "0",
                            "set_identifier": "",
                            "ttl": "0",
                            "type": "A",
                            "weight": "-1",
                            "zone_id": "Z26V64HAK6770T"
                        }
                    }
                },
                "aws_route53_record.sandpit-staging__mastodonc__net": {
                    "type": "aws_route53_record",
                    "depends_on": [
                        "aws_elb.sandpit-staging-public-slaves",
                        "aws_elb.sandpit-staging-public-slaves"
                    ],
                    "primary": {
                        "id": "Z1EFD0WXZUIXYT_sandpit-staging.mastodonc.net_A",
                        "attributes": {
                            "alias.#": "1",
                            "alias.1139529938.evaluate_target_health": "true",
                            "alias.1139529938.name": "sandpit-staging-public-slaves-1802906586.eu-central-1.elb.amazonaws.com",
                            "alias.1139529938.zone_id": "Z215JYRZR1TBD5",
                            "failover": "",
                            "fqdn": "sandpit-staging.mastodonc.net",
                            "health_check_id": "",
                            "id": "Z1EFD0WXZUIXYT_sandpit-staging.mastodonc.net_A",
                            "name": "sandpit-staging.mastodonc.net",
                            "records.#": "0",
                            "set_identifier": "",
                            "ttl": "0",
                            "type": "A",
                            "weight": "-1",
                            "zone_id": "Z1EFD0WXZUIXYT"
                        }
                    }
                },
                "aws_route53_record.vpn__mastodonc__net": {
                    "type": "aws_route53_record",
                    "depends_on": [
                        "aws_instance.sandpit-vpn"
                    ],
                    "primary": {
                        "id": "Z1EFD0WXZUIXYT_vpn.mastodonc.net_A",
                        "attributes": {
                            "failover": "",
                            "fqdn": "vpn.mastodonc.net",
                            "health_check_id": "",
                            "id": "Z1EFD0WXZUIXYT_vpn.mastodonc.net_A",
                            "name": "vpn.mastodonc.net",
                            "records.#": "1",
                            "records.810035734": "52.58.114.112",
                            "set_identifier": "",
                            "ttl": "300",
                            "type": "A",
                            "weight": "-1",
                            "zone_id": "Z1EFD0WXZUIXYT"
                        }
                    }
                },
                "aws_route53_zone.sandpit-mesos": {
                    "type": "aws_route53_zone",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "Z26V64HAK6770T",
                        "attributes": {
                            "comment": "private routes within vpc",
                            "id": "Z26V64HAK6770T",
                            "name": "sandpit-kixi.mesos",
                            "name_servers.#": "4",
                            "name_servers.0": "ns-0.awsdns-00.com.",
                            "name_servers.1": "ns-1024.awsdns-00.org.",
                            "name_servers.2": "ns-1536.awsdns-00.co.uk.",
                            "name_servers.3": "ns-512.awsdns-00.net.",
                            "tags.#": "0",
                            "vpc_id": "vpc-3739425e",
                            "vpc_region": "eu-central-1",
                            "zone_id": "Z26V64HAK6770T"
                        }
                    }
                },
                "aws_route_table.sandpit-private-a": {
                    "type": "aws_route_table",
                    "depends_on": [
                        "aws_nat_gateway.sandpit-public-a",
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "rtb-bc2d66d5",
                        "attributes": {
                            "id": "rtb-bc2d66d5",
                            "propagating_vgws.#": "0",
                            "route.#": "1",
                            "route.427025615.cidr_block": "0.0.0.0/0",
                            "route.427025615.gateway_id": "",
                            "route.427025615.instance_id": "",
                            "route.427025615.nat_gateway_id": "nat-093c4b80770aabc9e",
                            "route.427025615.network_interface_id": "",
                            "route.427025615.vpc_peering_connection_id": "",
                            "tags.#": "1",
                            "tags.Name": "sandpit-private-a",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_route_table.sandpit-private-b": {
                    "type": "aws_route_table",
                    "depends_on": [
                        "aws_nat_gateway.sandpit-public-b",
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "rtb-b72d66de",
                        "attributes": {
                            "id": "rtb-b72d66de",
                            "propagating_vgws.#": "0",
                            "route.#": "1",
                            "route.512275525.cidr_block": "0.0.0.0/0",
                            "route.512275525.gateway_id": "",
                            "route.512275525.instance_id": "",
                            "route.512275525.nat_gateway_id": "nat-05f285975dd0e69d3",
                            "route.512275525.network_interface_id": "",
                            "route.512275525.vpc_peering_connection_id": "",
                            "tags.#": "1",
                            "tags.Name": "sandpit-private-b",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_route_table.sandpit-public": {
                    "type": "aws_route_table",
                    "depends_on": [
                        "aws_internet_gateway.sandpit",
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "rtb-e92d6680",
                        "attributes": {
                            "id": "rtb-e92d6680",
                            "propagating_vgws.#": "0",
                            "route.#": "1",
                            "route.2317873655.cidr_block": "0.0.0.0/0",
                            "route.2317873655.gateway_id": "igw-d002bcb9",
                            "route.2317873655.instance_id": "",
                            "route.2317873655.nat_gateway_id": "",
                            "route.2317873655.network_interface_id": "",
                            "route.2317873655.vpc_peering_connection_id": "",
                            "tags.#": "1",
                            "tags.Name": "sandpit-public",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_route_table_association.sandpit-private-a": {
                    "type": "aws_route_table_association",
                    "depends_on": [
                        "aws_route_table.sandpit-private-a",
                        "aws_subnet.sandpit-private-a"
                    ],
                    "primary": {
                        "id": "rtbassoc-48341e21",
                        "attributes": {
                            "id": "rtbassoc-48341e21",
                            "route_table_id": "rtb-bc2d66d5",
                            "subnet_id": "subnet-6283d00b"
                        }
                    }
                },
                "aws_route_table_association.sandpit-private-b": {
                    "type": "aws_route_table_association",
                    "depends_on": [
                        "aws_route_table.sandpit-private-b",
                        "aws_subnet.sandpit-private-b"
                    ],
                    "primary": {
                        "id": "rtbassoc-45341e2c",
                        "attributes": {
                            "id": "rtbassoc-45341e2c",
                            "route_table_id": "rtb-b72d66de",
                            "subnet_id": "subnet-a85127d3"
                        }
                    }
                },
                "aws_route_table_association.sandpit-public-a": {
                    "type": "aws_route_table_association",
                    "depends_on": [
                        "aws_route_table.sandpit-public",
                        "aws_subnet.sandpit-public-a"
                    ],
                    "primary": {
                        "id": "rtbassoc-ad371dc4",
                        "attributes": {
                            "id": "rtbassoc-ad371dc4",
                            "route_table_id": "rtb-e92d6680",
                            "subnet_id": "subnet-6583d00c"
                        }
                    }
                },
                "aws_route_table_association.sandpit-public-b": {
                    "type": "aws_route_table_association",
                    "depends_on": [
                        "aws_route_table.sandpit-public",
                        "aws_subnet.sandpit-public-b"
                    ],
                    "primary": {
                        "id": "rtbassoc-a8371dc1",
                        "attributes": {
                            "id": "rtbassoc-a8371dc1",
                            "route_table_id": "rtb-e92d6680",
                            "subnet_id": "subnet-af5127d4"
                        }
                    }
                },
                "aws_s3_bucket.sandpit-staging-exhibitor-s3-bucket": {
                    "type": "aws_s3_bucket",
                    "primary": {
                        "id": "sandpit-staging-exhibitor-s3-bucket",
                        "attributes": {
                            "acl": "private",
                            "arn": "arn:aws:s3:::sandpit-staging-exhibitor-s3-bucket",
                            "bucket": "sandpit-staging-exhibitor-s3-bucket",
                            "cors_rule.#": "0",
                            "force_destroy": "false",
                            "hosted_zone_id": "Z21DNDUVLTQW6Q",
                            "id": "sandpit-staging-exhibitor-s3-bucket",
                            "policy": "",
                            "region": "eu-central-1",
                            "tags.#": "0",
                            "website.#": "0"
                        }
                    }
                },
                "aws_security_group.allow_external_http_https": {
                    "type": "aws_security_group",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "sg-aa6e63c3",
                        "attributes": {
                            "description": "Managed by Terraform",
                            "egress.#": "0",
                            "id": "sg-aa6e63c3",
                            "ingress.#": "2",
                            "ingress.2214680975.cidr_blocks.#": "1",
                            "ingress.2214680975.cidr_blocks.0": "0.0.0.0/0",
                            "ingress.2214680975.from_port": "80",
                            "ingress.2214680975.protocol": "tcp",
                            "ingress.2214680975.security_groups.#": "0",
                            "ingress.2214680975.self": "false",
                            "ingress.2214680975.to_port": "80",
                            "ingress.2617001939.cidr_blocks.#": "1",
                            "ingress.2617001939.cidr_blocks.0": "0.0.0.0/0",
                            "ingress.2617001939.from_port": "443",
                            "ingress.2617001939.protocol": "tcp",
                            "ingress.2617001939.security_groups.#": "0",
                            "ingress.2617001939.self": "false",
                            "ingress.2617001939.to_port": "443",
                            "name": "allow_external_http_https",
                            "owner_id": "165664414043",
                            "tags.#": "1",
                            "tags.Name": "allow_external_http_https",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_security_group.allow_outbound": {
                    "type": "aws_security_group",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "sg-a86e63c1",
                        "attributes": {
                            "description": "Managed by Terraform",
                            "egress.#": "1",
                            "egress.482069346.cidr_blocks.#": "1",
                            "egress.482069346.cidr_blocks.0": "0.0.0.0/0",
                            "egress.482069346.from_port": "0",
                            "egress.482069346.protocol": "-1",
                            "egress.482069346.security_groups.#": "0",
                            "egress.482069346.self": "false",
                            "egress.482069346.to_port": "0",
                            "id": "sg-a86e63c1",
                            "ingress.#": "0",
                            "name": "allow_outbound",
                            "owner_id": "165664414043",
                            "tags.#": "1",
                            "tags.Name": "allow_outbound",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_security_group.allow_ssh": {
                    "type": "aws_security_group",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "sg-a06e63c9",
                        "attributes": {
                            "description": "Managed by Terraform",
                            "egress.#": "0",
                            "id": "sg-a06e63c9",
                            "ingress.#": "1",
                            "ingress.2541437006.cidr_blocks.#": "1",
                            "ingress.2541437006.cidr_blocks.0": "0.0.0.0/0",
                            "ingress.2541437006.from_port": "22",
                            "ingress.2541437006.protocol": "tcp",
                            "ingress.2541437006.security_groups.#": "0",
                            "ingress.2541437006.self": "false",
                            "ingress.2541437006.to_port": "22",
                            "name": "allow_ssh",
                            "owner_id": "165664414043",
                            "tags.#": "1",
                            "tags.Name": "allow_ssh",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_security_group.db-sandpit-alerts": {
                    "type": "aws_security_group",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "sg-4e30d326",
                        "attributes": {
                            "description": "Managed by Terraform",
                            "egress.#": "0",
                            "id": "sg-4e30d326",
                            "ingress.#": "1",
                            "ingress.3759328725.cidr_blocks.#": "0",
                            "ingress.3759328725.from_port": "5432",
                            "ingress.3759328725.protocol": "tcp",
                            "ingress.3759328725.security_groups.#": "1",
                            "ingress.3759328725.security_groups.1095294173": "sg-4f30d327",
                            "ingress.3759328725.self": "false",
                            "ingress.3759328725.to_port": "5432",
                            "name": "db-sandpit-alerts",
                            "owner_id": "165664414043",
                            "tags.#": "1",
                            "tags.Name": "db-sandpit-alerts",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_security_group.sandpit-all-servers": {
                    "type": "aws_security_group",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "sg-a327c4cb",
                        "attributes": {
                            "description": "Managed by Terraform",
                            "egress.#": "1",
                            "egress.482069346.cidr_blocks.#": "1",
                            "egress.482069346.cidr_blocks.0": "0.0.0.0/0",
                            "egress.482069346.from_port": "0",
                            "egress.482069346.protocol": "-1",
                            "egress.482069346.security_groups.#": "0",
                            "egress.482069346.self": "false",
                            "egress.482069346.to_port": "0",
                            "id": "sg-a327c4cb",
                            "ingress.#": "1",
                            "ingress.3113846462.cidr_blocks.#": "0",
                            "ingress.3113846462.from_port": "5666",
                            "ingress.3113846462.protocol": "tcp",
                            "ingress.3113846462.security_groups.#": "1",
                            "ingress.3113846462.security_groups.1264080262": "sg-a227c4ca",
                            "ingress.3113846462.self": "false",
                            "ingress.3113846462.to_port": "5666",
                            "name": "sandpit-all-servers",
                            "owner_id": "165664414043",
                            "tags.#": "1",
                            "tags.Name": "sandpit-all-servers",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_security_group.sandpit-allow-all-tcp-within-public-subnet": {
                    "type": "aws_security_group",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "sg-a26e63cb",
                        "attributes": {
                            "description": "Managed by Terraform",
                            "egress.#": "0",
                            "id": "sg-a26e63cb",
                            "ingress.#": "1",
                            "ingress.884276627.cidr_blocks.#": "3",
                            "ingress.884276627.cidr_blocks.0": "172.20.0.0/24",
                            "ingress.884276627.cidr_blocks.1": "172.20.1.0/24",
                            "ingress.884276627.cidr_blocks.2": "172.20.2.0/24",
                            "ingress.884276627.from_port": "0",
                            "ingress.884276627.protocol": "tcp",
                            "ingress.884276627.security_groups.#": "0",
                            "ingress.884276627.self": "false",
                            "ingress.884276627.to_port": "65535",
                            "name": "sandpit-allow-all-tcp-within-public-subnet",
                            "owner_id": "165664414043",
                            "tags.#": "1",
                            "tags.Name": "sandpit-allow-all-tcp-within-public-subnet",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_security_group.sandpit-allow-all-udp-within-public-subnet": {
                    "type": "aws_security_group",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "sg-a46e63cd",
                        "attributes": {
                            "description": "Managed by Terraform",
                            "egress.#": "0",
                            "id": "sg-a46e63cd",
                            "ingress.#": "1",
                            "ingress.1179898276.cidr_blocks.#": "3",
                            "ingress.1179898276.cidr_blocks.0": "172.20.0.0/24",
                            "ingress.1179898276.cidr_blocks.1": "172.20.1.0/24",
                            "ingress.1179898276.cidr_blocks.2": "172.20.2.0/24",
                            "ingress.1179898276.from_port": "0",
                            "ingress.1179898276.protocol": "udp",
                            "ingress.1179898276.security_groups.#": "0",
                            "ingress.1179898276.self": "false",
                            "ingress.1179898276.to_port": "65535",
                            "name": "sandpit-allow-all-udp-within-public-subnet",
                            "owner_id": "165664414043",
                            "tags.#": "1",
                            "tags.Name": "sandpit-allow-all-udp-within-public-subnet",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_security_group.sandpit-allow-elb-alerts": {
                    "type": "aws_security_group",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "sg-4200e32a",
                        "attributes": {
                            "description": "Managed by Terraform",
                            "egress.#": "0",
                            "id": "sg-4200e32a",
                            "ingress.#": "1",
                            "ingress.1388692892.cidr_blocks.#": "0",
                            "ingress.1388692892.from_port": "80",
                            "ingress.1388692892.protocol": "tcp",
                            "ingress.1388692892.security_groups.#": "1",
                            "ingress.1388692892.security_groups.361540221": "sg-4300e32b",
                            "ingress.1388692892.self": "false",
                            "ingress.1388692892.to_port": "80",
                            "name": "sandpit-allow-elb-alerts",
                            "owner_id": "165664414043",
                            "tags.#": "1",
                            "tags.Name": "sandpit-allow-elb-alerts",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_security_group.sandpit-allow-elb-kibana": {
                    "type": "aws_security_group",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "sg-e7676e8e",
                        "attributes": {
                            "description": "Managed by Terraform",
                            "egress.#": "0",
                            "id": "sg-e7676e8e",
                            "ingress.#": "1",
                            "ingress.4193730296.cidr_blocks.#": "0",
                            "ingress.4193730296.from_port": "80",
                            "ingress.4193730296.protocol": "tcp",
                            "ingress.4193730296.security_groups.#": "1",
                            "ingress.4193730296.security_groups.4132083538": "sg-e6676e8f",
                            "ingress.4193730296.self": "false",
                            "ingress.4193730296.to_port": "80",
                            "name": "sandpit-allow-elb-kibana",
                            "owner_id": "165664414043",
                            "tags.#": "1",
                            "tags.Name": "sandpit-allow-elb-kibana",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_security_group.sandpit-allow-icmp-within-public-subnet": {
                    "type": "aws_security_group",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "sg-ac6e63c5",
                        "attributes": {
                            "description": "Managed by Terraform",
                            "egress.#": "0",
                            "id": "sg-ac6e63c5",
                            "ingress.#": "1",
                            "ingress.1179898276.cidr_blocks.#": "3",
                            "ingress.1179898276.cidr_blocks.0": "172.20.0.0/24",
                            "ingress.1179898276.cidr_blocks.1": "172.20.1.0/24",
                            "ingress.1179898276.cidr_blocks.2": "172.20.2.0/24",
                            "ingress.1179898276.from_port": "0",
                            "ingress.1179898276.protocol": "udp",
                            "ingress.1179898276.security_groups.#": "0",
                            "ingress.1179898276.self": "false",
                            "ingress.1179898276.to_port": "65535",
                            "name": "sandpit-allow-icmp-within-public-subnet",
                            "owner_id": "165664414043",
                            "tags.#": "1",
                            "tags.Name": "sandpit-allow-icmp-within-public-subnet",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_security_group.sandpit-allow_elb_chronograf": {
                    "type": "aws_security_group",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "sg-80001ee9",
                        "attributes": {
                            "description": "Managed by Terraform",
                            "egress.#": "0",
                            "id": "sg-80001ee9",
                            "ingress.#": "2",
                            "ingress.1994621032.cidr_blocks.#": "1",
                            "ingress.1994621032.cidr_blocks.0": "0.0.0.0/0",
                            "ingress.1994621032.from_port": "3000",
                            "ingress.1994621032.protocol": "tcp",
                            "ingress.1994621032.security_groups.#": "0",
                            "ingress.1994621032.self": "false",
                            "ingress.1994621032.to_port": "3000",
                            "ingress.4236674411.cidr_blocks.#": "0",
                            "ingress.4236674411.from_port": "80",
                            "ingress.4236674411.protocol": "tcp",
                            "ingress.4236674411.security_groups.#": "1",
                            "ingress.4236674411.security_groups.2275809173": "sg-81001ee8",
                            "ingress.4236674411.self": "false",
                            "ingress.4236674411.to_port": "80",
                            "name": "sandpit-allow_elb_chronograf",
                            "owner_id": "165664414043",
                            "tags.#": "1",
                            "tags.Name": "sandpit-allow_elb_chronograf",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_security_group.sandpit-elb-alerts": {
                    "type": "aws_security_group",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "sg-4300e32b",
                        "attributes": {
                            "description": "Managed by Terraform",
                            "egress.#": "0",
                            "id": "sg-4300e32b",
                            "ingress.#": "0",
                            "name": "sandpit-elb-alerts",
                            "owner_id": "165664414043",
                            "tags.#": "1",
                            "tags.Name": "sandpit-elb-alerts",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_security_group.sandpit-elb-kibana": {
                    "type": "aws_security_group",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "sg-e6676e8f",
                        "attributes": {
                            "description": "Managed by Terraform",
                            "egress.#": "0",
                            "id": "sg-e6676e8f",
                            "ingress.#": "0",
                            "name": "sandpit-elb-kibana",
                            "owner_id": "165664414043",
                            "tags.#": "1",
                            "tags.Name": "sandpit-elb-kibana",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_security_group.sandpit-elb_chronograf": {
                    "type": "aws_security_group",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "sg-81001ee8",
                        "attributes": {
                            "description": "Managed by Terraform",
                            "egress.#": "0",
                            "id": "sg-81001ee8",
                            "ingress.#": "0",
                            "name": "sandpit-elb_chronograf",
                            "owner_id": "165664414043",
                            "tags.#": "1",
                            "tags.Name": "sandpit-elb_chronograf",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_security_group.sandpit-influxdb": {
                    "type": "aws_security_group",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "sg-fd021c94",
                        "attributes": {
                            "description": "Managed by Terraform",
                            "egress.#": "0",
                            "id": "sg-fd021c94",
                            "ingress.#": "3",
                            "ingress.2413557287.cidr_blocks.#": "1",
                            "ingress.2413557287.cidr_blocks.0": "0.0.0.0/0",
                            "ingress.2413557287.from_port": "222",
                            "ingress.2413557287.protocol": "tcp",
                            "ingress.2413557287.security_groups.#": "0",
                            "ingress.2413557287.self": "false",
                            "ingress.2413557287.to_port": "222",
                            "ingress.2507344533.cidr_blocks.#": "1",
                            "ingress.2507344533.cidr_blocks.0": "172.20.0.0/20",
                            "ingress.2507344533.from_port": "8083",
                            "ingress.2507344533.protocol": "tcp",
                            "ingress.2507344533.security_groups.#": "0",
                            "ingress.2507344533.self": "false",
                            "ingress.2507344533.to_port": "8083",
                            "ingress.3536875662.cidr_blocks.#": "0",
                            "ingress.3536875662.from_port": "8086",
                            "ingress.3536875662.protocol": "tcp",
                            "ingress.3536875662.security_groups.#": "1",
                            "ingress.3536875662.security_groups.202169469": "sg-213b2748",
                            "ingress.3536875662.self": "false",
                            "ingress.3536875662.to_port": "8086",
                            "name": "sandpit-influxdb",
                            "owner_id": "165664414043",
                            "tags.#": "1",
                            "tags.Name": "sandpit-influxdb",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_security_group.sandpit-kibana": {
                    "type": "aws_security_group",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "sg-d66e63bf",
                        "attributes": {
                            "description": "Managed by Terraform",
                            "egress.#": "0",
                            "id": "sg-d66e63bf",
                            "ingress.#": "0",
                            "name": "sandpit-kibana",
                            "owner_id": "165664414043",
                            "tags.#": "1",
                            "tags.Name": "sandpit-kibana",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_security_group.sandpit-logstash": {
                    "type": "aws_security_group",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "sg-a36e63ca",
                        "attributes": {
                            "description": "Managed by Terraform",
                            "egress.#": "0",
                            "id": "sg-a36e63ca",
                            "ingress.#": "4",
                            "ingress.1568200231.cidr_blocks.#": "1",
                            "ingress.1568200231.cidr_blocks.0": "0.0.0.0/0",
                            "ingress.1568200231.from_port": "12201",
                            "ingress.1568200231.protocol": "tcp",
                            "ingress.1568200231.security_groups.#": "0",
                            "ingress.1568200231.self": "false",
                            "ingress.1568200231.to_port": "12201",
                            "ingress.1914791466.cidr_blocks.#": "1",
                            "ingress.1914791466.cidr_blocks.0": "0.0.0.0/0",
                            "ingress.1914791466.from_port": "12201",
                            "ingress.1914791466.protocol": "udp",
                            "ingress.1914791466.security_groups.#": "0",
                            "ingress.1914791466.self": "false",
                            "ingress.1914791466.to_port": "12201",
                            "ingress.3126076377.cidr_blocks.#": "1",
                            "ingress.3126076377.cidr_blocks.0": "0.0.0.0/0",
                            "ingress.3126076377.from_port": "9200",
                            "ingress.3126076377.protocol": "udp",
                            "ingress.3126076377.security_groups.#": "0",
                            "ingress.3126076377.self": "false",
                            "ingress.3126076377.to_port": "9200",
                            "ingress.3170175585.cidr_blocks.#": "7",
                            "ingress.3170175585.cidr_blocks.0": "52.58.52.87/32",
                            "ingress.3170175585.cidr_blocks.1": "52.58.62.184/32",
                            "ingress.3170175585.cidr_blocks.2": "52.29.97.114/32",
                            "ingress.3170175585.cidr_blocks.3": "151.230.75.151/32",
                            "ingress.3170175585.cidr_blocks.4": "87.115.98.26/32",
                            "ingress.3170175585.cidr_blocks.5": "52.29.162.148/32",
                            "ingress.3170175585.cidr_blocks.6": "52.29.163.57/32",
                            "ingress.3170175585.from_port": "12201",
                            "ingress.3170175585.protocol": "udp",
                            "ingress.3170175585.security_groups.#": "1",
                            "ingress.3170175585.security_groups.813833176": "sg-ad6e63c4",
                            "ingress.3170175585.self": "false",
                            "ingress.3170175585.to_port": "12201",
                            "name": "sandpit-logstash",
                            "owner_id": "165664414043",
                            "tags.#": "1",
                            "tags.Name": "sandpit-logstash",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_security_group.sandpit-nrpe": {
                    "type": "aws_security_group",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "sg-a227c4ca",
                        "attributes": {
                            "description": "Managed by Terraform",
                            "egress.#": "0",
                            "id": "sg-a227c4ca",
                            "ingress.#": "0",
                            "name": "sandpit-nrpe",
                            "owner_id": "165664414043",
                            "tags.#": "1",
                            "tags.Name": "sandpit-nrpe",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_security_group.sandpit-sends_gelf": {
                    "type": "aws_security_group",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "sg-ad6e63c4",
                        "attributes": {
                            "description": "Managed by Terraform",
                            "egress.#": "0",
                            "id": "sg-ad6e63c4",
                            "ingress.#": "0",
                            "name": "sandpit-sends_gelf",
                            "owner_id": "165664414043",
                            "tags.#": "1",
                            "tags.Name": "sandpit-sends_gelf",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_security_group.sandpit-sends_influx": {
                    "type": "aws_security_group",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "sg-213b2748",
                        "attributes": {
                            "description": "Managed by Terraform",
                            "egress.#": "0",
                            "id": "sg-213b2748",
                            "ingress.#": "0",
                            "name": "sandpit-sends_influx",
                            "owner_id": "165664414043",
                            "tags.#": "1",
                            "tags.Name": "sandpit-sends_influx",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_security_group.sandpit-sends_logstash": {
                    "type": "aws_security_group",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "sg-f9e40291",
                        "attributes": {
                            "description": "Managed by Terraform",
                            "egress.#": "0",
                            "id": "sg-f9e40291",
                            "ingress.#": "0",
                            "name": "sandpit-sends_logstash",
                            "owner_id": "165664414043",
                            "tags.#": "1",
                            "tags.Name": "sandpit-sends_logstash",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_security_group.sandpit-staging-admin-security-group": {
                    "type": "aws_security_group",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "sg-2679634f",
                        "attributes": {
                            "description": "Managed by Terraform",
                            "egress.#": "0",
                            "id": "sg-2679634f",
                            "ingress.#": "2",
                            "ingress.1857834854.cidr_blocks.#": "1",
                            "ingress.1857834854.cidr_blocks.0": "172.20.0.0/20",
                            "ingress.1857834854.from_port": "0",
                            "ingress.1857834854.protocol": "tcp",
                            "ingress.1857834854.security_groups.#": "0",
                            "ingress.1857834854.self": "false",
                            "ingress.1857834854.to_port": "65535",
                            "ingress.2569057007.cidr_blocks.#": "1",
                            "ingress.2569057007.cidr_blocks.0": "172.20.0.0/20",
                            "ingress.2569057007.from_port": "0",
                            "ingress.2569057007.protocol": "udp",
                            "ingress.2569057007.security_groups.#": "0",
                            "ingress.2569057007.self": "false",
                            "ingress.2569057007.to_port": "65535",
                            "name": "sandpit-staging-admin-security-group",
                            "owner_id": "165664414043",
                            "tags.#": "1",
                            "tags.Name": "sandpit-staging-admin-security-group",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_security_group.sandpit-staging-dns": {
                    "type": "aws_security_group",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "sg-7650b61e",
                        "attributes": {
                            "description": "Managed by Terraform",
                            "egress.#": "0",
                            "id": "sg-7650b61e",
                            "ingress.#": "2",
                            "ingress.1428540150.cidr_blocks.#": "1",
                            "ingress.1428540150.cidr_blocks.0": "172.20.0.0/20",
                            "ingress.1428540150.from_port": "53",
                            "ingress.1428540150.protocol": "tcp",
                            "ingress.1428540150.security_groups.#": "0",
                            "ingress.1428540150.self": "false",
                            "ingress.1428540150.to_port": "53",
                            "ingress.2730047359.cidr_blocks.#": "1",
                            "ingress.2730047359.cidr_blocks.0": "172.20.0.0/20",
                            "ingress.2730047359.from_port": "53",
                            "ingress.2730047359.protocol": "udp",
                            "ingress.2730047359.security_groups.#": "0",
                            "ingress.2730047359.self": "false",
                            "ingress.2730047359.to_port": "53",
                            "name": "sandpit-staging-dns",
                            "owner_id": "165664414043",
                            "tags.#": "1",
                            "tags.Name": "sandpit-staging-dns",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_security_group.sandpit-staging-lb-security-group": {
                    "type": "aws_security_group",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "sg-2279634b",
                        "attributes": {
                            "description": "Managed by Terraform",
                            "egress.#": "1",
                            "egress.482069346.cidr_blocks.#": "1",
                            "egress.482069346.cidr_blocks.0": "0.0.0.0/0",
                            "egress.482069346.from_port": "0",
                            "egress.482069346.protocol": "-1",
                            "egress.482069346.security_groups.#": "0",
                            "egress.482069346.self": "false",
                            "egress.482069346.to_port": "0",
                            "id": "sg-2279634b",
                            "ingress.#": "1",
                            "ingress.2316642503.cidr_blocks.#": "0",
                            "ingress.2316642503.from_port": "2181",
                            "ingress.2316642503.protocol": "tcp",
                            "ingress.2316642503.security_groups.#": "1",
                            "ingress.2316642503.security_groups.1624272194": "sg-2479634d",
                            "ingress.2316642503.self": "false",
                            "ingress.2316642503.to_port": "2181",
                            "name": "sandpit-staging-lb-security-group",
                            "owner_id": "165664414043",
                            "tags.#": "1",
                            "tags.Name": "sandpit-staging-lb-security-group",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_security_group.sandpit-staging-master-security-group": {
                    "type": "aws_security_group",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "sg-2579634c",
                        "attributes": {
                            "description": "Managed by Terraform",
                            "egress.#": "0",
                            "id": "sg-2579634c",
                            "ingress.#": "6",
                            "ingress.1961040487.cidr_blocks.#": "0",
                            "ingress.1961040487.from_port": "80",
                            "ingress.1961040487.protocol": "tcp",
                            "ingress.1961040487.security_groups.#": "1",
                            "ingress.1961040487.security_groups.3932421453": "sg-2279634b",
                            "ingress.1961040487.self": "false",
                            "ingress.1961040487.to_port": "80",
                            "ingress.3027966217.cidr_blocks.#": "0",
                            "ingress.3027966217.from_port": "0",
                            "ingress.3027966217.protocol": "-1",
                            "ingress.3027966217.security_groups.#": "2",
                            "ingress.3027966217.security_groups.1624272194": "sg-2479634d",
                            "ingress.3027966217.security_groups.641681225": "sg-2779634e",
                            "ingress.3027966217.self": "false",
                            "ingress.3027966217.to_port": "0",
                            "ingress.3585322442.cidr_blocks.#": "0",
                            "ingress.3585322442.from_port": "8080",
                            "ingress.3585322442.protocol": "tcp",
                            "ingress.3585322442.security_groups.#": "1",
                            "ingress.3585322442.security_groups.3932421453": "sg-2279634b",
                            "ingress.3585322442.self": "false",
                            "ingress.3585322442.to_port": "8080",
                            "ingress.3731578767.cidr_blocks.#": "0",
                            "ingress.3731578767.from_port": "8181",
                            "ingress.3731578767.protocol": "tcp",
                            "ingress.3731578767.security_groups.#": "1",
                            "ingress.3731578767.security_groups.3932421453": "sg-2279634b",
                            "ingress.3731578767.self": "false",
                            "ingress.3731578767.to_port": "8181",
                            "ingress.4228913403.cidr_blocks.#": "0",
                            "ingress.4228913403.from_port": "5050",
                            "ingress.4228913403.protocol": "tcp",
                            "ingress.4228913403.security_groups.#": "1",
                            "ingress.4228913403.security_groups.3932421453": "sg-2279634b",
                            "ingress.4228913403.self": "false",
                            "ingress.4228913403.to_port": "5050",
                            "ingress.438339270.cidr_blocks.#": "0",
                            "ingress.438339270.from_port": "2181",
                            "ingress.438339270.protocol": "tcp",
                            "ingress.438339270.security_groups.#": "1",
                            "ingress.438339270.security_groups.3932421453": "sg-2279634b",
                            "ingress.438339270.self": "false",
                            "ingress.438339270.to_port": "2181",
                            "name": "sandpit-staging-master-security-group",
                            "owner_id": "165664414043",
                            "tags.#": "1",
                            "tags.Name": "sandpit-staging-master-security-group",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_security_group.sandpit-staging-public-slave-security-group": {
                    "type": "aws_security_group",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "sg-2779634e",
                        "attributes": {
                            "description": "Managed by Terraform",
                            "egress.#": "1",
                            "egress.482069346.cidr_blocks.#": "1",
                            "egress.482069346.cidr_blocks.0": "0.0.0.0/0",
                            "egress.482069346.from_port": "0",
                            "egress.482069346.protocol": "-1",
                            "egress.482069346.security_groups.#": "0",
                            "egress.482069346.self": "false",
                            "egress.482069346.to_port": "0",
                            "id": "sg-2779634e",
                            "ingress.#": "8",
                            "ingress.1217125192.cidr_blocks.#": "1",
                            "ingress.1217125192.cidr_blocks.0": "0.0.0.0/0",
                            "ingress.1217125192.from_port": "0",
                            "ingress.1217125192.protocol": "tcp",
                            "ingress.1217125192.security_groups.#": "0",
                            "ingress.1217125192.self": "false",
                            "ingress.1217125192.to_port": "21",
                            "ingress.1741843269.cidr_blocks.#": "1",
                            "ingress.1741843269.cidr_blocks.0": "0.0.0.0/0",
                            "ingress.1741843269.from_port": "0",
                            "ingress.1741843269.protocol": "udp",
                            "ingress.1741843269.security_groups.#": "0",
                            "ingress.1741843269.self": "false",
                            "ingress.1741843269.to_port": "21",
                            "ingress.2394445110.cidr_blocks.#": "0",
                            "ingress.2394445110.from_port": "0",
                            "ingress.2394445110.protocol": "-1",
                            "ingress.2394445110.security_groups.#": "2",
                            "ingress.2394445110.security_groups.1489236821": "sg-2579634c",
                            "ingress.2394445110.security_groups.1624272194": "sg-2479634d",
                            "ingress.2394445110.self": "true",
                            "ingress.2394445110.to_port": "0",
                            "ingress.2420401050.cidr_blocks.#": "1",
                            "ingress.2420401050.cidr_blocks.0": "0.0.0.0/0",
                            "ingress.2420401050.from_port": "5052",
                            "ingress.2420401050.protocol": "tcp",
                            "ingress.2420401050.security_groups.#": "0",
                            "ingress.2420401050.self": "false",
                            "ingress.2420401050.to_port": "65535",
                            "ingress.3066583803.cidr_blocks.#": "1",
                            "ingress.3066583803.cidr_blocks.0": "172.20.0.0/20",
                            "ingress.3066583803.from_port": "22",
                            "ingress.3066583803.protocol": "tcp",
                            "ingress.3066583803.security_groups.#": "0",
                            "ingress.3066583803.self": "false",
                            "ingress.3066583803.to_port": "22",
                            "ingress.3206402967.cidr_blocks.#": "1",
                            "ingress.3206402967.cidr_blocks.0": "0.0.0.0/0",
                            "ingress.3206402967.from_port": "5052",
                            "ingress.3206402967.protocol": "udp",
                            "ingress.3206402967.security_groups.#": "0",
                            "ingress.3206402967.self": "false",
                            "ingress.3206402967.to_port": "65535",
                            "ingress.477657457.cidr_blocks.#": "1",
                            "ingress.477657457.cidr_blocks.0": "0.0.0.0/0",
                            "ingress.477657457.from_port": "23",
                            "ingress.477657457.protocol": "udp",
                            "ingress.477657457.security_groups.#": "0",
                            "ingress.477657457.self": "false",
                            "ingress.477657457.to_port": "5050",
                            "ingress.857852284.cidr_blocks.#": "1",
                            "ingress.857852284.cidr_blocks.0": "0.0.0.0/0",
                            "ingress.857852284.from_port": "23",
                            "ingress.857852284.protocol": "tcp",
                            "ingress.857852284.security_groups.#": "0",
                            "ingress.857852284.self": "false",
                            "ingress.857852284.to_port": "5050",
                            "name": "sandpit-staging-public-slave-security-group",
                            "owner_id": "165664414043",
                            "tags.#": "1",
                            "tags.Name": "sandpit-staging-public-slave-security-group",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_security_group.sandpit-staging-slave-security-group": {
                    "type": "aws_security_group",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "sg-2479634d",
                        "attributes": {
                            "description": "Managed by Terraform",
                            "egress.#": "0",
                            "id": "sg-2479634d",
                            "ingress.#": "2",
                            "ingress.2590860363.cidr_blocks.#": "0",
                            "ingress.2590860363.from_port": "0",
                            "ingress.2590860363.protocol": "-1",
                            "ingress.2590860363.security_groups.#": "2",
                            "ingress.2590860363.security_groups.1489236821": "sg-2579634c",
                            "ingress.2590860363.security_groups.641681225": "sg-2779634e",
                            "ingress.2590860363.self": "true",
                            "ingress.2590860363.to_port": "0",
                            "ingress.438339270.cidr_blocks.#": "0",
                            "ingress.438339270.from_port": "2181",
                            "ingress.438339270.protocol": "tcp",
                            "ingress.438339270.security_groups.#": "1",
                            "ingress.438339270.security_groups.3932421453": "sg-2279634b",
                            "ingress.438339270.self": "false",
                            "ingress.438339270.to_port": "2181",
                            "name": "sandpit-staging-slave-security-group",
                            "owner_id": "165664414043",
                            "tags.#": "1",
                            "tags.Name": "sandpit-staging-slave-security-group",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_security_group.sandpit-vpn": {
                    "type": "aws_security_group",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "sg-a56e63cc",
                        "attributes": {
                            "description": "Managed by Terraform",
                            "egress.#": "0",
                            "id": "sg-a56e63cc",
                            "ingress.#": "2",
                            "ingress.2541437006.cidr_blocks.#": "1",
                            "ingress.2541437006.cidr_blocks.0": "0.0.0.0/0",
                            "ingress.2541437006.from_port": "22",
                            "ingress.2541437006.protocol": "tcp",
                            "ingress.2541437006.security_groups.#": "0",
                            "ingress.2541437006.self": "false",
                            "ingress.2541437006.to_port": "22",
                            "ingress.4178520169.cidr_blocks.#": "1",
                            "ingress.4178520169.cidr_blocks.0": "0.0.0.0/0",
                            "ingress.4178520169.from_port": "1194",
                            "ingress.4178520169.protocol": "udp",
                            "ingress.4178520169.security_groups.#": "0",
                            "ingress.4178520169.self": "false",
                            "ingress.4178520169.to_port": "1194",
                            "name": "sandpit-vpn",
                            "owner_id": "165664414043",
                            "tags.#": "1",
                            "tags.Name": "sandpit-vpn",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_security_group.uses-db-sandpit-alerts": {
                    "type": "aws_security_group",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "sg-4f30d327",
                        "attributes": {
                            "description": "Managed by Terraform",
                            "egress.#": "0",
                            "id": "sg-4f30d327",
                            "ingress.#": "0",
                            "name": "uses-db-sandpit-alerts",
                            "owner_id": "165664414043",
                            "tags.#": "1",
                            "tags.Name": "uses-db-sandpit-alerts",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_security_group_rule.allow_external_http_https--347778063": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.allow_external_http_https"
                    ],
                    "primary": {
                        "id": "sgrule-2568202890",
                        "attributes": {
                            "cidr_blocks.#": "1",
                            "cidr_blocks.0": "0.0.0.0/0",
                            "from_port": "443",
                            "id": "sgrule-2568202890",
                            "protocol": "tcp",
                            "security_group_id": "sg-aa6e63c3",
                            "self": "false",
                            "to_port": "443",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.allow_external_http_https--901603019": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.allow_external_http_https"
                    ],
                    "primary": {
                        "id": "sgrule-2878701138",
                        "attributes": {
                            "cidr_blocks.#": "1",
                            "cidr_blocks.0": "0.0.0.0/0",
                            "from_port": "80",
                            "id": "sgrule-2878701138",
                            "protocol": "tcp",
                            "security_group_id": "sg-aa6e63c3",
                            "self": "false",
                            "to_port": "80",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.allow_outbound-357201181": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.allow_outbound"
                    ],
                    "primary": {
                        "id": "sgrule-2819241211",
                        "attributes": {
                            "cidr_blocks.#": "1",
                            "cidr_blocks.0": "0.0.0.0/0",
                            "from_port": "0",
                            "id": "sgrule-2819241211",
                            "protocol": "-1",
                            "security_group_id": "sg-a86e63c1",
                            "self": "false",
                            "to_port": "0",
                            "type": "egress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.allow_ssh-1698759253": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.allow_ssh"
                    ],
                    "primary": {
                        "id": "sgrule-444516557",
                        "attributes": {
                            "cidr_blocks.#": "1",
                            "cidr_blocks.0": "0.0.0.0/0",
                            "from_port": "22",
                            "id": "sgrule-444516557",
                            "protocol": "tcp",
                            "security_group_id": "sg-a06e63c9",
                            "self": "false",
                            "to_port": "22",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.db-sandpit-alerts-175424384": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.db-sandpit-alerts",
                        "aws_security_group.uses-db-sandpit-alerts"
                    ],
                    "primary": {
                        "id": "sgrule-2809926565",
                        "attributes": {
                            "cidr_blocks.#": "0",
                            "from_port": "5432",
                            "id": "sgrule-2809926565",
                            "protocol": "tcp",
                            "security_group_id": "sg-4e30d326",
                            "self": "false",
                            "source_security_group_id": "sg-4f30d327",
                            "to_port": "5432",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-all-servers-1046009446": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-all-servers",
                        "aws_security_group.sandpit-nrpe"
                    ],
                    "primary": {
                        "id": "sgrule-3199324814",
                        "attributes": {
                            "cidr_blocks.#": "0",
                            "from_port": "5666",
                            "id": "sgrule-3199324814",
                            "protocol": "tcp",
                            "security_group_id": "sg-a327c4cb",
                            "self": "false",
                            "source_security_group_id": "sg-a227c4ca",
                            "to_port": "5666",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-all-servers-554474167": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-all-servers"
                    ],
                    "primary": {
                        "id": "sgrule-1798132374",
                        "attributes": {
                            "cidr_blocks.#": "1",
                            "cidr_blocks.0": "0.0.0.0/0",
                            "from_port": "0",
                            "id": "sgrule-1798132374",
                            "protocol": "-1",
                            "security_group_id": "sg-a327c4cb",
                            "self": "false",
                            "to_port": "0",
                            "type": "egress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-allow-all-tcp-within-public-subnet-644258214": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-allow-all-tcp-within-public-subnet"
                    ],
                    "primary": {
                        "id": "sgrule-3993048056",
                        "attributes": {
                            "cidr_blocks.#": "3",
                            "cidr_blocks.0": "172.20.0.0/24",
                            "cidr_blocks.1": "172.20.1.0/24",
                            "cidr_blocks.2": "172.20.2.0/24",
                            "from_port": "0",
                            "id": "sgrule-3993048056",
                            "protocol": "tcp",
                            "security_group_id": "sg-a26e63cb",
                            "self": "false",
                            "to_port": "65535",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-allow-all-udp-within-public-subnet--135631745": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-allow-all-udp-within-public-subnet"
                    ],
                    "primary": {
                        "id": "sgrule-3415783143",
                        "attributes": {
                            "cidr_blocks.#": "3",
                            "cidr_blocks.0": "172.20.0.0/24",
                            "cidr_blocks.1": "172.20.1.0/24",
                            "cidr_blocks.2": "172.20.2.0/24",
                            "from_port": "0",
                            "id": "sgrule-3415783143",
                            "protocol": "udp",
                            "security_group_id": "sg-a46e63cd",
                            "self": "false",
                            "to_port": "65535",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-allow-elb-alerts--790572129": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-allow-elb-alerts",
                        "aws_security_group.sandpit-elb-alerts"
                    ],
                    "primary": {
                        "id": "sgrule-116314046",
                        "attributes": {
                            "cidr_blocks.#": "0",
                            "from_port": "80",
                            "id": "sgrule-116314046",
                            "protocol": "tcp",
                            "security_group_id": "sg-4200e32a",
                            "self": "false",
                            "source_security_group_id": "sg-4300e32b",
                            "to_port": "80",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-allow-elb-kibana-354874079": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-allow-elb-kibana",
                        "aws_security_group.sandpit-elb-kibana"
                    ],
                    "primary": {
                        "id": "sgrule-3458685902",
                        "attributes": {
                            "cidr_blocks.#": "0",
                            "from_port": "80",
                            "id": "sgrule-3458685902",
                            "protocol": "tcp",
                            "security_group_id": "sg-e7676e8e",
                            "self": "false",
                            "source_security_group_id": "sg-e6676e8f",
                            "to_port": "80",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-allow-icmp-within-public-subnet--2117660016": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-allow-icmp-within-public-subnet"
                    ],
                    "primary": {
                        "id": "sgrule-1695075195",
                        "attributes": {
                            "cidr_blocks.#": "3",
                            "cidr_blocks.0": "172.20.0.0/24",
                            "cidr_blocks.1": "172.20.1.0/24",
                            "cidr_blocks.2": "172.20.2.0/24",
                            "from_port": "0",
                            "id": "sgrule-1695075195",
                            "protocol": "udp",
                            "security_group_id": "sg-ac6e63c5",
                            "self": "false",
                            "to_port": "65535",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-allow_elb_chronograf--778135726": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-allow_elb_chronograf",
                        "aws_security_group.sandpit-elb_chronograf"
                    ],
                    "primary": {
                        "id": "sgrule-3074154707",
                        "attributes": {
                            "cidr_blocks.#": "0",
                            "from_port": "80",
                            "id": "sgrule-3074154707",
                            "protocol": "tcp",
                            "security_group_id": "sg-80001ee9",
                            "self": "false",
                            "source_security_group_id": "sg-81001ee8",
                            "to_port": "80",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-influxdb--83635221": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-influxdb"
                    ],
                    "primary": {
                        "id": "sgrule-2318415480",
                        "attributes": {
                            "cidr_blocks.#": "1",
                            "cidr_blocks.0": "0.0.0.0/0",
                            "from_port": "222",
                            "id": "sgrule-2318415480",
                            "protocol": "tcp",
                            "security_group_id": "sg-fd021c94",
                            "self": "false",
                            "to_port": "222",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-influxdb--909977619": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-influxdb",
                        "aws_security_group.sandpit-sends_influx"
                    ],
                    "primary": {
                        "id": "sgrule-3393091413",
                        "attributes": {
                            "cidr_blocks.#": "0",
                            "from_port": "8086",
                            "id": "sgrule-3393091413",
                            "protocol": "tcp",
                            "security_group_id": "sg-fd021c94",
                            "self": "false",
                            "source_security_group_id": "sg-213b2748",
                            "to_port": "8086",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-logstash--101583589": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_eip.sandpit-public-a-nat",
                        "aws_eip.sandpit-public-b-nat",
                        "aws_security_group.sandpit-logstash"
                    ],
                    "primary": {
                        "id": "sgrule-1688711852",
                        "attributes": {
                            "cidr_blocks.#": "7",
                            "cidr_blocks.0": "52.58.52.87/32",
                            "cidr_blocks.1": "52.58.62.184/32",
                            "cidr_blocks.2": "52.29.162.148/32",
                            "cidr_blocks.3": "52.29.163.57/32",
                            "cidr_blocks.4": "52.29.97.114/32",
                            "cidr_blocks.5": "87.115.98.26/32",
                            "cidr_blocks.6": "151.230.75.151/32",
                            "from_port": "12201",
                            "id": "sgrule-1688711852",
                            "protocol": "udp",
                            "security_group_id": "sg-a36e63ca",
                            "self": "false",
                            "to_port": "12201",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-logstash-1371221302": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-logstash"
                    ],
                    "primary": {
                        "id": "sgrule-3020881624",
                        "attributes": {
                            "cidr_blocks.#": "1",
                            "cidr_blocks.0": "0.0.0.0/0",
                            "from_port": "9200",
                            "id": "sgrule-3020881624",
                            "protocol": "udp",
                            "security_group_id": "sg-a36e63ca",
                            "self": "false",
                            "to_port": "9200",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-logstash-327945036": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-logstash",
                        "aws_security_group.sandpit-sends_gelf"
                    ],
                    "primary": {
                        "id": "sgrule-3157010463",
                        "attributes": {
                            "cidr_blocks.#": "0",
                            "from_port": "12201",
                            "id": "sgrule-3157010463",
                            "protocol": "udp",
                            "security_group_id": "sg-a36e63ca",
                            "self": "false",
                            "source_security_group_id": "sg-ad6e63c4",
                            "to_port": "12201",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-staging-admin-security-group-1249640833": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-staging-admin-security-group"
                    ],
                    "primary": {
                        "id": "sgrule-4244085180",
                        "attributes": {
                            "cidr_blocks.#": "1",
                            "cidr_blocks.0": "172.20.0.0/20",
                            "from_port": "0",
                            "id": "sgrule-4244085180",
                            "protocol": "udp",
                            "security_group_id": "sg-2679634f",
                            "self": "false",
                            "to_port": "65535",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-staging-admin-security-group-2117656632": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-staging-admin-security-group"
                    ],
                    "primary": {
                        "id": "sgrule-3585786755",
                        "attributes": {
                            "cidr_blocks.#": "1",
                            "cidr_blocks.0": "172.20.0.0/20",
                            "from_port": "0",
                            "id": "sgrule-3585786755",
                            "protocol": "tcp",
                            "security_group_id": "sg-2679634f",
                            "self": "false",
                            "to_port": "65535",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-staging-dns--1434202576": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-staging-dns"
                    ],
                    "primary": {
                        "id": "sgrule-1323471925",
                        "attributes": {
                            "cidr_blocks.#": "1",
                            "cidr_blocks.0": "172.20.0.0/20",
                            "from_port": "53",
                            "id": "sgrule-1323471925",
                            "protocol": "udp",
                            "security_group_id": "sg-7650b61e",
                            "self": "false",
                            "to_port": "53",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-staging-dns--848559867": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-staging-dns"
                    ],
                    "primary": {
                        "id": "sgrule-1739574794",
                        "attributes": {
                            "cidr_blocks.#": "1",
                            "cidr_blocks.0": "172.20.0.0/20",
                            "from_port": "53",
                            "id": "sgrule-1739574794",
                            "protocol": "tcp",
                            "security_group_id": "sg-7650b61e",
                            "self": "false",
                            "to_port": "53",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-staging-lb-security-group--1468802869": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-staging-lb-security-group",
                        "aws_security_group.sandpit-staging-slave-security-group"
                    ],
                    "primary": {
                        "id": "sgrule-4195561776",
                        "attributes": {
                            "cidr_blocks.#": "0",
                            "from_port": "2181",
                            "id": "sgrule-4195561776",
                            "protocol": "tcp",
                            "security_group_id": "sg-2279634b",
                            "self": "false",
                            "source_security_group_id": "sg-2479634d",
                            "to_port": "2181",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-staging-lb-security-group-2100262736": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-staging-lb-security-group"
                    ],
                    "primary": {
                        "id": "sgrule-2764481019",
                        "attributes": {
                            "cidr_blocks.#": "1",
                            "cidr_blocks.0": "0.0.0.0/0",
                            "from_port": "0",
                            "id": "sgrule-2764481019",
                            "protocol": "-1",
                            "security_group_id": "sg-2279634b",
                            "self": "false",
                            "to_port": "0",
                            "type": "egress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-staging-master-security-group--155772097": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-staging-lb-security-group",
                        "aws_security_group.sandpit-staging-master-security-group"
                    ],
                    "primary": {
                        "id": "sgrule-3452024178",
                        "attributes": {
                            "cidr_blocks.#": "0",
                            "from_port": "8181",
                            "id": "sgrule-3452024178",
                            "protocol": "tcp",
                            "security_group_id": "sg-2579634c",
                            "self": "false",
                            "source_security_group_id": "sg-2279634b",
                            "to_port": "8181",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-staging-master-security-group--674717833": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-staging-master-security-group",
                        "aws_security_group.sandpit-staging-public-slave-security-group"
                    ],
                    "primary": {
                        "id": "sgrule-1559029768",
                        "attributes": {
                            "cidr_blocks.#": "0",
                            "from_port": "0",
                            "id": "sgrule-1559029768",
                            "protocol": "-1",
                            "security_group_id": "sg-2579634c",
                            "self": "false",
                            "source_security_group_id": "sg-2779634e",
                            "to_port": "0",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-staging-master-security-group--936757150": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-staging-lb-security-group",
                        "aws_security_group.sandpit-staging-master-security-group"
                    ],
                    "primary": {
                        "id": "sgrule-58647991",
                        "attributes": {
                            "cidr_blocks.#": "0",
                            "from_port": "2181",
                            "id": "sgrule-58647991",
                            "protocol": "tcp",
                            "security_group_id": "sg-2579634c",
                            "self": "false",
                            "source_security_group_id": "sg-2279634b",
                            "to_port": "2181",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-staging-master-security-group-1199746866": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-staging-lb-security-group",
                        "aws_security_group.sandpit-staging-master-security-group"
                    ],
                    "primary": {
                        "id": "sgrule-3872785578",
                        "attributes": {
                            "cidr_blocks.#": "0",
                            "from_port": "5050",
                            "id": "sgrule-3872785578",
                            "protocol": "tcp",
                            "security_group_id": "sg-2579634c",
                            "self": "false",
                            "source_security_group_id": "sg-2279634b",
                            "to_port": "5050",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-staging-master-security-group-1743741962": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-staging-master-security-group",
                        "aws_security_group.sandpit-staging-slave-security-group"
                    ],
                    "primary": {
                        "id": "sgrule-1688452858",
                        "attributes": {
                            "cidr_blocks.#": "0",
                            "from_port": "0",
                            "id": "sgrule-1688452858",
                            "protocol": "-1",
                            "security_group_id": "sg-2579634c",
                            "self": "false",
                            "source_security_group_id": "sg-2479634d",
                            "to_port": "0",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-staging-master-security-group-2056861711": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-staging-lb-security-group",
                        "aws_security_group.sandpit-staging-master-security-group"
                    ],
                    "primary": {
                        "id": "sgrule-28347316",
                        "attributes": {
                            "cidr_blocks.#": "0",
                            "from_port": "80",
                            "id": "sgrule-28347316",
                            "protocol": "tcp",
                            "security_group_id": "sg-2579634c",
                            "self": "false",
                            "source_security_group_id": "sg-2279634b",
                            "to_port": "80",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-staging-master-security-group-603013180": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-staging-lb-security-group",
                        "aws_security_group.sandpit-staging-master-security-group"
                    ],
                    "primary": {
                        "id": "sgrule-353510283",
                        "attributes": {
                            "cidr_blocks.#": "0",
                            "from_port": "8080",
                            "id": "sgrule-353510283",
                            "protocol": "tcp",
                            "security_group_id": "sg-2579634c",
                            "self": "false",
                            "source_security_group_id": "sg-2279634b",
                            "to_port": "8080",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-staging-public-slave-security-group--150178904": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-staging-public-slave-security-group",
                        "aws_security_group.sandpit-staging-slave-security-group"
                    ],
                    "primary": {
                        "id": "sgrule-1673031262",
                        "attributes": {
                            "cidr_blocks.#": "0",
                            "from_port": "0",
                            "id": "sgrule-1673031262",
                            "protocol": "-1",
                            "security_group_id": "sg-2779634e",
                            "self": "false",
                            "source_security_group_id": "sg-2479634d",
                            "to_port": "0",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-staging-public-slave-security-group--1681458695": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-staging-public-slave-security-group"
                    ],
                    "primary": {
                        "id": "sgrule-1542928556",
                        "attributes": {
                            "cidr_blocks.#": "0",
                            "from_port": "0",
                            "id": "sgrule-1542928556",
                            "protocol": "-1",
                            "security_group_id": "sg-2779634e",
                            "self": "false",
                            "source_security_group_id": "sg-2779634e",
                            "to_port": "0",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-staging-public-slave-security-group--75623017": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-staging-public-slave-security-group"
                    ],
                    "primary": {
                        "id": "sgrule-3431202292",
                        "attributes": {
                            "cidr_blocks.#": "1",
                            "cidr_blocks.0": "0.0.0.0/0",
                            "from_port": "23",
                            "id": "sgrule-3431202292",
                            "protocol": "udp",
                            "security_group_id": "sg-2779634e",
                            "self": "false",
                            "to_port": "5050",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-staging-public-slave-security-group--839671011": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-staging-public-slave-security-group"
                    ],
                    "primary": {
                        "id": "sgrule-1641097975",
                        "attributes": {
                            "cidr_blocks.#": "1",
                            "cidr_blocks.0": "172.20.0.0/20",
                            "from_port": "22",
                            "id": "sgrule-1641097975",
                            "protocol": "tcp",
                            "security_group_id": "sg-2779634e",
                            "self": "false",
                            "to_port": "22",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-staging-public-slave-security-group-1102616849": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-staging-public-slave-security-group"
                    ],
                    "primary": {
                        "id": "sgrule-3954455070",
                        "attributes": {
                            "cidr_blocks.#": "1",
                            "cidr_blocks.0": "0.0.0.0/0",
                            "from_port": "0",
                            "id": "sgrule-3954455070",
                            "protocol": "tcp",
                            "security_group_id": "sg-2779634e",
                            "self": "false",
                            "to_port": "21",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-staging-public-slave-security-group-1445014570": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-staging-public-slave-security-group"
                    ],
                    "primary": {
                        "id": "sgrule-1120253562",
                        "attributes": {
                            "cidr_blocks.#": "1",
                            "cidr_blocks.0": "0.0.0.0/0",
                            "from_port": "5052",
                            "id": "sgrule-1120253562",
                            "protocol": "udp",
                            "security_group_id": "sg-2779634e",
                            "self": "false",
                            "to_port": "65535",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-staging-public-slave-security-group-1796684383": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-staging-master-security-group",
                        "aws_security_group.sandpit-staging-public-slave-security-group"
                    ],
                    "primary": {
                        "id": "sgrule-1905028248",
                        "attributes": {
                            "cidr_blocks.#": "0",
                            "from_port": "0",
                            "id": "sgrule-1905028248",
                            "protocol": "-1",
                            "security_group_id": "sg-2779634e",
                            "self": "false",
                            "source_security_group_id": "sg-2579634c",
                            "to_port": "0",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-staging-public-slave-security-group-1830836378": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-staging-public-slave-security-group"
                    ],
                    "primary": {
                        "id": "sgrule-1007310050",
                        "attributes": {
                            "cidr_blocks.#": "1",
                            "cidr_blocks.0": "0.0.0.0/0",
                            "from_port": "5052",
                            "id": "sgrule-1007310050",
                            "protocol": "tcp",
                            "security_group_id": "sg-2779634e",
                            "self": "false",
                            "to_port": "65535",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-staging-public-slave-security-group-2085536330": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-staging-public-slave-security-group"
                    ],
                    "primary": {
                        "id": "sgrule-2991333228",
                        "attributes": {
                            "cidr_blocks.#": "1",
                            "cidr_blocks.0": "0.0.0.0/0",
                            "from_port": "23",
                            "id": "sgrule-2991333228",
                            "protocol": "tcp",
                            "security_group_id": "sg-2779634e",
                            "self": "false",
                            "to_port": "5050",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-staging-public-slave-security-group-290419564": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-staging-public-slave-security-group"
                    ],
                    "primary": {
                        "id": "sgrule-2507919494",
                        "attributes": {
                            "cidr_blocks.#": "1",
                            "cidr_blocks.0": "0.0.0.0/0",
                            "from_port": "0",
                            "id": "sgrule-2507919494",
                            "protocol": "udp",
                            "security_group_id": "sg-2779634e",
                            "self": "false",
                            "to_port": "21",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-staging-slave-security-group--797070190": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-staging-master-security-group",
                        "aws_security_group.sandpit-staging-slave-security-group"
                    ],
                    "primary": {
                        "id": "sgrule-1603191472",
                        "attributes": {
                            "cidr_blocks.#": "0",
                            "from_port": "0",
                            "id": "sgrule-1603191472",
                            "protocol": "-1",
                            "security_group_id": "sg-2479634d",
                            "self": "false",
                            "source_security_group_id": "sg-2579634c",
                            "to_port": "0",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-staging-slave-security-group--85537667": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-staging-lb-security-group",
                        "aws_security_group.sandpit-staging-slave-security-group"
                    ],
                    "primary": {
                        "id": "sgrule-1885305491",
                        "attributes": {
                            "cidr_blocks.#": "0",
                            "from_port": "2181",
                            "id": "sgrule-1885305491",
                            "protocol": "tcp",
                            "security_group_id": "sg-2479634d",
                            "self": "false",
                            "source_security_group_id": "sg-2279634b",
                            "to_port": "2181",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-staging-slave-security-group--891725830": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-staging-slave-security-group"
                    ],
                    "primary": {
                        "id": "sgrule-1304084598",
                        "attributes": {
                            "cidr_blocks.#": "0",
                            "from_port": "0",
                            "id": "sgrule-1304084598",
                            "protocol": "-1",
                            "security_group_id": "sg-2479634d",
                            "self": "false",
                            "source_security_group_id": "sg-2479634d",
                            "to_port": "0",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-staging-slave-security-group--897176985": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-staging-public-slave-security-group",
                        "aws_security_group.sandpit-staging-slave-security-group"
                    ],
                    "primary": {
                        "id": "sgrule-1979029124",
                        "attributes": {
                            "cidr_blocks.#": "0",
                            "from_port": "0",
                            "id": "sgrule-1979029124",
                            "protocol": "-1",
                            "security_group_id": "sg-2479634d",
                            "self": "false",
                            "source_security_group_id": "sg-2779634e",
                            "to_port": "0",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-vpn--2102800947": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-vpn"
                    ],
                    "primary": {
                        "id": "sgrule-3680766415",
                        "attributes": {
                            "cidr_blocks.#": "1",
                            "cidr_blocks.0": "0.0.0.0/0",
                            "from_port": "1194",
                            "id": "sgrule-3680766415",
                            "protocol": "udp",
                            "security_group_id": "sg-a56e63cc",
                            "self": "false",
                            "to_port": "1194",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_security_group_rule.sandpit-vpn-229345561": {
                    "type": "aws_security_group_rule",
                    "depends_on": [
                        "aws_security_group.sandpit-vpn"
                    ],
                    "primary": {
                        "id": "sgrule-2680444565",
                        "attributes": {
                            "cidr_blocks.#": "1",
                            "cidr_blocks.0": "0.0.0.0/0",
                            "from_port": "22",
                            "id": "sgrule-2680444565",
                            "protocol": "tcp",
                            "security_group_id": "sg-a56e63cc",
                            "self": "false",
                            "to_port": "22",
                            "type": "ingress"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "aws_subnet.sandpit-private-a": {
                    "type": "aws_subnet",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "subnet-6283d00b",
                        "attributes": {
                            "availability_zone": "eu-central-1a",
                            "cidr_block": "172.20.8.0/24",
                            "id": "subnet-6283d00b",
                            "map_public_ip_on_launch": "false",
                            "tags.#": "1",
                            "tags.Name": "sandpit-private-a",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_subnet.sandpit-private-b": {
                    "type": "aws_subnet",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "subnet-a85127d3",
                        "attributes": {
                            "availability_zone": "eu-central-1b",
                            "cidr_block": "172.20.9.0/24",
                            "id": "subnet-a85127d3",
                            "map_public_ip_on_launch": "false",
                            "tags.#": "1",
                            "tags.Name": "sandpit-private-b",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_subnet.sandpit-public-a": {
                    "type": "aws_subnet",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "subnet-6583d00c",
                        "attributes": {
                            "availability_zone": "eu-central-1a",
                            "cidr_block": "172.20.0.0/24",
                            "id": "subnet-6583d00c",
                            "map_public_ip_on_launch": "false",
                            "tags.#": "1",
                            "tags.Name": "sandpit-public-a",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_subnet.sandpit-public-b": {
                    "type": "aws_subnet",
                    "depends_on": [
                        "aws_vpc.sandpit"
                    ],
                    "primary": {
                        "id": "subnet-af5127d4",
                        "attributes": {
                            "availability_zone": "eu-central-1b",
                            "cidr_block": "172.20.1.0/24",
                            "id": "subnet-af5127d4",
                            "map_public_ip_on_launch": "false",
                            "tags.#": "1",
                            "tags.Name": "sandpit-public-b",
                            "vpc_id": "vpc-3739425e"
                        }
                    }
                },
                "aws_volume_attachment.sandpit-influxdb_volume": {
                    "type": "aws_volume_attachment",
                    "depends_on": [
                        "aws_ebs_volume.sandpit-influxdb",
                        "aws_instance.influxdb"
                    ],
                    "primary": {
                        "id": "vai-1581649740",
                        "attributes": {
                            "device_name": "/dev/xvdh",
                            "id": "vai-1581649740",
                            "instance_id": "i-09c365b4",
                            "volume_id": "vol-ed4d5366"
                        }
                    }
                },
                "aws_vpc.sandpit": {
                    "type": "aws_vpc",
                    "primary": {
                        "id": "vpc-3739425e",
                        "attributes": {
                            "cidr_block": "172.20.0.0/20",
                            "default_network_acl_id": "acl-67df910e",
                            "default_security_group_id": "sg-d76e63be",
                            "dhcp_options_id": "dopt-5004e339",
                            "id": "vpc-3739425e",
                            "main_route_table_id": "rtb-162d667f",
                            "tags.#": "1",
                            "tags.Name": "sandpit"
                        }
                    }
                },
                "template_file.sandpit-logstash-user-data": {
                    "type": "template_file",
                    "depends_on": [
                        "aws_elb.kibana"
                    ],
                    "primary": {
                        "id": "c60933a65620233bd2ed1a66b4813dffd79bb18c43dc20bd73455c97b241f877",
                        "attributes": {
                            "id": "c60933a65620233bd2ed1a66b4813dffd79bb18c43dc20bd73455c97b241f877",
                            "rendered": "#cloud-config\nusers:\n- default\n- name: admin\n  sudo: ALL=(ALL) NOPASSWD:ALL\n  groups:\n  - users\n  - admin\n  ssh-authorized-keys:\n  - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDiRTaPy06VZVuYQZs7XvG2ytbw3hg7F/uLC8hLoPD4ugbtVAWSrlO9koietHedLFkWI/UVwCP3FcMgZYqQnCQTwnEJ5bsp2r+MOI+nUfojZ6O8j7XMxwMtxf60S3FmVeuvN38Bbh2cygv72+uPbdE2giH+scD7lslm5LWsYAqK79ZVJ2Gk3do+x/eWc3mLqDnW/PNghgT2jJxg1T16kFPYiVFRUSYP1+CbmmQoJ38x8Xc7CZb2PfFcqHoHVzz9nBqRdhHl7GO2lSl8ostyy5nqhTWMkpOPxsJoGvJCS+ZUh/PPtUlxGikH8XcY+6h9QvThTR/17Irc9Aa7YJFPEk5l thattommyhall@gmail.com\npackage_update: true\nbootcmd:\n- echo oracle-java8-installer shared/accepted-oracle-license-v1-1 select true | /usr/bin/debconf-set-selections\n- wget -qO - https://packages.elastic.co/GPG-KEY-elasticsearch | apt-key add -\napt_sources:\n- source: ppa:webupd8team/java\n- source: http://packages.elastic.co/logstash/2.2/debian\n  key: '-----BEGIN PGP PUBLIC KEY BLOCK-----\n\n    Version: GnuPG v2.0.14 (GNU/Linux)\n\n\n    mQENBFI3HsoBCADXDtbNJnxbPqB1vDNtCsqhe49vFYsZN9IOZsZXgp7aHjh6CJBD\n\n    A+bGFOwyhbd7at35jQjWAw1O3cfYsKAmFy+Ar3LHCMkV3oZspJACTIgCrwnkic/9\n\n    CUliQe324qvObU2QRtP4Fl0zWcfb/S8UYzWXWIFuJqMvE9MaRY1bwUBvzoqavLGZ\n\n    j3SF1SPO+TB5QrHkrQHBsmX+Jda6d4Ylt8/t6CvMwgQNlrlzIO9WT+YN6zS+sqHd\n\n    1YK/aY5qhoLNhp9G/HxhcSVCkLq8SStj1ZZ1S9juBPoXV1ZWNbxFNGwOh/NYGldD\n\n    2kmBf3YgCqeLzHahsAEpvAm8TBa7Q9W21C8vABEBAAG0RUVsYXN0aWNzZWFyY2gg\n\n    KEVsYXN0aWNzZWFyY2ggU2lnbmluZyBLZXkpIDxkZXZfb3BzQGVsYXN0aWNzZWFy\n\n    Y2gub3JnPokBOAQTAQIAIgUCUjceygIbAwYLCQgHAwIGFQgCCQoLBBYCAwECHgEC\n\n    F4AACgkQ0n1mbNiOQrRzjAgAlTUQ1mgo3nK6BGXbj4XAJvuZDG0HILiUt+pPnz75\n\n    nsf0NWhqR4yGFlmpuctgCmTD+HzYtV9fp9qW/bwVuJCNtKXk3sdzYABY+Yl0Cez/\n\n    7C2GuGCOlbn0luCNT9BxJnh4mC9h/cKI3y5jvZ7wavwe41teqG14V+EoFSn3NPKm\n\n    TxcDTFrV7SmVPxCBcQze00cJhprKxkuZMPPVqpBS+JfDQtzUQD/LSFfhHj9eD+Xe\n\n    8d7sw+XvxB2aN4gnTlRzjL1nTRp0h2/IOGkqYfIG9rWmSLNlxhB2t+c0RsjdGM4/\n\n    eRlPWylFbVMc5pmDpItrkWSnzBfkmXL3vO2X3WvwmSFiQbkBDQRSNx7KAQgA5JUl\n\n    zcMW5/cuyZR8alSacKqhSbvoSqqbzHKcUQZmlzNMKGTABFG1yRx9r+wa/fvqP6OT\n\n    RzRDvVS/cycws8YX7Ddum7x8uI95b9ye1/Xy5noPEm8cD+hplnpU+PBQZJ5XJ2I+\n\n    1l9Nixx47wPGXeClLqcdn0ayd+v+Rwf3/XUJrvccG2YZUiQ4jWZkoxsA07xx7Bj+\n\n    Lt8/FKG7sHRFvePFU0ZS6JFx9GJqjSBbHRRkam+4emW3uWgVfZxuwcUCn1ayNgRt\n\n    KiFv9jQrg2TIWEvzYx9tywTCxc+FFMWAlbCzi+m4WD+QUWWfDQ009U/WM0ks0Kww\n\n    EwSk/UDuToxGnKU2dQARAQABiQEfBBgBAgAJBQJSNx7KAhsMAAoJENJ9ZmzYjkK0\n\n    c3MIAIE9hAR20mqJWLcsxLtrRs6uNF1VrpB+4n/55QU7oxA1iVBO6IFu4qgsF12J\n\n    TavnJ5MLaETlggXY+zDef9syTPXoQctpzcaNVDmedwo1SiL03uMoblOvWpMR/Y0j\n\n    6rm7IgrMWUDXDPvoPGjMl2q1iTeyHkMZEyUJ8SKsaHh4jV9wp9KmC8C+9CwMukL7\n\n    vM5w8cgvJoAwsp3Fn59AxWthN3XJYcnMfStkIuWgR7U2r+a210W6vnUxU4oN0PmM\n\n    cursYPyeV0NX/KQeUeNMwGTFB6QHS/anRaGQewijkrYYoTNtfllxIu9XYmiBERQ/\n\n    qPDlGRlOgVTd9xUfHFkzB52c70E=\n\n    =92oX\n\n    -----END PGP PUBLIC KEY BLOCK-----\n\n    '\npackages:\n- oracle-java8-installer\n- oracle-java8-set-default\n- logstash\nruncmd:\n- update-rc.d logstash defaults\n- /opt/logstash/bin/plugin install logstash-output-amazon_es\nwrite_files:\n- path: /etc/logstash/conf.d/out-es.conf\n  permissions: '644'\n  content: \"output{\\n    elasticsearch {\\n        hosts =\u003e [\\\"search-sandpit-elasticsearch-xijn4teq3gmimkpzpy2ivbbnbm.eu-central-1.es.amazonaws.com:80\\\"\\\n    ]\\n        document_type =\u003e \\\"%{[@metadata][type]}\\\"\\n    }\\n}\\n\"\n",
                            "template": "#cloud-config\nusers:\n- default\n- name: admin\n  sudo: ALL=(ALL) NOPASSWD:ALL\n  groups:\n  - users\n  - admin\n  ssh-authorized-keys:\n  - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDiRTaPy06VZVuYQZs7XvG2ytbw3hg7F/uLC8hLoPD4ugbtVAWSrlO9koietHedLFkWI/UVwCP3FcMgZYqQnCQTwnEJ5bsp2r+MOI+nUfojZ6O8j7XMxwMtxf60S3FmVeuvN38Bbh2cygv72+uPbdE2giH+scD7lslm5LWsYAqK79ZVJ2Gk3do+x/eWc3mLqDnW/PNghgT2jJxg1T16kFPYiVFRUSYP1+CbmmQoJ38x8Xc7CZb2PfFcqHoHVzz9nBqRdhHl7GO2lSl8ostyy5nqhTWMkpOPxsJoGvJCS+ZUh/PPtUlxGikH8XcY+6h9QvThTR/17Irc9Aa7YJFPEk5l thattommyhall@gmail.com\npackage_update: true\nbootcmd:\n- echo oracle-java8-installer shared/accepted-oracle-license-v1-1 select true | /usr/bin/debconf-set-selections\n- wget -qO - https://packages.elastic.co/GPG-KEY-elasticsearch | apt-key add -\napt_sources:\n- source: ppa:webupd8team/java\n- source: http://packages.elastic.co/logstash/2.2/debian\n  key: '-----BEGIN PGP PUBLIC KEY BLOCK-----\n\n    Version: GnuPG v2.0.14 (GNU/Linux)\n\n\n    mQENBFI3HsoBCADXDtbNJnxbPqB1vDNtCsqhe49vFYsZN9IOZsZXgp7aHjh6CJBD\n\n    A+bGFOwyhbd7at35jQjWAw1O3cfYsKAmFy+Ar3LHCMkV3oZspJACTIgCrwnkic/9\n\n    CUliQe324qvObU2QRtP4Fl0zWcfb/S8UYzWXWIFuJqMvE9MaRY1bwUBvzoqavLGZ\n\n    j3SF1SPO+TB5QrHkrQHBsmX+Jda6d4Ylt8/t6CvMwgQNlrlzIO9WT+YN6zS+sqHd\n\n    1YK/aY5qhoLNhp9G/HxhcSVCkLq8SStj1ZZ1S9juBPoXV1ZWNbxFNGwOh/NYGldD\n\n    2kmBf3YgCqeLzHahsAEpvAm8TBa7Q9W21C8vABEBAAG0RUVsYXN0aWNzZWFyY2gg\n\n    KEVsYXN0aWNzZWFyY2ggU2lnbmluZyBLZXkpIDxkZXZfb3BzQGVsYXN0aWNzZWFy\n\n    Y2gub3JnPokBOAQTAQIAIgUCUjceygIbAwYLCQgHAwIGFQgCCQoLBBYCAwECHgEC\n\n    F4AACgkQ0n1mbNiOQrRzjAgAlTUQ1mgo3nK6BGXbj4XAJvuZDG0HILiUt+pPnz75\n\n    nsf0NWhqR4yGFlmpuctgCmTD+HzYtV9fp9qW/bwVuJCNtKXk3sdzYABY+Yl0Cez/\n\n    7C2GuGCOlbn0luCNT9BxJnh4mC9h/cKI3y5jvZ7wavwe41teqG14V+EoFSn3NPKm\n\n    TxcDTFrV7SmVPxCBcQze00cJhprKxkuZMPPVqpBS+JfDQtzUQD/LSFfhHj9eD+Xe\n\n    8d7sw+XvxB2aN4gnTlRzjL1nTRp0h2/IOGkqYfIG9rWmSLNlxhB2t+c0RsjdGM4/\n\n    eRlPWylFbVMc5pmDpItrkWSnzBfkmXL3vO2X3WvwmSFiQbkBDQRSNx7KAQgA5JUl\n\n    zcMW5/cuyZR8alSacKqhSbvoSqqbzHKcUQZmlzNMKGTABFG1yRx9r+wa/fvqP6OT\n\n    RzRDvVS/cycws8YX7Ddum7x8uI95b9ye1/Xy5noPEm8cD+hplnpU+PBQZJ5XJ2I+\n\n    1l9Nixx47wPGXeClLqcdn0ayd+v+Rwf3/XUJrvccG2YZUiQ4jWZkoxsA07xx7Bj+\n\n    Lt8/FKG7sHRFvePFU0ZS6JFx9GJqjSBbHRRkam+4emW3uWgVfZxuwcUCn1ayNgRt\n\n    KiFv9jQrg2TIWEvzYx9tywTCxc+FFMWAlbCzi+m4WD+QUWWfDQ009U/WM0ks0Kww\n\n    EwSk/UDuToxGnKU2dQARAQABiQEfBBgBAgAJBQJSNx7KAhsMAAoJENJ9ZmzYjkK0\n\n    c3MIAIE9hAR20mqJWLcsxLtrRs6uNF1VrpB+4n/55QU7oxA1iVBO6IFu4qgsF12J\n\n    TavnJ5MLaETlggXY+zDef9syTPXoQctpzcaNVDmedwo1SiL03uMoblOvWpMR/Y0j\n\n    6rm7IgrMWUDXDPvoPGjMl2q1iTeyHkMZEyUJ8SKsaHh4jV9wp9KmC8C+9CwMukL7\n\n    vM5w8cgvJoAwsp3Fn59AxWthN3XJYcnMfStkIuWgR7U2r+a210W6vnUxU4oN0PmM\n\n    cursYPyeV0NX/KQeUeNMwGTFB6QHS/anRaGQewijkrYYoTNtfllxIu9XYmiBERQ/\n\n    qPDlGRlOgVTd9xUfHFkzB52c70E=\n\n    =92oX\n\n    -----END PGP PUBLIC KEY BLOCK-----\n\n    '\npackages:\n- oracle-java8-installer\n- oracle-java8-set-default\n- logstash\nruncmd:\n- update-rc.d logstash defaults\n- /opt/logstash/bin/plugin install logstash-output-amazon_es\nwrite_files:\n- path: /etc/logstash/conf.d/out-es.conf\n  permissions: '644'\n  content: \"output{\\n    elasticsearch {\\n        hosts =\u003e [\\\"search-sandpit-elasticsearch-xijn4teq3gmimkpzpy2ivbbnbm.eu-central-1.es.amazonaws.com:80\\\"\\\n    ]\\n        document_type =\u003e \\\"%{[@metadata][type]}\\\"\\n    }\\n}\\n\"\n",
                            "vars.#": "1",
                            "vars.elasticsearch-lb": "kibana"
                        }
                    }
                },
                "template_file.sandpit-staging-cassandra_deploy": {
                    "type": "template_file",
                    "primary": {
                        "id": "f828f2e347af50c6c8fa243db7784f867f26a7c4f00e00a5443c2fc32d2168f8",
                        "attributes": {
                            "id": "f828f2e347af50c6c8fa243db7784f867f26a7c4f00e00a5443c2fc32d2168f8",
                            "rendered": "{\n  \"id\": \"cassandra/production\",\n  \"instances\": 1,\n  \"cpus\": 0.5,\n  \"mem\": 512,\n  \"ports\": [0],\n  \"uris\": [\n    \"https://s3.eu-central-1.amazonaws.com/witan-cf-templates/cassandra-mesos-0.2.1-SNAPSHOT.tar.gz\",\n    \"https://downloads.mesosphere.io/java/jre-8u65-linux-x64.tar.gz\"\n  ],\n  \"env\": {\n    \"MESOS_AUTHENTICATE\": \"false\",\n    \"MESOS_ZK\": \"zk://master.mesos:2181/mesos\",\n    \"JAVA_OPTS\": \"-Xms256m -Xmx256m\",\n    \"CASSANDRA_CLUSTER_NAME\": \"dcos\",\n    \"CASSANDRA_ZK\": \"zk://master.mesos:2181/cassandra-mesos/dcos\",\n    \"CASSANDRA_NODE_COUNT\": \"2\",\n    \"CASSANDRA_RESOURCE_CPU_CORES\": \"0.1\",\n    \"CASSANDRA_RESOURCE_MEM_MB\": \"768\",\n    \"CASSANDRA_RESOURCE_DISK_MB\": \"16\",\n    \"CASSANDRA_HEALTH_CHECK_INTERVAL_SECONDS\": \"60\",\n    \"CASSANDRA_ZK_TIMEOUT_MS\": \"10000\",\n    \"CASSANDRA_SEED_COUNT\": \"1\",\n    \"CASSANDRA_DEFAULT_RACK\": \"RAC1\",\n    \"CASSANDRA_FAILOVER_TIMEOUT_SECONDS\": \"604800\",\n    \"CASSANDRA_BOOTSTRAP_GRACE_TIME_SECONDS\": \"120\",\n    \"CASSANDRA_DEFAULT_DC\": \"DC1\",\n    \"CASSANDRA_DATA_DIRECTORY\": \"/var/lib/cassandra\",\n    \"CASSANDRA_FRAMEWORK_MESOS_ROLE\": \"*\"\n  },\n  \"cmd\": \"$(pwd)/jre*/bin/java $JAVA_OPTS -classpath cassandra-mesos-framework.jar io.mesosphere.mesos.frameworks.cassandra.framework.Main\",\n  \"healthChecks\": [\n    {\n      \"gracePeriodSeconds\": 120,\n      \"intervalSeconds\": 30,\n      \"maxConsecutiveFailures\": 0,\n      \"path\": \"/health/cluster\",\n      \"portIndex\": 0,\n      \"protocol\": \"HTTP\",\n      \"timeoutSeconds\": 5\n    },\n    {\n      \"gracePeriodSeconds\": 120,\n      \"intervalSeconds\": 30,\n      \"maxConsecutiveFailures\": 3,\n      \"path\": \"/health/process\",\n      \"portIndex\": 0,\n      \"protocol\": \"HTTP\",\n      \"timeoutSeconds\": 5\n    }\n  ]\n}\n",
                            "template": "{\n  \"id\": \"cassandra/production\",\n  \"instances\": 1,\n  \"cpus\": 0.5,\n  \"mem\": 512,\n  \"ports\": [0],\n  \"uris\": [\n    \"https://s3.eu-central-1.amazonaws.com/witan-cf-templates/cassandra-mesos-0.2.1-SNAPSHOT.tar.gz\",\n    \"https://downloads.mesosphere.io/java/jre-8u65-linux-x64.tar.gz\"\n  ],\n  \"env\": {\n    \"MESOS_AUTHENTICATE\": \"false\",\n    \"MESOS_ZK\": \"zk://master.mesos:2181/mesos\",\n    \"JAVA_OPTS\": \"-Xms256m -Xmx256m\",\n    \"CASSANDRA_CLUSTER_NAME\": \"dcos\",\n    \"CASSANDRA_ZK\": \"zk://master.mesos:2181/cassandra-mesos/dcos\",\n    \"CASSANDRA_NODE_COUNT\": \"${cassandra_node_count}\",\n    \"CASSANDRA_RESOURCE_CPU_CORES\": \"0.1\",\n    \"CASSANDRA_RESOURCE_MEM_MB\": \"768\",\n    \"CASSANDRA_RESOURCE_DISK_MB\": \"16\",\n    \"CASSANDRA_HEALTH_CHECK_INTERVAL_SECONDS\": \"60\",\n    \"CASSANDRA_ZK_TIMEOUT_MS\": \"10000\",\n    \"CASSANDRA_SEED_COUNT\": \"${cassandra_seed_count}\",\n    \"CASSANDRA_DEFAULT_RACK\": \"RAC1\",\n    \"CASSANDRA_FAILOVER_TIMEOUT_SECONDS\": \"604800\",\n    \"CASSANDRA_BOOTSTRAP_GRACE_TIME_SECONDS\": \"120\",\n    \"CASSANDRA_DEFAULT_DC\": \"DC1\",\n    \"CASSANDRA_DATA_DIRECTORY\": \"/var/lib/cassandra\",\n    \"CASSANDRA_FRAMEWORK_MESOS_ROLE\": \"*\"\n  },\n  \"cmd\": \"$(pwd)/jre*/bin/java $JAVA_OPTS -classpath cassandra-mesos-framework.jar io.mesosphere.mesos.frameworks.cassandra.framework.Main\",\n  \"healthChecks\": [\n    {\n      \"gracePeriodSeconds\": 120,\n      \"intervalSeconds\": 30,\n      \"maxConsecutiveFailures\": 0,\n      \"path\": \"/health/cluster\",\n      \"portIndex\": 0,\n      \"protocol\": \"HTTP\",\n      \"timeoutSeconds\": 5\n    },\n    {\n      \"gracePeriodSeconds\": 120,\n      \"intervalSeconds\": 30,\n      \"maxConsecutiveFailures\": 3,\n      \"path\": \"/health/process\",\n      \"portIndex\": 0,\n      \"protocol\": \"HTTP\",\n      \"timeoutSeconds\": 5\n    }\n  ]\n}\n",
                            "vars.#": "2",
                            "vars.cassandra_node_count": "2",
                            "vars.cassandra_seed_count": "1"
                        }
                    }
                },
                "template_file.sandpit-staging-dcos-cli-install": {
                    "type": "template_file",
                    "depends_on": [
                        "aws_elb.sandpit-staging-internal-lb"
                    ],
                    "primary": {
                        "id": "63b254eba0b27476d7c6f1d8047ba080b69300b9adb618a053f2d5fc699ebbf3",
                        "attributes": {
                            "id": "63b254eba0b27476d7c6f1d8047ba080b69300b9adb618a053f2d5fc699ebbf3",
                            "rendered": "mkdir -p dcos \u0026\u0026 cd dcos \u0026\u0026\ncurl -O https://downloads.mesosphere.com/dcos-cli/install.sh \u0026\u0026\nbash ./install.sh . http://internal-sandpit-staging-internal-lb-1023536621.eu-central-1.elb.amazonaws.com \u0026\u0026\nsource ./bin/env-setup\n",
                            "template": "mkdir -p dcos \u0026\u0026 cd dcos \u0026\u0026\ncurl -O https://downloads.mesosphere.com/dcos-cli/install.sh \u0026\u0026\nbash ./install.sh . http://${internal-lb} \u0026\u0026\nsource ./bin/env-setup\n",
                            "vars.#": "1",
                            "vars.internal-lb": "internal-sandpit-staging-internal-lb-1023536621.eu-central-1.elb.amazonaws.com"
                        }
                    }
                },
                "template_file.sandpit-staging-deploy-sh": {
                    "type": "template_file",
                    "depends_on": [
                        "aws_elb.sandpit-staging-internal-lb"
                    ],
                    "primary": {
                        "id": "c593b687961dae299d18576fbf5e8d308c9790350979ceb9e2655cf1e706a895",
                        "attributes": {
                            "id": "c593b687961dae299d18576fbf5e8d308c9790350979ceb9e2655cf1e706a895",
                            "rendered": "#!/usr/bin/env bash\n\nMARATHON_HOST=internal-sandpit-staging-internal-lb-1023536621.eu-central-1.elb.amazonaws.com\nENVIRONMENT=staging\n# using deployment service sebastopol\nNAME=$1\nJSON_TEMPLATE=$2\nTAG=$3\nsed -e \"s/@@TAG@@/$TAG/\" -e \"s/@@ENVIRONMENT@@/$ENVIRONMENT/\" $JSON_TEMPLATE \u003e deploy.json\n\necho \"deleting $NAME app ...\"\ncurl -X delete http://$MARATHON_HOST:8080/v2/apps/$NAME\n\n# we want curl to output something we can use to indicate success/failure\necho \"redeploying $NAME app ...\"\nSTATUS=$(curl -s -o /dev/null -w \"%{http_code}\" -X POST http://$MARATHON_HOST:8080/v2/apps -H \"Content-Type: application/json\" --data-binary \"@deploy.json\")\n\necho \"HTTP code \" $STATUS\nif [ $STATUS == \"201\" ]\nthen exit 0\nelse exit 1\nfi\n",
                            "template": "#!/usr/bin/env bash\n\nMARATHON_HOST=${internal-lb}\nENVIRONMENT=${cluster-name}\n# using deployment service sebastopol\nNAME=$1\nJSON_TEMPLATE=$2\nTAG=$3\nsed -e \"s/@@TAG@@/$TAG/\" -e \"s/@@ENVIRONMENT@@/$ENVIRONMENT/\" $JSON_TEMPLATE \u003e deploy.json\n\necho \"deleting $NAME app ...\"\ncurl -X delete http://$MARATHON_HOST:8080/v2/apps/$NAME\n\n# we want curl to output something we can use to indicate success/failure\necho \"redeploying $NAME app ...\"\nSTATUS=$(curl -s -o /dev/null -w \"%{http_code}\" -X POST http://$MARATHON_HOST:8080/v2/apps -H \"Content-Type: application/json\" --data-binary \"@deploy.json\")\n\necho \"HTTP code \" $STATUS\nif [ $STATUS == \"201\" ]\nthen exit 0\nelse exit 1\nfi\n",
                            "vars.#": "2",
                            "vars.cluster-name": "staging",
                            "vars.internal-lb": "internal-sandpit-staging-internal-lb-1023536621.eu-central-1.elb.amazonaws.com"
                        }
                    }
                },
                "template_file.sandpit-staging-dns-user-data": {
                    "type": "template_file",
                    "depends_on": [
                        "aws_elb.sandpit-staging-internal-lb"
                    ],
                    "primary": {
                        "id": "a095afb1375ae4b4ab57ab0c1cf20a459aa03b55d117bb027202d55978ea575d",
                        "attributes": {
                            "id": "a095afb1375ae4b4ab57ab0c1cf20a459aa03b55d117bb027202d55978ea575d",
                            "rendered": "#cloud-config\npackage_update: true\npackages:\n- dnsmasq\nwrite_files:\n- path: /etc/dnsmasq.conf\n  content: 'server=/sandpit-kixi.mesos/172.20.0.2\n\n    server=/marathon.mesos/leader.mesos/master.mesos/dcos.mesos/internal-sandpit-staging-internal-lb-1023536621.eu-central-1.elb.amazonaws.com'\nruncmd:\n- update-rc.d dnsmasq defaults\n",
                            "template": "#cloud-config\npackage_update: true\npackages:\n- dnsmasq\nwrite_files:\n- path: /etc/dnsmasq.conf\n  content: 'server=/sandpit-kixi.mesos/${fallback-dns}\n\n    server=/marathon.mesos/leader.mesos/master.mesos/dcos.mesos/${internal-lb-dns}'\nruncmd:\n- update-rc.d dnsmasq defaults\n",
                            "vars.#": "2",
                            "vars.fallback-dns": "172.20.0.2",
                            "vars.internal-lb-dns": "internal-sandpit-staging-internal-lb-1023536621.eu-central-1.elb.amazonaws.com"
                        }
                    }
                },
                "template_file.sandpit-staging-master-user-data": {
                    "type": "template_file",
                    "depends_on": [
                        "aws_elb.sandpit-staging-internal-lb",
                        "aws_iam_access_key.sandpit-staging-host-key",
                        "aws_iam_access_key.sandpit-staging-host-key",
                        "aws_iam_role.sandpit-staging-master-role",
                        "aws_iam_role.sandpit-staging-slave-role"
                    ],
                    "primary": {
                        "id": "854b41b412c10f835eb02a5443744f92935616476b6426d969903543c6c68464",
                        "attributes": {
                            "id": "854b41b412c10f835eb02a5443744f92935616476b6426d969903543c6c68464",
                            "rendered": "#cloud-config\ncoreos:\n  units:\n  - name: etcd.service\n    command: stop\n    mask: true\n  - name: update-engine.service\n    command: stop\n    mask: true\n  - name: locksmithd.service\n    command: stop\n    mask: true\n  - name: systemd-resolved.service\n    command: restart\n  - name: systemd-journald.service\n    command: restart\n  - name: docker.service\n    command: restart\n    enable: true\n  - name: dcos-link-env.service\n    command: start\n    content: '[Unit]\n\n      Before=dcos.target\n\n      [Service]\n\n      Type=oneshot\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      ExecStartPre=/usr/bin/mkdir -p /etc/profile.d\n\n      ExecStart=/usr/bin/ln -sf /opt/mesosphere/environment.export /etc/profile.d/dcos.sh\n\n      '\n  - name: dcos-download.service\n    content: '[Unit]\n\n      Description=Download the DCOS\n\n      After=network-online.target\n\n      Wants=network-online.target\n\n      ConditionPathExists=!/opt/mesosphere/\n\n      [Service]\n\n      EnvironmentFile=/etc/mesosphere/setup-flags/bootstrap-id\n\n      Type=oneshot\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      ExecStartPre=/usr/bin/curl --fail --retry 20 --continue-at - --location --silent\n      --show-error --verbose --output /tmp/bootstrap.tar.xz https://downloads.mesosphere.com/dcos/stable/bootstrap/${BOOTSTRAP_ID}.bootstrap.tar.xz\n\n      ExecStartPre=/usr/bin/mkdir -p /opt/mesosphere\n\n      ExecStart=/usr/bin/tar -axf /tmp/bootstrap.tar.xz -C /opt/mesosphere\n\n      ExecStartPost=-/usr/bin/rm -f /tmp/bootstrap.tar.xz\n\n      '\n  - name: dcos-setup.service\n    command: start\n    content: '[Unit]\n\n      Description=Prep the Pkgpanda working directories for this host.\n\n      Requires=dcos-download.service\n\n      After=dcos-download.service\n\n      [Service]\n\n      Type=oneshot\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      EnvironmentFile=/opt/mesosphere/environment\n\n      ExecStart=/opt/mesosphere/bin/pkgpanda setup --no-block-systemd\n\n      [Install]\n\n      WantedBy=multi-user.target'\n    enable: true\n  - name: cadvisor.service\n    command: start\n    content: '[Unit]\n\n      Description=cAdvisor for monitoring\n\n      Requires=docker.service\n\n      After=docker.service\n\n      [Service]\n\n      User=core\n\n      TimeoutStartSec=15\n\n      ExecStartPre=-/usr/bin/docker pull mastodonc/cadvisor:latest\n\n      ExecStart=/usr/bin/docker run --name=cadvisor --label application=cadvisor --net=host\n      --volume=/:/rootfs:ro --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro\n      --publish=9922:9922  --detach=false mastodonc/cadvisor:latest -port 9922 -storage_driver=influxdb\n      -storage_driver_host=influxdb.sandpit-kixi.mesos:8086 -storage_driver_db=cadvisor_staging\n\n      ExecStop=-/usr/bin/docker stop -t 2 cadvisor; /usr/bin/docker rm -f cadvisor\n\n      '\n    enable: true\n  - name: docker-cleanup.service\n    content: '[Unit]\n\n      Description=Regularly cleanup unused docker images\n\n\n      [Service]\n\n      Type=oneshot\n\n      ExecStart=/usr/bin/docker rmi $(/usr/bin/docker images -a -q)'\n  - name: docker-cleanup.timer\n    command: start\n    content: '[Unit]\n\n      Description=Run docker-cleanup once a day at 1am\n\n\n      [Timer]\n\n      OnCalendar=*-*-* 01:00:00\n\n      Unit=docker-cleanup.service\n\n\n      [Install]\n\n      WantedBy=timers.target'\n  - name: install-confd.service\n    command: start\n    content: '[Unit]\n\n      Description=download and install confd\n\n      After=network-online.target\n\n      Wants=network-online.target\n\n      [Service]\n\n      Type=oneshot\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      TimeoutStartSec=10\n\n      ExecStartPre=/usr/bin/curl --fail --retry 20 --location --silent --show-error\n      --verbose --output /tmp/confd-0.11.0 https://s3.eu-central-1.amazonaws.com/witan-cf-templates/confd-0.11.0-linux-amd64;\n      /usr/bin/mkdir -p /opt/mesosphere/bin; /usr/bin/mv /tmp/confd-0.11.0 /opt/mesosphere/bin/;\n      /usr/bin/ln -s /opt/mesosphere/bin/confd-0.11.0 /opt/mesosphere/bin/confd\n\n      ExecStartPre=/usr/bin/mkdir -p /etc/confd/conf.d\n\n      ExecStartPre=/usr/bin/mkdir -p /etc/confd/templates\n\n      ExecStart=/usr/bin/chmod +x /opt/mesosphere/bin/confd-0.11.0\n\n      ExecStartPost=-/usr/bin/rm -f /tmp/confd-0.11.0\n\n      '\n  - name: confd.service\n    command: start\n    content: '[Unit]\n\n      Description=running confd\n\n      After=multi-user.target\n\n      Wants=multi-user.target\n\n\n      [Service]\n\n      Restart=always\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      ExecStart=/opt/mesosphere/bin/confd -backend=zookeeper -log-level=debug -node=internal-sandpit-staging-internal-lb-1023536621.eu-central-1.elb.amazonaws.com:2181\n      -interval=60\n\n      ExecStop=-/usr/bin/pkill confd'\n    enable: true\n  - name: install-awscli.service\n    command: start\n    content: '[Unit]\n\n      Description=download and install aws-cli\n\n      After=multi-user.target\n\n      Wants=multi-user.target\n\n      [Service]\n\n      Type=oneshot\n\n      TimeoutStartSec=10\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      ExecStart=/opt/mesosphere/bin/pip install awscli\n\n      '\n    enable: true\n  - name: dcos-gen-resolvconf.timer\n    command: stop\n    mask: true\n  update:\n    reboot-strategy: 'off'\nwrite_files:\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/pkginfo.json\n  content: '{}\n\n    '\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/etc/cloudenv\n  content: 'AWS_REGION=eu-central-1\n\n    AWS_STACK_ID=sandpit-staging\n\n    AWS_STACK_NAME=staging\n\n    AWS_IAM_MASTER_ROLE_NAME=sandpit-staging-master-role\n\n    AWS_IAM_SLAVE_ROLE_NAME=sandpit-staging-slave-role\n\n    AWS_ACCESS_KEY_ID=AKIAIU6KU4KHLAG5KWLA\n\n    AWS_SECRET_ACCESS_KEY=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\n\n    ZOOKEEPER_CLUSTER_SIZE=3\n\n    '\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/etc/mesos-master-provider\n  content: 'MESOS_CLUSTER=staging\n\n    '\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/etc/exhibitor\n  content: 'EXHIBITOR_BACKEND=AWS_S3\n\n    AWS_REGION=eu-central-1\n\n    AWS_S3_BUCKET=sandpit-staging-exhibitor-s3-bucket\n\n    AWS_S3_PREFIX=staging\n\n    '\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/etc/exhibitor.properties\n  content: 'com.netflix.exhibitor.s3.access-key-id=AKIAIU6KU4KHLAG5KWLA\n\n    com.netflix.exhibitor.s3.access-secret-key=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\n\n    '\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/etc/dns_config\n  content: 'MASTER_SOURCE=exhibitor\n\n    EXHIBITOR_ADDRESS=internal-sandpit-staging-internal-lb-1023536621.eu-central-1.elb.amazonaws.com\n\n    RESOLVERS=172.20.0.2\n\n    '\n- path: /etc/mesosphere/cluster-id\n  content: sandpit-staging\n  permissions: '0644'\n- path: /etc/mesosphere/setup-flags/repository-url\n  content: 'https://downloads.mesosphere.com/dcos/stable\n\n    '\n  owner: root\n  permissions: 420\n- path: /etc/mesosphere/setup-flags/bootstrap-id\n  content: BOOTSTRAP_ID=18d094b1648521b017622180e3a8e05788a81e80\n  owner: root\n  permissions: 420\n- path: /etc/mesosphere/setup-flags/cluster-packages.json\n  content: '[\"dcos-config--setup_39bcd04b14a990a870cdff4543566e78d7507ba5\", \"dcos-metadata--setup_39bcd04b14a990a870cdff4543566e78d7507ba5\"]\n\n    '\n  owner: root\n  permissions: 420\n- path: /etc/systemd/journald.conf.d/dcos.conf\n  content: '[Journal]\n\n    MaxLevelConsole=warning\n\n    '\n  owner: root\n- path: /etc/systemd/journal-upload.conf\n  content: '[Upload]\n\n    URL=http://logstash.mastodonc.net:12201\n\n    '\n  owner: root\n- path: /etc/confd/conf.d/ssh-authorized-keys.toml\n  content: '[template]\n\n    src = \"ssh-authorized-keys.tmpl\"\n\n    dest = \"/home/core/.ssh/authorized_keys.d/extra-users\"\n\n    owner = \"core\"\n\n    mode=\"0600\"\n\n    keys = [\"/ssh/authorized-keys\"]\n\n    reload_cmd = \"/usr/bin/update-ssh-keys\"\n\n    '\n- path: /etc/confd/templates/ssh-authorized-keys.tmpl\n  content: '{{range getvs \"/ssh/authorized-keys/*\"}}{{.}}\n\n    {{end}}'\n- path: /etc/systemd/resolved.conf\n  content: '[Resolve]\n\n    DNS=staging-dns.sandpit-kixi.mesos\n\n    FallbackDNS=127.0.0.1'\n- path: /etc/mesosphere/roles/master\n  content: ''\n- path: /etc/mesosphere/roles/aws_master\n  content: ''\n- path: /etc/mesosphere/roles/aws\n  content: ''\n",
                            "template": "#cloud-config\ncoreos:\n  units:\n  - name: etcd.service\n    command: stop\n    mask: true\n  - name: update-engine.service\n    command: stop\n    mask: true\n  - name: locksmithd.service\n    command: stop\n    mask: true\n  - name: systemd-resolved.service\n    command: restart\n  - name: systemd-journald.service\n    command: restart\n  - name: docker.service\n    command: restart\n    enable: true\n  - name: dcos-link-env.service\n    command: start\n    content: '[Unit]\n\n      Before=dcos.target\n\n      [Service]\n\n      Type=oneshot\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      ExecStartPre=/usr/bin/mkdir -p /etc/profile.d\n\n      ExecStart=/usr/bin/ln -sf /opt/mesosphere/environment.export /etc/profile.d/dcos.sh\n\n      '\n  - name: dcos-download.service\n    content: '[Unit]\n\n      Description=Download the DCOS\n\n      After=network-online.target\n\n      Wants=network-online.target\n\n      ConditionPathExists=!/opt/mesosphere/\n\n      [Service]\n\n      EnvironmentFile=/etc/mesosphere/setup-flags/bootstrap-id\n\n      Type=oneshot\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      ExecStartPre=/usr/bin/curl --fail --retry 20 --continue-at - --location --silent\n      --show-error --verbose --output /tmp/bootstrap.tar.xz https://downloads.mesosphere.com/dcos/stable/bootstrap/$${BOOTSTRAP_ID}.bootstrap.tar.xz\n\n      ExecStartPre=/usr/bin/mkdir -p /opt/mesosphere\n\n      ExecStart=/usr/bin/tar -axf /tmp/bootstrap.tar.xz -C /opt/mesosphere\n\n      ExecStartPost=-/usr/bin/rm -f /tmp/bootstrap.tar.xz\n\n      '\n  - name: dcos-setup.service\n    command: start\n    content: '[Unit]\n\n      Description=Prep the Pkgpanda working directories for this host.\n\n      Requires=dcos-download.service\n\n      After=dcos-download.service\n\n      [Service]\n\n      Type=oneshot\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      EnvironmentFile=/opt/mesosphere/environment\n\n      ExecStart=/opt/mesosphere/bin/pkgpanda setup --no-block-systemd\n\n      [Install]\n\n      WantedBy=multi-user.target'\n    enable: true\n  - name: cadvisor.service\n    command: start\n    content: '[Unit]\n\n      Description=cAdvisor for monitoring\n\n      Requires=docker.service\n\n      After=docker.service\n\n      [Service]\n\n      User=core\n\n      TimeoutStartSec=15\n\n      ExecStartPre=-/usr/bin/docker pull mastodonc/cadvisor:latest\n\n      ExecStart=/usr/bin/docker run --name=cadvisor --label application=cadvisor --net=host\n      --volume=/:/rootfs:ro --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro\n      --publish=9922:9922  --detach=false mastodonc/cadvisor:latest -port 9922 -storage_driver=influxdb\n      -storage_driver_host=${influxdb-dns}:8086 -storage_driver_db=cadvisor_${cluster-name}\n\n      ExecStop=-/usr/bin/docker stop -t 2 cadvisor; /usr/bin/docker rm -f cadvisor\n\n      '\n    enable: true\n  - name: docker-cleanup.service\n    content: '[Unit]\n\n      Description=Regularly cleanup unused docker images\n\n\n      [Service]\n\n      Type=oneshot\n\n      ExecStart=/usr/bin/docker rmi $(/usr/bin/docker images -a -q)'\n  - name: docker-cleanup.timer\n    command: start\n    content: '[Unit]\n\n      Description=Run docker-cleanup once a day at 1am\n\n\n      [Timer]\n\n      OnCalendar=*-*-* 01:00:00\n\n      Unit=docker-cleanup.service\n\n\n      [Install]\n\n      WantedBy=timers.target'\n  - name: install-confd.service\n    command: start\n    content: '[Unit]\n\n      Description=download and install confd\n\n      After=network-online.target\n\n      Wants=network-online.target\n\n      [Service]\n\n      Type=oneshot\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      TimeoutStartSec=10\n\n      ExecStartPre=/usr/bin/curl --fail --retry 20 --location --silent --show-error\n      --verbose --output /tmp/confd-0.11.0 https://s3.eu-central-1.amazonaws.com/witan-cf-templates/confd-0.11.0-linux-amd64;\n      /usr/bin/mkdir -p /opt/mesosphere/bin; /usr/bin/mv /tmp/confd-0.11.0 /opt/mesosphere/bin/;\n      /usr/bin/ln -s /opt/mesosphere/bin/confd-0.11.0 /opt/mesosphere/bin/confd\n\n      ExecStartPre=/usr/bin/mkdir -p /etc/confd/conf.d\n\n      ExecStartPre=/usr/bin/mkdir -p /etc/confd/templates\n\n      ExecStart=/usr/bin/chmod +x /opt/mesosphere/bin/confd-0.11.0\n\n      ExecStartPost=-/usr/bin/rm -f /tmp/confd-0.11.0\n\n      '\n  - name: confd.service\n    command: start\n    content: '[Unit]\n\n      Description=running confd\n\n      After=multi-user.target\n\n      Wants=multi-user.target\n\n\n      [Service]\n\n      Restart=always\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      ExecStart=/opt/mesosphere/bin/confd -backend=zookeeper -log-level=debug -node=${internal-lb-dns}:2181\n      -interval=60\n\n      ExecStop=-/usr/bin/pkill confd'\n    enable: true\n  - name: install-awscli.service\n    command: start\n    content: '[Unit]\n\n      Description=download and install aws-cli\n\n      After=multi-user.target\n\n      Wants=multi-user.target\n\n      [Service]\n\n      Type=oneshot\n\n      TimeoutStartSec=10\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      ExecStart=/opt/mesosphere/bin/pip install awscli\n\n      '\n    enable: true\n  - name: dcos-gen-resolvconf.timer\n    command: stop\n    mask: true\n  update:\n    reboot-strategy: 'off'\nwrite_files:\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/pkginfo.json\n  content: '{}\n\n    '\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/etc/cloudenv\n  content: 'AWS_REGION=${aws-region}\n\n    AWS_STACK_ID=${cluster-id}\n\n    AWS_STACK_NAME=${cluster-name}\n\n    AWS_IAM_MASTER_ROLE_NAME=${master-role}\n\n    AWS_IAM_SLAVE_ROLE_NAME=${slave-role}\n\n    AWS_ACCESS_KEY_ID=${aws-access-key}\n\n    AWS_SECRET_ACCESS_KEY=${aws-secret-access-key}\n\n    ZOOKEEPER_CLUSTER_SIZE=${number-of-masters}\n\n    '\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/etc/mesos-master-provider\n  content: 'MESOS_CLUSTER=${cluster-name}\n\n    '\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/etc/exhibitor\n  content: 'EXHIBITOR_BACKEND=AWS_S3\n\n    AWS_REGION=${aws-region}\n\n    AWS_S3_BUCKET=${exhibitor-s3-bucket}\n\n    AWS_S3_PREFIX=${cluster-name}\n\n    '\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/etc/exhibitor.properties\n  content: 'com.netflix.exhibitor.s3.access-key-id=${aws-access-key}\n\n    com.netflix.exhibitor.s3.access-secret-key=${aws-secret-access-key}\n\n    '\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/etc/dns_config\n  content: 'MASTER_SOURCE=exhibitor\n\n    EXHIBITOR_ADDRESS=${internal-lb-dns}\n\n    RESOLVERS=${fallback-dns}\n\n    '\n- path: /etc/mesosphere/cluster-id\n  content: ${cluster-id}\n  permissions: '0644'\n- path: /etc/mesosphere/setup-flags/repository-url\n  content: 'https://downloads.mesosphere.com/dcos/stable\n\n    '\n  owner: root\n  permissions: 420\n- path: /etc/mesosphere/setup-flags/bootstrap-id\n  content: BOOTSTRAP_ID=18d094b1648521b017622180e3a8e05788a81e80\n  owner: root\n  permissions: 420\n- path: /etc/mesosphere/setup-flags/cluster-packages.json\n  content: '[\"dcos-config--setup_39bcd04b14a990a870cdff4543566e78d7507ba5\", \"dcos-metadata--setup_39bcd04b14a990a870cdff4543566e78d7507ba5\"]\n\n    '\n  owner: root\n  permissions: 420\n- path: /etc/systemd/journald.conf.d/dcos.conf\n  content: '[Journal]\n\n    MaxLevelConsole=warning\n\n    '\n  owner: root\n- path: /etc/systemd/journal-upload.conf\n  content: '[Upload]\n\n    URL=http://logstash.mastodonc.net:12201\n\n    '\n  owner: root\n- path: /etc/confd/conf.d/ssh-authorized-keys.toml\n  content: '[template]\n\n    src = \"ssh-authorized-keys.tmpl\"\n\n    dest = \"/home/core/.ssh/authorized_keys.d/extra-users\"\n\n    owner = \"core\"\n\n    mode=\"0600\"\n\n    keys = [\"/ssh/authorized-keys\"]\n\n    reload_cmd = \"/usr/bin/update-ssh-keys\"\n\n    '\n- path: /etc/confd/templates/ssh-authorized-keys.tmpl\n  content: '{{range getvs \"/ssh/authorized-keys/*\"}}{{.}}\n\n    {{end}}'\n- path: /etc/systemd/resolved.conf\n  content: '[Resolve]\n\n    DNS=${dns}\n\n    FallbackDNS=${mesos-dns}'\n- path: /etc/mesosphere/roles/master\n  content: ''\n- path: /etc/mesosphere/roles/aws_master\n  content: ''\n- path: /etc/mesosphere/roles/aws\n  content: ''\n",
                            "vars.#": "15",
                            "vars.aws-access-key": "AKIAIU6KU4KHLAG5KWLA",
                            "vars.aws-region": "eu-central-1",
                            "vars.aws-secret-access-key": "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",
                            "vars.cluster-id": "sandpit-staging",
                            "vars.cluster-name": "staging",
                            "vars.dns": "staging-dns.sandpit-kixi.mesos",
                            "vars.exhibitor-s3-bucket": "sandpit-staging-exhibitor-s3-bucket",
                            "vars.fallback-dns": "172.20.0.2",
                            "vars.influxdb-dns": "influxdb.sandpit-kixi.mesos",
                            "vars.internal-lb-dns": "internal-sandpit-staging-internal-lb-1023536621.eu-central-1.elb.amazonaws.com",
                            "vars.master-role": "sandpit-staging-master-role",
                            "vars.mesos-dns": "127.0.0.1",
                            "vars.number-of-masters": "3",
                            "vars.server-group": "sandpit-staging-masters",
                            "vars.slave-role": "sandpit-staging-slave-role"
                        }
                    }
                },
                "template_file.sandpit-staging-open-mesos-admin": {
                    "type": "template_file",
                    "depends_on": [
                        "aws_elb.sandpit-staging-internal-lb"
                    ],
                    "primary": {
                        "id": "e773426d8bd2eb67c1f132571f4c255b3fecb1394afb0106aa8572323d2f13b7",
                        "attributes": {
                            "id": "e773426d8bd2eb67c1f132571f4c255b3fecb1394afb0106aa8572323d2f13b7",
                            "rendered": "open http://internal-sandpit-staging-internal-lb-1023536621.eu-central-1.elb.amazonaws.com",
                            "template": "open http://internal-sandpit-staging-internal-lb-1023536621.eu-central-1.elb.amazonaws.com"
                        }
                    }
                },
                "template_file.sandpit-staging-public-slave-user-data": {
                    "type": "template_file",
                    "depends_on": [
                        "aws_elb.sandpit-staging-internal-lb",
                        "aws_iam_access_key.sandpit-staging-host-key",
                        "aws_iam_access_key.sandpit-staging-host-key",
                        "aws_iam_role.sandpit-staging-master-role",
                        "aws_iam_role.sandpit-staging-slave-role"
                    ],
                    "primary": {
                        "id": "98b3573b8fb31983c39b78aae9f0b45a8c043adac0a69725568d1e3edcd9c560",
                        "attributes": {
                            "id": "98b3573b8fb31983c39b78aae9f0b45a8c043adac0a69725568d1e3edcd9c560",
                            "rendered": "#cloud-config\ncoreos:\n  units:\n  - name: etcd.service\n    command: stop\n    mask: true\n  - name: update-engine.service\n    command: stop\n    mask: true\n  - name: locksmithd.service\n    command: stop\n    mask: true\n  - name: systemd-resolved.service\n    command: restart\n  - name: systemd-journald.service\n    command: restart\n  - name: docker.service\n    command: restart\n    enable: true\n  - name: dcos-link-env.service\n    command: start\n    content: '[Unit]\n\n      Before=dcos.target\n\n      [Service]\n\n      Type=oneshot\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      ExecStartPre=/usr/bin/mkdir -p /etc/profile.d\n\n      ExecStart=/usr/bin/ln -sf /opt/mesosphere/environment.export /etc/profile.d/dcos.sh\n\n      '\n  - name: dcos-download.service\n    content: '[Unit]\n\n      Description=Download the DCOS\n\n      After=network-online.target\n\n      Wants=network-online.target\n\n      ConditionPathExists=!/opt/mesosphere/\n\n      [Service]\n\n      EnvironmentFile=/etc/mesosphere/setup-flags/bootstrap-id\n\n      Type=oneshot\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      ExecStartPre=/usr/bin/curl --fail --retry 20 --continue-at - --location --silent\n      --show-error --verbose --output /tmp/bootstrap.tar.xz https://downloads.mesosphere.com/dcos/stable/bootstrap/${BOOTSTRAP_ID}.bootstrap.tar.xz\n\n      ExecStartPre=/usr/bin/mkdir -p /opt/mesosphere\n\n      ExecStart=/usr/bin/tar -axf /tmp/bootstrap.tar.xz -C /opt/mesosphere\n\n      ExecStartPost=-/usr/bin/rm -f /tmp/bootstrap.tar.xz\n\n      '\n  - name: dcos-setup.service\n    command: start\n    content: '[Unit]\n\n      Description=Prep the Pkgpanda working directories for this host.\n\n      Requires=dcos-download.service\n\n      After=dcos-download.service\n\n      [Service]\n\n      Type=oneshot\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      EnvironmentFile=/opt/mesosphere/environment\n\n      ExecStart=/opt/mesosphere/bin/pkgpanda setup --no-block-systemd\n\n      [Install]\n\n      WantedBy=multi-user.target'\n    enable: true\n  - name: cadvisor.service\n    command: start\n    content: '[Unit]\n\n      Description=cAdvisor for monitoring\n\n      Requires=docker.service\n\n      After=docker.service\n\n      [Service]\n\n      User=core\n\n      TimeoutStartSec=15\n\n      ExecStartPre=-/usr/bin/docker pull mastodonc/cadvisor:latest\n\n      ExecStart=/usr/bin/docker run --name=cadvisor --label application=cadvisor --net=host\n      --volume=/:/rootfs:ro --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro\n      --publish=9922:9922  --detach=false mastodonc/cadvisor:latest -port 9922 -storage_driver=influxdb\n      -storage_driver_host=influxdb.sandpit-kixi.mesos:8086 -storage_driver_db=cadvisor_staging\n\n      ExecStop=-/usr/bin/docker stop -t 2 cadvisor; /usr/bin/docker rm -f cadvisor\n\n      '\n    enable: true\n  - name: docker-cleanup.service\n    content: '[Unit]\n\n      Description=Regularly cleanup unused docker images\n\n\n      [Service]\n\n      Type=oneshot\n\n      ExecStart=/usr/bin/docker rmi $(/usr/bin/docker images -a -q)'\n  - name: docker-cleanup.timer\n    command: start\n    content: '[Unit]\n\n      Description=Run docker-cleanup once a day at 1am\n\n\n      [Timer]\n\n      OnCalendar=*-*-* 01:00:00\n\n      Unit=docker-cleanup.service\n\n\n      [Install]\n\n      WantedBy=timers.target'\n  - name: install-confd.service\n    command: start\n    content: '[Unit]\n\n      Description=download and install confd\n\n      After=network-online.target\n\n      Wants=network-online.target\n\n      [Service]\n\n      Type=oneshot\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      TimeoutStartSec=10\n\n      ExecStartPre=/usr/bin/curl --fail --retry 20 --location --silent --show-error\n      --verbose --output /tmp/confd-0.11.0 https://s3.eu-central-1.amazonaws.com/witan-cf-templates/confd-0.11.0-linux-amd64;\n      /usr/bin/mkdir -p /opt/mesosphere/bin; /usr/bin/mv /tmp/confd-0.11.0 /opt/mesosphere/bin/;\n      /usr/bin/ln -s /opt/mesosphere/bin/confd-0.11.0 /opt/mesosphere/bin/confd\n\n      ExecStartPre=/usr/bin/mkdir -p /etc/confd/conf.d\n\n      ExecStartPre=/usr/bin/mkdir -p /etc/confd/templates\n\n      ExecStart=/usr/bin/chmod +x /opt/mesosphere/bin/confd-0.11.0\n\n      ExecStartPost=-/usr/bin/rm -f /tmp/confd-0.11.0\n\n      '\n  - name: confd.service\n    command: start\n    content: '[Unit]\n\n      Description=running confd\n\n      After=multi-user.target\n\n      Wants=multi-user.target\n\n\n      [Service]\n\n      Restart=always\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      ExecStart=/opt/mesosphere/bin/confd -backend=zookeeper -log-level=debug -node=internal-sandpit-staging-internal-lb-1023536621.eu-central-1.elb.amazonaws.com:2181\n      -interval=60\n\n      ExecStop=-/usr/bin/pkill confd'\n    enable: true\n  - name: install-awscli.service\n    command: start\n    content: '[Unit]\n\n      Description=download and install aws-cli\n\n      After=multi-user.target\n\n      Wants=multi-user.target\n\n      [Service]\n\n      Type=oneshot\n\n      TimeoutStartSec=10\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      ExecStart=/opt/mesosphere/bin/pip install awscli\n\n      '\n    enable: true\n  - name: dcos-gen-resolvconf.timer\n    command: stop\n    mask: true\n  update:\n    reboot-strategy: 'off'\nwrite_files:\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/pkginfo.json\n  content: '{}\n\n    '\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/etc/cloudenv\n  content: 'AWS_REGION=eu-central-1\n\n    AWS_STACK_ID=sandpit-staging\n\n    AWS_STACK_NAME=staging\n\n    AWS_IAM_MASTER_ROLE_NAME=sandpit-staging-master-role\n\n    AWS_IAM_SLAVE_ROLE_NAME=sandpit-staging-slave-role\n\n    AWS_ACCESS_KEY_ID=AKIAIU6KU4KHLAG5KWLA\n\n    AWS_SECRET_ACCESS_KEY=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\n\n    ZOOKEEPER_CLUSTER_SIZE=3\n\n    '\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/etc/mesos-master-provider\n  content: 'MESOS_CLUSTER=staging\n\n    '\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/etc/exhibitor\n  content: 'EXHIBITOR_BACKEND=AWS_S3\n\n    AWS_REGION=eu-central-1\n\n    AWS_S3_BUCKET=sandpit-staging-exhibitor-s3-bucket\n\n    AWS_S3_PREFIX=staging\n\n    '\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/etc/exhibitor.properties\n  content: 'com.netflix.exhibitor.s3.access-key-id=AKIAIU6KU4KHLAG5KWLA\n\n    com.netflix.exhibitor.s3.access-secret-key=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\n\n    '\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/etc/dns_config\n  content: 'MASTER_SOURCE=exhibitor\n\n    EXHIBITOR_ADDRESS=internal-sandpit-staging-internal-lb-1023536621.eu-central-1.elb.amazonaws.com\n\n    RESOLVERS=172.20.0.2\n\n    '\n- path: /etc/mesosphere/cluster-id\n  content: sandpit-staging\n  permissions: '0644'\n- path: /etc/mesosphere/setup-flags/repository-url\n  content: 'https://downloads.mesosphere.com/dcos/stable\n\n    '\n  owner: root\n  permissions: 420\n- path: /etc/mesosphere/setup-flags/bootstrap-id\n  content: BOOTSTRAP_ID=18d094b1648521b017622180e3a8e05788a81e80\n  owner: root\n  permissions: 420\n- path: /etc/mesosphere/setup-flags/cluster-packages.json\n  content: '[\"dcos-config--setup_39bcd04b14a990a870cdff4543566e78d7507ba5\", \"dcos-metadata--setup_39bcd04b14a990a870cdff4543566e78d7507ba5\"]\n\n    '\n  owner: root\n  permissions: 420\n- path: /etc/systemd/journald.conf.d/dcos.conf\n  content: '[Journal]\n\n    MaxLevelConsole=warning\n\n    '\n  owner: root\n- path: /etc/systemd/journal-upload.conf\n  content: '[Upload]\n\n    URL=http://logstash.mastodonc.net:12201\n\n    '\n  owner: root\n- path: /etc/confd/conf.d/ssh-authorized-keys.toml\n  content: '[template]\n\n    src = \"ssh-authorized-keys.tmpl\"\n\n    dest = \"/home/core/.ssh/authorized_keys.d/extra-users\"\n\n    owner = \"core\"\n\n    mode=\"0600\"\n\n    keys = [\"/ssh/authorized-keys\"]\n\n    reload_cmd = \"/usr/bin/update-ssh-keys\"\n\n    '\n- path: /etc/confd/templates/ssh-authorized-keys.tmpl\n  content: '{{range getvs \"/ssh/authorized-keys/*\"}}{{.}}\n\n    {{end}}'\n- path: /etc/systemd/resolved.conf\n  content: '[Resolve]\n\n    DNS=staging-dns.sandpit-kixi.mesos\n\n    FallbackDNS=internal-sandpit-staging-internal-lb-1023536621.eu-central-1.elb.amazonaws.com'\n- path: /etc/mesosphere/roles/slave_public\n  content: ''\n- path: /etc/mesosphere/roles/aws\n  content: ''\n",
                            "template": "#cloud-config\ncoreos:\n  units:\n  - name: etcd.service\n    command: stop\n    mask: true\n  - name: update-engine.service\n    command: stop\n    mask: true\n  - name: locksmithd.service\n    command: stop\n    mask: true\n  - name: systemd-resolved.service\n    command: restart\n  - name: systemd-journald.service\n    command: restart\n  - name: docker.service\n    command: restart\n    enable: true\n  - name: dcos-link-env.service\n    command: start\n    content: '[Unit]\n\n      Before=dcos.target\n\n      [Service]\n\n      Type=oneshot\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      ExecStartPre=/usr/bin/mkdir -p /etc/profile.d\n\n      ExecStart=/usr/bin/ln -sf /opt/mesosphere/environment.export /etc/profile.d/dcos.sh\n\n      '\n  - name: dcos-download.service\n    content: '[Unit]\n\n      Description=Download the DCOS\n\n      After=network-online.target\n\n      Wants=network-online.target\n\n      ConditionPathExists=!/opt/mesosphere/\n\n      [Service]\n\n      EnvironmentFile=/etc/mesosphere/setup-flags/bootstrap-id\n\n      Type=oneshot\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      ExecStartPre=/usr/bin/curl --fail --retry 20 --continue-at - --location --silent\n      --show-error --verbose --output /tmp/bootstrap.tar.xz https://downloads.mesosphere.com/dcos/stable/bootstrap/$${BOOTSTRAP_ID}.bootstrap.tar.xz\n\n      ExecStartPre=/usr/bin/mkdir -p /opt/mesosphere\n\n      ExecStart=/usr/bin/tar -axf /tmp/bootstrap.tar.xz -C /opt/mesosphere\n\n      ExecStartPost=-/usr/bin/rm -f /tmp/bootstrap.tar.xz\n\n      '\n  - name: dcos-setup.service\n    command: start\n    content: '[Unit]\n\n      Description=Prep the Pkgpanda working directories for this host.\n\n      Requires=dcos-download.service\n\n      After=dcos-download.service\n\n      [Service]\n\n      Type=oneshot\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      EnvironmentFile=/opt/mesosphere/environment\n\n      ExecStart=/opt/mesosphere/bin/pkgpanda setup --no-block-systemd\n\n      [Install]\n\n      WantedBy=multi-user.target'\n    enable: true\n  - name: cadvisor.service\n    command: start\n    content: '[Unit]\n\n      Description=cAdvisor for monitoring\n\n      Requires=docker.service\n\n      After=docker.service\n\n      [Service]\n\n      User=core\n\n      TimeoutStartSec=15\n\n      ExecStartPre=-/usr/bin/docker pull mastodonc/cadvisor:latest\n\n      ExecStart=/usr/bin/docker run --name=cadvisor --label application=cadvisor --net=host\n      --volume=/:/rootfs:ro --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro\n      --publish=9922:9922  --detach=false mastodonc/cadvisor:latest -port 9922 -storage_driver=influxdb\n      -storage_driver_host=${influxdb-dns}:8086 -storage_driver_db=cadvisor_${cluster-name}\n\n      ExecStop=-/usr/bin/docker stop -t 2 cadvisor; /usr/bin/docker rm -f cadvisor\n\n      '\n    enable: true\n  - name: docker-cleanup.service\n    content: '[Unit]\n\n      Description=Regularly cleanup unused docker images\n\n\n      [Service]\n\n      Type=oneshot\n\n      ExecStart=/usr/bin/docker rmi $(/usr/bin/docker images -a -q)'\n  - name: docker-cleanup.timer\n    command: start\n    content: '[Unit]\n\n      Description=Run docker-cleanup once a day at 1am\n\n\n      [Timer]\n\n      OnCalendar=*-*-* 01:00:00\n\n      Unit=docker-cleanup.service\n\n\n      [Install]\n\n      WantedBy=timers.target'\n  - name: install-confd.service\n    command: start\n    content: '[Unit]\n\n      Description=download and install confd\n\n      After=network-online.target\n\n      Wants=network-online.target\n\n      [Service]\n\n      Type=oneshot\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      TimeoutStartSec=10\n\n      ExecStartPre=/usr/bin/curl --fail --retry 20 --location --silent --show-error\n      --verbose --output /tmp/confd-0.11.0 https://s3.eu-central-1.amazonaws.com/witan-cf-templates/confd-0.11.0-linux-amd64;\n      /usr/bin/mkdir -p /opt/mesosphere/bin; /usr/bin/mv /tmp/confd-0.11.0 /opt/mesosphere/bin/;\n      /usr/bin/ln -s /opt/mesosphere/bin/confd-0.11.0 /opt/mesosphere/bin/confd\n\n      ExecStartPre=/usr/bin/mkdir -p /etc/confd/conf.d\n\n      ExecStartPre=/usr/bin/mkdir -p /etc/confd/templates\n\n      ExecStart=/usr/bin/chmod +x /opt/mesosphere/bin/confd-0.11.0\n\n      ExecStartPost=-/usr/bin/rm -f /tmp/confd-0.11.0\n\n      '\n  - name: confd.service\n    command: start\n    content: '[Unit]\n\n      Description=running confd\n\n      After=multi-user.target\n\n      Wants=multi-user.target\n\n\n      [Service]\n\n      Restart=always\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      ExecStart=/opt/mesosphere/bin/confd -backend=zookeeper -log-level=debug -node=${internal-lb-dns}:2181\n      -interval=60\n\n      ExecStop=-/usr/bin/pkill confd'\n    enable: true\n  - name: install-awscli.service\n    command: start\n    content: '[Unit]\n\n      Description=download and install aws-cli\n\n      After=multi-user.target\n\n      Wants=multi-user.target\n\n      [Service]\n\n      Type=oneshot\n\n      TimeoutStartSec=10\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      ExecStart=/opt/mesosphere/bin/pip install awscli\n\n      '\n    enable: true\n  - name: dcos-gen-resolvconf.timer\n    command: stop\n    mask: true\n  update:\n    reboot-strategy: 'off'\nwrite_files:\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/pkginfo.json\n  content: '{}\n\n    '\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/etc/cloudenv\n  content: 'AWS_REGION=${aws-region}\n\n    AWS_STACK_ID=${cluster-id}\n\n    AWS_STACK_NAME=${cluster-name}\n\n    AWS_IAM_MASTER_ROLE_NAME=${master-role}\n\n    AWS_IAM_SLAVE_ROLE_NAME=${slave-role}\n\n    AWS_ACCESS_KEY_ID=${aws-access-key}\n\n    AWS_SECRET_ACCESS_KEY=${aws-secret-access-key}\n\n    ZOOKEEPER_CLUSTER_SIZE=${number-of-masters}\n\n    '\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/etc/mesos-master-provider\n  content: 'MESOS_CLUSTER=${cluster-name}\n\n    '\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/etc/exhibitor\n  content: 'EXHIBITOR_BACKEND=AWS_S3\n\n    AWS_REGION=${aws-region}\n\n    AWS_S3_BUCKET=${exhibitor-s3-bucket}\n\n    AWS_S3_PREFIX=${cluster-name}\n\n    '\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/etc/exhibitor.properties\n  content: 'com.netflix.exhibitor.s3.access-key-id=${aws-access-key}\n\n    com.netflix.exhibitor.s3.access-secret-key=${aws-secret-access-key}\n\n    '\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/etc/dns_config\n  content: 'MASTER_SOURCE=exhibitor\n\n    EXHIBITOR_ADDRESS=${internal-lb-dns}\n\n    RESOLVERS=${fallback-dns}\n\n    '\n- path: /etc/mesosphere/cluster-id\n  content: ${cluster-id}\n  permissions: '0644'\n- path: /etc/mesosphere/setup-flags/repository-url\n  content: 'https://downloads.mesosphere.com/dcos/stable\n\n    '\n  owner: root\n  permissions: 420\n- path: /etc/mesosphere/setup-flags/bootstrap-id\n  content: BOOTSTRAP_ID=18d094b1648521b017622180e3a8e05788a81e80\n  owner: root\n  permissions: 420\n- path: /etc/mesosphere/setup-flags/cluster-packages.json\n  content: '[\"dcos-config--setup_39bcd04b14a990a870cdff4543566e78d7507ba5\", \"dcos-metadata--setup_39bcd04b14a990a870cdff4543566e78d7507ba5\"]\n\n    '\n  owner: root\n  permissions: 420\n- path: /etc/systemd/journald.conf.d/dcos.conf\n  content: '[Journal]\n\n    MaxLevelConsole=warning\n\n    '\n  owner: root\n- path: /etc/systemd/journal-upload.conf\n  content: '[Upload]\n\n    URL=http://logstash.mastodonc.net:12201\n\n    '\n  owner: root\n- path: /etc/confd/conf.d/ssh-authorized-keys.toml\n  content: '[template]\n\n    src = \"ssh-authorized-keys.tmpl\"\n\n    dest = \"/home/core/.ssh/authorized_keys.d/extra-users\"\n\n    owner = \"core\"\n\n    mode=\"0600\"\n\n    keys = [\"/ssh/authorized-keys\"]\n\n    reload_cmd = \"/usr/bin/update-ssh-keys\"\n\n    '\n- path: /etc/confd/templates/ssh-authorized-keys.tmpl\n  content: '{{range getvs \"/ssh/authorized-keys/*\"}}{{.}}\n\n    {{end}}'\n- path: /etc/systemd/resolved.conf\n  content: '[Resolve]\n\n    DNS=${dns}\n\n    FallbackDNS=${mesos-dns}'\n- path: /etc/mesosphere/roles/slave_public\n  content: ''\n- path: /etc/mesosphere/roles/aws\n  content: ''\n",
                            "vars.#": "15",
                            "vars.aws-access-key": "AKIAIU6KU4KHLAG5KWLA",
                            "vars.aws-region": "eu-central-1",
                            "vars.aws-secret-access-key": "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",
                            "vars.cluster-id": "sandpit-staging",
                            "vars.cluster-name": "staging",
                            "vars.dns": "staging-dns.sandpit-kixi.mesos",
                            "vars.exhibitor-s3-bucket": "sandpit-staging-exhibitor-s3-bucket",
                            "vars.fallback-dns": "172.20.0.2",
                            "vars.influxdb-dns": "influxdb.sandpit-kixi.mesos",
                            "vars.internal-lb-dns": "internal-sandpit-staging-internal-lb-1023536621.eu-central-1.elb.amazonaws.com",
                            "vars.master-role": "sandpit-staging-master-role",
                            "vars.mesos-dns": "internal-sandpit-staging-internal-lb-1023536621.eu-central-1.elb.amazonaws.com",
                            "vars.number-of-masters": "3",
                            "vars.server-group": "sandpit-staging-public-slaves",
                            "vars.slave-role": "sandpit-staging-slave-role"
                        }
                    }
                },
                "template_file.sandpit-staging-slave-user-data": {
                    "type": "template_file",
                    "depends_on": [
                        "aws_elb.sandpit-staging-internal-lb",
                        "aws_iam_access_key.sandpit-staging-host-key",
                        "aws_iam_access_key.sandpit-staging-host-key",
                        "aws_iam_role.sandpit-staging-master-role",
                        "aws_iam_role.sandpit-staging-slave-role"
                    ],
                    "primary": {
                        "id": "42b2aeaa0a06b0d8d623426ce1c8d935e64fc5d517590adafe2a151defec72e4",
                        "attributes": {
                            "id": "42b2aeaa0a06b0d8d623426ce1c8d935e64fc5d517590adafe2a151defec72e4",
                            "rendered": "#cloud-config\ncoreos:\n  units:\n  - name: etcd.service\n    command: stop\n    mask: true\n  - name: update-engine.service\n    command: stop\n    mask: true\n  - name: locksmithd.service\n    command: stop\n    mask: true\n  - name: systemd-resolved.service\n    command: restart\n  - name: systemd-journald.service\n    command: restart\n  - name: docker.service\n    command: restart\n    enable: true\n  - name: dcos-link-env.service\n    command: start\n    content: '[Unit]\n\n      Before=dcos.target\n\n      [Service]\n\n      Type=oneshot\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      ExecStartPre=/usr/bin/mkdir -p /etc/profile.d\n\n      ExecStart=/usr/bin/ln -sf /opt/mesosphere/environment.export /etc/profile.d/dcos.sh\n\n      '\n  - name: dcos-download.service\n    content: '[Unit]\n\n      Description=Download the DCOS\n\n      After=network-online.target\n\n      Wants=network-online.target\n\n      ConditionPathExists=!/opt/mesosphere/\n\n      [Service]\n\n      EnvironmentFile=/etc/mesosphere/setup-flags/bootstrap-id\n\n      Type=oneshot\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      ExecStartPre=/usr/bin/curl --fail --retry 20 --continue-at - --location --silent\n      --show-error --verbose --output /tmp/bootstrap.tar.xz https://downloads.mesosphere.com/dcos/stable/bootstrap/${BOOTSTRAP_ID}.bootstrap.tar.xz\n\n      ExecStartPre=/usr/bin/mkdir -p /opt/mesosphere\n\n      ExecStart=/usr/bin/tar -axf /tmp/bootstrap.tar.xz -C /opt/mesosphere\n\n      ExecStartPost=-/usr/bin/rm -f /tmp/bootstrap.tar.xz\n\n      '\n  - name: dcos-setup.service\n    command: start\n    content: '[Unit]\n\n      Description=Prep the Pkgpanda working directories for this host.\n\n      Requires=dcos-download.service\n\n      After=dcos-download.service\n\n      [Service]\n\n      Type=oneshot\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      EnvironmentFile=/opt/mesosphere/environment\n\n      ExecStart=/opt/mesosphere/bin/pkgpanda setup --no-block-systemd\n\n      [Install]\n\n      WantedBy=multi-user.target'\n    enable: true\n  - name: cadvisor.service\n    command: start\n    content: '[Unit]\n\n      Description=cAdvisor for monitoring\n\n      Requires=docker.service\n\n      After=docker.service\n\n      [Service]\n\n      User=core\n\n      TimeoutStartSec=15\n\n      ExecStartPre=-/usr/bin/docker pull mastodonc/cadvisor:latest\n\n      ExecStart=/usr/bin/docker run --name=cadvisor --label application=cadvisor --net=host\n      --volume=/:/rootfs:ro --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro\n      --publish=9922:9922  --detach=false mastodonc/cadvisor:latest -port 9922 -storage_driver=influxdb\n      -storage_driver_host=influxdb.sandpit-kixi.mesos:8086 -storage_driver_db=cadvisor_staging\n\n      ExecStop=-/usr/bin/docker stop -t 2 cadvisor; /usr/bin/docker rm -f cadvisor\n\n      '\n    enable: true\n  - name: docker-cleanup.service\n    content: '[Unit]\n\n      Description=Regularly cleanup unused docker images\n\n\n      [Service]\n\n      Type=oneshot\n\n      ExecStart=/usr/bin/docker rmi $(/usr/bin/docker images -a -q)'\n  - name: docker-cleanup.timer\n    command: start\n    content: '[Unit]\n\n      Description=Run docker-cleanup once a day at 1am\n\n\n      [Timer]\n\n      OnCalendar=*-*-* 01:00:00\n\n      Unit=docker-cleanup.service\n\n\n      [Install]\n\n      WantedBy=timers.target'\n  - name: install-confd.service\n    command: start\n    content: '[Unit]\n\n      Description=download and install confd\n\n      After=network-online.target\n\n      Wants=network-online.target\n\n      [Service]\n\n      Type=oneshot\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      TimeoutStartSec=10\n\n      ExecStartPre=/usr/bin/curl --fail --retry 20 --location --silent --show-error\n      --verbose --output /tmp/confd-0.11.0 https://s3.eu-central-1.amazonaws.com/witan-cf-templates/confd-0.11.0-linux-amd64;\n      /usr/bin/mkdir -p /opt/mesosphere/bin; /usr/bin/mv /tmp/confd-0.11.0 /opt/mesosphere/bin/;\n      /usr/bin/ln -s /opt/mesosphere/bin/confd-0.11.0 /opt/mesosphere/bin/confd\n\n      ExecStartPre=/usr/bin/mkdir -p /etc/confd/conf.d\n\n      ExecStartPre=/usr/bin/mkdir -p /etc/confd/templates\n\n      ExecStart=/usr/bin/chmod +x /opt/mesosphere/bin/confd-0.11.0\n\n      ExecStartPost=-/usr/bin/rm -f /tmp/confd-0.11.0\n\n      '\n  - name: confd.service\n    command: start\n    content: '[Unit]\n\n      Description=running confd\n\n      After=multi-user.target\n\n      Wants=multi-user.target\n\n\n      [Service]\n\n      Restart=always\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      ExecStart=/opt/mesosphere/bin/confd -backend=zookeeper -log-level=debug -node=internal-sandpit-staging-internal-lb-1023536621.eu-central-1.elb.amazonaws.com:2181\n      -interval=60\n\n      ExecStop=-/usr/bin/pkill confd'\n    enable: true\n  - name: install-awscli.service\n    command: start\n    content: '[Unit]\n\n      Description=download and install aws-cli\n\n      After=multi-user.target\n\n      Wants=multi-user.target\n\n      [Service]\n\n      Type=oneshot\n\n      TimeoutStartSec=10\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      ExecStart=/opt/mesosphere/bin/pip install awscli\n\n      '\n    enable: true\n  - name: dcos-gen-resolvconf.timer\n    command: stop\n    mask: true\n  - name: backup.service\n    content: '[Unit]\n\n      Description=Backup of cassandra database\n\n      After=multi-user.target\n\n      Wants=multi-user.target\n\n      [Service]\n\n      Type=oneshot\n\n      Environment=\"PATH=/opt/mesosphere/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/opt/bin\"\n\n      ExecStart=/home/core/cassandra-backup/backup-witan.sh\n\n      '\n  - name: backup.timer\n    command: start\n    content: '[Unit]\n\n      Description=Run backup.service once a day at 5am\n\n\n      [Timer]\n\n      OnCalendar=*-*-* 05:00:00\n\n      Unit=backup.service\n\n\n      [Install]\n\n      WantedBy=timers.target\n\n      '\n  update:\n    reboot-strategy: 'off'\nwrite_files:\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/pkginfo.json\n  content: '{}\n\n    '\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/etc/cloudenv\n  content: 'AWS_REGION=eu-central-1\n\n    AWS_STACK_ID=sandpit-staging\n\n    AWS_STACK_NAME=staging\n\n    AWS_IAM_MASTER_ROLE_NAME=sandpit-staging-master-role\n\n    AWS_IAM_SLAVE_ROLE_NAME=sandpit-staging-slave-role\n\n    AWS_ACCESS_KEY_ID=AKIAIU6KU4KHLAG5KWLA\n\n    AWS_SECRET_ACCESS_KEY=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\n\n    ZOOKEEPER_CLUSTER_SIZE=3\n\n    '\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/etc/mesos-master-provider\n  content: 'MESOS_CLUSTER=staging\n\n    '\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/etc/exhibitor\n  content: 'EXHIBITOR_BACKEND=AWS_S3\n\n    AWS_REGION=eu-central-1\n\n    AWS_S3_BUCKET=sandpit-staging-exhibitor-s3-bucket\n\n    AWS_S3_PREFIX=staging\n\n    '\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/etc/exhibitor.properties\n  content: 'com.netflix.exhibitor.s3.access-key-id=AKIAIU6KU4KHLAG5KWLA\n\n    com.netflix.exhibitor.s3.access-secret-key=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\n\n    '\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/etc/dns_config\n  content: 'MASTER_SOURCE=exhibitor\n\n    EXHIBITOR_ADDRESS=internal-sandpit-staging-internal-lb-1023536621.eu-central-1.elb.amazonaws.com\n\n    RESOLVERS=172.20.0.2\n\n    '\n- path: /etc/mesosphere/cluster-id\n  content: sandpit-staging\n  permissions: '0644'\n- path: /etc/mesosphere/setup-flags/repository-url\n  content: 'https://downloads.mesosphere.com/dcos/stable\n\n    '\n  owner: root\n  permissions: 420\n- path: /etc/mesosphere/setup-flags/bootstrap-id\n  content: BOOTSTRAP_ID=18d094b1648521b017622180e3a8e05788a81e80\n  owner: root\n  permissions: 420\n- path: /etc/mesosphere/setup-flags/cluster-packages.json\n  content: '[\"dcos-config--setup_39bcd04b14a990a870cdff4543566e78d7507ba5\", \"dcos-metadata--setup_39bcd04b14a990a870cdff4543566e78d7507ba5\"]\n\n    '\n  owner: root\n  permissions: 420\n- path: /etc/systemd/journald.conf.d/dcos.conf\n  content: '[Journal]\n\n    MaxLevelConsole=warning\n\n    '\n  owner: root\n- path: /etc/systemd/journal-upload.conf\n  content: '[Upload]\n\n    URL=http://logstash.mastodonc.net:12201\n\n    '\n  owner: root\n- path: /etc/confd/conf.d/ssh-authorized-keys.toml\n  content: '[template]\n\n    src = \"ssh-authorized-keys.tmpl\"\n\n    dest = \"/home/core/.ssh/authorized_keys.d/extra-users\"\n\n    owner = \"core\"\n\n    mode=\"0600\"\n\n    keys = [\"/ssh/authorized-keys\"]\n\n    reload_cmd = \"/usr/bin/update-ssh-keys\"\n\n    '\n- path: /etc/confd/templates/ssh-authorized-keys.tmpl\n  content: '{{range getvs \"/ssh/authorized-keys/*\"}}{{.}}\n\n    {{end}}'\n- path: /etc/systemd/resolved.conf\n  content: '[Resolve]\n\n    DNS=staging-dns.sandpit-kixi.mesos\n\n    FallbackDNS=internal-sandpit-staging-internal-lb-1023536621.eu-central-1.elb.amazonaws.com'\n- path: /etc/mesosphere/roles/slave\n  content: ''\n- path: /etc/mesosphere/roles/aws\n  content: ''\n- path: /home/core/cassandra-backup/backup-witan.sh\n  content: \"#!/bin/sh\\n\\n# necessary for java location\\nexport PATH=$PATH:/opt/mesosphere/bin\\n\\\n    CASSANDRA_DIR=$(ps -A -o command | grep CassandraDaemon | grep '/var/lib' | cut\\\n    \\ -d' ' -f1 | sed -e 's#/jre1.*##')\\nCASSANDRA_DATA_DIR=/var/lib/cassandra/data\\n\\\n    NODETOOL=$(find $CASSANDRA_DIR -name nodetool -type f -perm /u+x | grep bin/nodetool)\\n\\\n    AWS=$(find /opt/mesosphere -name aws -type f -perm /u+x | grep bin/aws)\\ndirectory=$($NODETOOL\\\n    \\ snapshot witan | awk '/directory/{print $3}')\\n\\n# We assume it's worked if\\\n    \\ it tells us the directory\\nif [ -z \\\"${directory}\\\" ]; then\\n   echo \\\"Problem\\\n    \\ getting snapshot directory\\\"\\n   exit 1;\\nfi\\n\\n# We only want the snapshots\\\n    \\ dirs\\n# For filters rationale see http://docs.aws.amazon.com/cli/latest/reference/s3/index.html#use-of-exclude-and-include-filters\\n\\\n    sudo -u core $AWS --profile backup s3 sync --exclude '*' --include '*/snapshots/*'\\\n    \\ ${CASSANDRA_DATA_DIR} s3://witan-cassandra-backup/$(hostname)/ --region eu-central-1\\n\"\n  permissions: '0744'\n",
                            "template": "#cloud-config\ncoreos:\n  units:\n  - name: etcd.service\n    command: stop\n    mask: true\n  - name: update-engine.service\n    command: stop\n    mask: true\n  - name: locksmithd.service\n    command: stop\n    mask: true\n  - name: systemd-resolved.service\n    command: restart\n  - name: systemd-journald.service\n    command: restart\n  - name: docker.service\n    command: restart\n    enable: true\n  - name: dcos-link-env.service\n    command: start\n    content: '[Unit]\n\n      Before=dcos.target\n\n      [Service]\n\n      Type=oneshot\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      ExecStartPre=/usr/bin/mkdir -p /etc/profile.d\n\n      ExecStart=/usr/bin/ln -sf /opt/mesosphere/environment.export /etc/profile.d/dcos.sh\n\n      '\n  - name: dcos-download.service\n    content: '[Unit]\n\n      Description=Download the DCOS\n\n      After=network-online.target\n\n      Wants=network-online.target\n\n      ConditionPathExists=!/opt/mesosphere/\n\n      [Service]\n\n      EnvironmentFile=/etc/mesosphere/setup-flags/bootstrap-id\n\n      Type=oneshot\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      ExecStartPre=/usr/bin/curl --fail --retry 20 --continue-at - --location --silent\n      --show-error --verbose --output /tmp/bootstrap.tar.xz https://downloads.mesosphere.com/dcos/stable/bootstrap/$${BOOTSTRAP_ID}.bootstrap.tar.xz\n\n      ExecStartPre=/usr/bin/mkdir -p /opt/mesosphere\n\n      ExecStart=/usr/bin/tar -axf /tmp/bootstrap.tar.xz -C /opt/mesosphere\n\n      ExecStartPost=-/usr/bin/rm -f /tmp/bootstrap.tar.xz\n\n      '\n  - name: dcos-setup.service\n    command: start\n    content: '[Unit]\n\n      Description=Prep the Pkgpanda working directories for this host.\n\n      Requires=dcos-download.service\n\n      After=dcos-download.service\n\n      [Service]\n\n      Type=oneshot\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      EnvironmentFile=/opt/mesosphere/environment\n\n      ExecStart=/opt/mesosphere/bin/pkgpanda setup --no-block-systemd\n\n      [Install]\n\n      WantedBy=multi-user.target'\n    enable: true\n  - name: cadvisor.service\n    command: start\n    content: '[Unit]\n\n      Description=cAdvisor for monitoring\n\n      Requires=docker.service\n\n      After=docker.service\n\n      [Service]\n\n      User=core\n\n      TimeoutStartSec=15\n\n      ExecStartPre=-/usr/bin/docker pull mastodonc/cadvisor:latest\n\n      ExecStart=/usr/bin/docker run --name=cadvisor --label application=cadvisor --net=host\n      --volume=/:/rootfs:ro --volume=/var/run:/var/run:rw --volume=/sys:/sys:ro --volume=/var/lib/docker/:/var/lib/docker:ro\n      --publish=9922:9922  --detach=false mastodonc/cadvisor:latest -port 9922 -storage_driver=influxdb\n      -storage_driver_host=${influxdb-dns}:8086 -storage_driver_db=cadvisor_${cluster-name}\n\n      ExecStop=-/usr/bin/docker stop -t 2 cadvisor; /usr/bin/docker rm -f cadvisor\n\n      '\n    enable: true\n  - name: docker-cleanup.service\n    content: '[Unit]\n\n      Description=Regularly cleanup unused docker images\n\n\n      [Service]\n\n      Type=oneshot\n\n      ExecStart=/usr/bin/docker rmi $(/usr/bin/docker images -a -q)'\n  - name: docker-cleanup.timer\n    command: start\n    content: '[Unit]\n\n      Description=Run docker-cleanup once a day at 1am\n\n\n      [Timer]\n\n      OnCalendar=*-*-* 01:00:00\n\n      Unit=docker-cleanup.service\n\n\n      [Install]\n\n      WantedBy=timers.target'\n  - name: install-confd.service\n    command: start\n    content: '[Unit]\n\n      Description=download and install confd\n\n      After=network-online.target\n\n      Wants=network-online.target\n\n      [Service]\n\n      Type=oneshot\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      TimeoutStartSec=10\n\n      ExecStartPre=/usr/bin/curl --fail --retry 20 --location --silent --show-error\n      --verbose --output /tmp/confd-0.11.0 https://s3.eu-central-1.amazonaws.com/witan-cf-templates/confd-0.11.0-linux-amd64;\n      /usr/bin/mkdir -p /opt/mesosphere/bin; /usr/bin/mv /tmp/confd-0.11.0 /opt/mesosphere/bin/;\n      /usr/bin/ln -s /opt/mesosphere/bin/confd-0.11.0 /opt/mesosphere/bin/confd\n\n      ExecStartPre=/usr/bin/mkdir -p /etc/confd/conf.d\n\n      ExecStartPre=/usr/bin/mkdir -p /etc/confd/templates\n\n      ExecStart=/usr/bin/chmod +x /opt/mesosphere/bin/confd-0.11.0\n\n      ExecStartPost=-/usr/bin/rm -f /tmp/confd-0.11.0\n\n      '\n  - name: confd.service\n    command: start\n    content: '[Unit]\n\n      Description=running confd\n\n      After=multi-user.target\n\n      Wants=multi-user.target\n\n\n      [Service]\n\n      Restart=always\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      ExecStart=/opt/mesosphere/bin/confd -backend=zookeeper -log-level=debug -node=${internal-lb-dns}:2181\n      -interval=60\n\n      ExecStop=-/usr/bin/pkill confd'\n    enable: true\n  - name: install-awscli.service\n    command: start\n    content: '[Unit]\n\n      Description=download and install aws-cli\n\n      After=multi-user.target\n\n      Wants=multi-user.target\n\n      [Service]\n\n      Type=oneshot\n\n      TimeoutStartSec=10\n\n      StandardOutput=journal+console\n\n      StandardError=journal+console\n\n      ExecStart=/opt/mesosphere/bin/pip install awscli\n\n      '\n    enable: true\n  - name: dcos-gen-resolvconf.timer\n    command: stop\n    mask: true\n  - name: backup.service\n    content: '[Unit]\n\n      Description=Backup of cassandra database\n\n      After=multi-user.target\n\n      Wants=multi-user.target\n\n      [Service]\n\n      Type=oneshot\n\n      Environment=\"PATH=/opt/mesosphere/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/opt/bin\"\n\n      ExecStart=/home/core/cassandra-backup/backup-witan.sh\n\n      '\n  - name: backup.timer\n    command: start\n    content: '[Unit]\n\n      Description=Run backup.service once a day at 5am\n\n\n      [Timer]\n\n      OnCalendar=*-*-* 05:00:00\n\n      Unit=backup.service\n\n\n      [Install]\n\n      WantedBy=timers.target\n\n      '\n  update:\n    reboot-strategy: 'off'\nwrite_files:\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/pkginfo.json\n  content: '{}\n\n    '\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/etc/cloudenv\n  content: 'AWS_REGION=${aws-region}\n\n    AWS_STACK_ID=${cluster-id}\n\n    AWS_STACK_NAME=${cluster-name}\n\n    AWS_IAM_MASTER_ROLE_NAME=${master-role}\n\n    AWS_IAM_SLAVE_ROLE_NAME=${slave-role}\n\n    AWS_ACCESS_KEY_ID=${aws-access-key}\n\n    AWS_SECRET_ACCESS_KEY=${aws-secret-access-key}\n\n    ZOOKEEPER_CLUSTER_SIZE=${number-of-masters}\n\n    '\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/etc/mesos-master-provider\n  content: 'MESOS_CLUSTER=${cluster-name}\n\n    '\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/etc/exhibitor\n  content: 'EXHIBITOR_BACKEND=AWS_S3\n\n    AWS_REGION=${aws-region}\n\n    AWS_S3_BUCKET=${exhibitor-s3-bucket}\n\n    AWS_S3_PREFIX=${cluster-name}\n\n    '\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/etc/exhibitor.properties\n  content: 'com.netflix.exhibitor.s3.access-key-id=${aws-access-key}\n\n    com.netflix.exhibitor.s3.access-secret-key=${aws-secret-access-key}\n\n    '\n- path: /etc/mesosphere/setup-packages/dcos-provider-aws--setup/etc/dns_config\n  content: 'MASTER_SOURCE=exhibitor\n\n    EXHIBITOR_ADDRESS=${internal-lb-dns}\n\n    RESOLVERS=${fallback-dns}\n\n    '\n- path: /etc/mesosphere/cluster-id\n  content: ${cluster-id}\n  permissions: '0644'\n- path: /etc/mesosphere/setup-flags/repository-url\n  content: 'https://downloads.mesosphere.com/dcos/stable\n\n    '\n  owner: root\n  permissions: 420\n- path: /etc/mesosphere/setup-flags/bootstrap-id\n  content: BOOTSTRAP_ID=18d094b1648521b017622180e3a8e05788a81e80\n  owner: root\n  permissions: 420\n- path: /etc/mesosphere/setup-flags/cluster-packages.json\n  content: '[\"dcos-config--setup_39bcd04b14a990a870cdff4543566e78d7507ba5\", \"dcos-metadata--setup_39bcd04b14a990a870cdff4543566e78d7507ba5\"]\n\n    '\n  owner: root\n  permissions: 420\n- path: /etc/systemd/journald.conf.d/dcos.conf\n  content: '[Journal]\n\n    MaxLevelConsole=warning\n\n    '\n  owner: root\n- path: /etc/systemd/journal-upload.conf\n  content: '[Upload]\n\n    URL=http://logstash.mastodonc.net:12201\n\n    '\n  owner: root\n- path: /etc/confd/conf.d/ssh-authorized-keys.toml\n  content: '[template]\n\n    src = \"ssh-authorized-keys.tmpl\"\n\n    dest = \"/home/core/.ssh/authorized_keys.d/extra-users\"\n\n    owner = \"core\"\n\n    mode=\"0600\"\n\n    keys = [\"/ssh/authorized-keys\"]\n\n    reload_cmd = \"/usr/bin/update-ssh-keys\"\n\n    '\n- path: /etc/confd/templates/ssh-authorized-keys.tmpl\n  content: '{{range getvs \"/ssh/authorized-keys/*\"}}{{.}}\n\n    {{end}}'\n- path: /etc/systemd/resolved.conf\n  content: '[Resolve]\n\n    DNS=${dns}\n\n    FallbackDNS=${mesos-dns}'\n- path: /etc/mesosphere/roles/slave\n  content: ''\n- path: /etc/mesosphere/roles/aws\n  content: ''\n- path: /home/core/cassandra-backup/backup-witan.sh\n  content: \"#!/bin/sh\\n\\n# necessary for java location\\nexport PATH=$PATH:/opt/mesosphere/bin\\n\\\n    CASSANDRA_DIR=$(ps -A -o command | grep CassandraDaemon | grep '/var/lib' | cut\\\n    \\ -d' ' -f1 | sed -e 's#/jre1.*##')\\nCASSANDRA_DATA_DIR=/var/lib/cassandra/data\\n\\\n    NODETOOL=$(find $CASSANDRA_DIR -name nodetool -type f -perm /u+x | grep bin/nodetool)\\n\\\n    AWS=$(find /opt/mesosphere -name aws -type f -perm /u+x | grep bin/aws)\\ndirectory=$($NODETOOL\\\n    \\ snapshot witan | awk '/directory/{print $3}')\\n\\n# We assume it's worked if\\\n    \\ it tells us the directory\\nif [ -z \\\"$${directory}\\\" ]; then\\n   echo \\\"Problem\\\n    \\ getting snapshot directory\\\"\\n   exit 1;\\nfi\\n\\n# We only want the snapshots\\\n    \\ dirs\\n# For filters rationale see http://docs.aws.amazon.com/cli/latest/reference/s3/index.html#use-of-exclude-and-include-filters\\n\\\n    sudo -u core $AWS --profile backup s3 sync --exclude '*' --include '*/snapshots/*'\\\n    \\ $${CASSANDRA_DATA_DIR} s3://witan-cassandra-backup/$(hostname)/ --region eu-central-1\\n\"\n  permissions: '0744'\n",
                            "vars.#": "15",
                            "vars.aws-access-key": "AKIAIU6KU4KHLAG5KWLA",
                            "vars.aws-region": "eu-central-1",
                            "vars.aws-secret-access-key": "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",
                            "vars.cluster-id": "sandpit-staging",
                            "vars.cluster-name": "staging",
                            "vars.dns": "staging-dns.sandpit-kixi.mesos",
                            "vars.exhibitor-s3-bucket": "sandpit-staging-exhibitor-s3-bucket",
                            "vars.fallback-dns": "172.20.0.2",
                            "vars.influxdb-dns": "influxdb.sandpit-kixi.mesos",
                            "vars.internal-lb-dns": "internal-sandpit-staging-internal-lb-1023536621.eu-central-1.elb.amazonaws.com",
                            "vars.master-role": "sandpit-staging-master-role",
                            "vars.mesos-dns": "internal-sandpit-staging-internal-lb-1023536621.eu-central-1.elb.amazonaws.com",
                            "vars.number-of-masters": "3",
                            "vars.server-group": "sandpit-staging-slaves",
                            "vars.slave-role": "sandpit-staging-slave-role"
                        }
                    }
                }
            }
        }
    ]
}
